/*!
 * Copyright (c) 2017 ~ present NAVER Corp.
 * billboard.js project is licensed under the MIT license
 * 
 * billboard.js, JavaScript chart library
 * http://naver.github.io/billboard.js/
 * 
 * @version 2.0.0-alpha
 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("d3-time-format"),require("d3-selection"),require("d3-transition"),require("d3-brush"),require("d3-axis"),require("d3-scale"),require("d3-dsv"),require("d3-drag"),require("d3-zoom"),require("d3-ease"),require("d3-color"),require("d3-shape"),require("d3-interpolate"));else if("function"==typeof define&&define.amd)define(["d3-time-format","d3-selection","d3-transition","d3-brush","d3-axis","d3-scale","d3-dsv","d3-drag","d3-zoom","d3-ease","d3-color","d3-shape","d3-interpolate"],e);else{var i="object"==typeof exports?e(require("d3-time-format"),require("d3-selection"),require("d3-transition"),require("d3-brush"),require("d3-axis"),require("d3-scale"),require("d3-dsv"),require("d3-drag"),require("d3-zoom"),require("d3-ease"),require("d3-color"),require("d3-shape"),require("d3-interpolate")):e(t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3);for(var a in i)("object"==typeof exports?exports:t)[a]=i[a]}}(this,(function(t,e,i,a,n,r,s,o,c,l,u,d,h){return function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){i(1),t.exports=i(15)},function(t,e,i){},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){t.exports=i},function(t,e){t.exports=a},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e){t.exports=s},function(t,e){t.exports=o},function(t,e){t.exports=c},function(t,e){t.exports=l},function(t,e){t.exports=u},function(t,e){t.exports=d},function(t,e){t.exports=h},function(t,e,i){"use strict";function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.r(e);var n,r=i(2),s=i(3),o=i(4),c={arc:"bb-arc",arcLabelLine:"bb-arc-label-line",arcs:"bb-arcs",area:"bb-area",areas:"bb-areas",axis:"bb-axis",axisX:"bb-axis-x",axisXLabel:"bb-axis-x-label",axisY:"bb-axis-y",axisY2:"bb-axis-y2",axisY2Label:"bb-axis-y2-label",axisYLabel:"bb-axis-y-label",bar:"bb-bar",bars:"bb-bars",brush:"bb-brush",button:"bb-button",buttonZoomReset:"bb-zoom-reset",chart:"bb-chart",chartArc:"bb-chart-arc",chartArcs:"bb-chart-arcs",chartArcsBackground:"bb-chart-arcs-background",chartArcsGaugeMax:"bb-chart-arcs-gauge-max",chartArcsGaugeMin:"bb-chart-arcs-gauge-min",chartArcsGaugeUnit:"bb-chart-arcs-gauge-unit",chartArcsTitle:"bb-chart-arcs-title",chartArcsGaugeTitle:"bb-chart-arcs-gauge-title",chartBar:"bb-chart-bar",chartBars:"bb-chart-bars",chartCircles:"bb-chart-circles",chartLine:"bb-chart-line",chartLines:"bb-chart-lines",chartRadar:"bb-chart-radar",chartRadars:"bb-chart-radars",chartText:"bb-chart-text",chartTexts:"bb-chart-texts",circle:"bb-circle",circles:"bb-circles",colorPattern:"bb-color-pattern",colorScale:"bb-colorscale",defocused:"bb-defocused",dragarea:"bb-dragarea",empty:"bb-empty",eventRect:"bb-event-rect",eventRects:"bb-event-rects",eventRectsMultiple:"bb-event-rects-multiple",eventRectsSingle:"bb-event-rects-single",focused:"bb-focused",gaugeValue:"bb-gauge-value",grid:"bb-grid",gridLines:"bb-grid-lines",legendBackground:"bb-legend-background",legendItem:"bb-legend-item",legendItemEvent:"bb-legend-item-event",legendItemFocused:"bb-legend-item-focused",legendItemHidden:"bb-legend-item-hidden",legendItemPoint:"bb-legend-item-point",legendItemTile:"bb-legend-item-tile",level:"bb-level",levels:"bb-levels",line:"bb-line",lines:"bb-lines",region:"bb-region",regions:"bb-regions",selectedCircle:"bb-selected-circle",selectedCircles:"bb-selected-circles",shape:"bb-shape",shapes:"bb-shapes",stanfordElements:"bb-stanford-elements",stanfordLine:"bb-stanford-line",stanfordLines:"bb-stanford-lines",stanfordRegion:"bb-stanford-region",stanfordRegions:"bb-stanford-regions",target:"bb-target",text:"bb-text",texts:"bb-texts",title:"bb-title",tooltip:"bb-tooltip",tooltipContainer:"bb-tooltip-container",tooltipName:"bb-tooltip-name",xgrid:"bb-xgrid",xgridFocus:"bb-xgrid-focus",xgridLine:"bb-xgrid-line",xgridLines:"bb-xgrid-lines",xgrids:"bb-xgrids",ygrid:"bb-ygrid",ygridFocus:"bb-ygrid-focus",ygridLine:"bb-ygrid-line",ygridLines:"bb-ygrid-lines",ygrids:"bb-ygrids",zoomBrush:"bb-zoom-brush",zoomRect:"bb-zoom-rect",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_",TextOverlapping:"text-overlapping"},l=function(){return{width:0,width2:0,height:0,height2:0,margin:{top:0,bottom:0,left:0,right:0},margin2:{top:0,bottom:0,left:0,right:0},margin3:{top:0,bottom:0,left:0,right:0},arcWidth:0,arcHeight:0,currentWidth:0,currentHeight:0,currentData:{max:0},hasAxis:!1,hasRadar:!1,isLegendRight:!1,isLegendInset:!1,isLegendTop:!1,isLegendLeft:!1,legendStep:0,legendItemWidth:0,legendItemHeight:0,legendHasRendered:!1,currentMaxTickWidths:{x:{size:0,domain:""},y:{size:0,domain:""},y2:{size:0,domain:""}},rotatedPadding:{left:30,right:0,top:5},withoutFadeIn:{},inputType:"",datetimeId:"",clip:{id:"",idXAxis:"",idYAxis:"",idGrid:"",idSubchart:"",path:"",pathXAxis:"",pathYAxis:"",pathGrid:""},dragStart:null,dragging:!1,flowing:!1,cancelClick:!1,mouseover:!1,rendered:!1,transiting:!1,hasNegativeValue:!1,hasPositiveValue:!0,orgAreaOpacity:"0.2",hiddenTargetIds:[],hiddenLegendIds:[],focusedTargetIds:[],defocusedTargetIds:[],radius:0,innerRadius:0,innerRadiusRatio:0,gaugeArcWidth:0,radiusExpanded:0,xgridAttr:{x1:null,x2:null,y1:null,y2:null}}},u={data_idConverter:function(t){return t},data_names:{},data_classes:{},data_type:void 0,data_types:{},data_order:"desc",data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_onclick:function(){},data_onover:function(){},data_onout:function(){},data_onmin:void 0,data_onmax:void 0,data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:"csv",data_keys:void 0,data_empty_label_text:""},d={color_pattern:[],color_tiles:void 0,color_threshold:{},color_onover:void 0},h={interaction_enabled:!0,interaction_brighten:!0,interaction_inputType_mouse:!0,interaction_inputType_touch:{}},g={legend_show:!0,legend_hide:!1,legend_contents_bindto:void 0,legend_contents_template:void 0,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onover:void 0,legend_item_onout:void 0,legend_equally:!1,legend_padding:0,legend_item_tile_width:10,legend_item_tile_height:10,legend_usePoint:!1},f={title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"center"},p={tooltip_show:!0,tooltip_doNotHide:!1,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:{},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},tooltip_linked:!1,tooltip_linked_name:"",tooltip_onshow:function(){},tooltip_onhide:function(){},tooltip_onshown:function(){},tooltip_onhidden:function(){},tooltip_order:null},x={data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_groups:[],data_axes:{},data_labels:{},data_labels_colors:void 0,data_labels_position:{},data_regions:{},data_stack_normalize:!1},v={data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onselected:function(){},data_onunselected:function(){}},m={axis_x_clipPath:!0,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_show:!0,axis_x_tick_text_show:!0,axis_x_tick_text_position:{x:0,y:0},axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_tick_tooltip:!1,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_x_axes:[]},_={axis_y_clipPath:!0,axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:!1,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_culling:!1,axis_y_tick_culling_max:5,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_show:!0,axis_y_tick_stepSize:null,axis_y_tick_text_show:!0,axis_y_tick_text_position:{x:0,y:0},axis_y_tick_time_value:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y_axes:[]},y={axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:!1,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_culling:!1,axis_y2_tick_culling_max:5,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_rotate:0,axis_y2_tick_count:void 0,axis_y2_tick_show:!0,axis_y2_tick_stepSize:null,axis_y2_tick_text_show:!0,axis_y2_tick_text_position:{x:0,y:0},axis_y2_padding:{},axis_y2_default:void 0,axis_y2_axes:[]},b=i(5),T=(n=function(t){return void 0!==t&&t})(self)||n(window)||n(global)||n(globalThis)||Function("return this")(),w=T&&T.document,A=function(t){return t||0===t},S=function(t){return"function"==typeof t},L=function(t){return"string"==typeof t},C=function(t){return"number"==typeof t},O=function(t){return void 0===t},k=function(t){return void 0!==t},D=function(t){return"boolean"==typeof t},R=function(t){return 10*Math.ceil(t/10)},X=function(t){return Math.ceil(t)+.5},E=function(t){return t[1]-t[0]},z=function(t){return"object"==typeof t},F=function(t){return O(t)||null===t||L(t)&&0===t.length||z(t)&&!(t instanceof Date)&&0===Object.keys(t).length||C(t)&&isNaN(t)},I=function(t){return!F(t)},M=function(t){return Array.isArray(t)},P=function(t){return t&&!t.nodeType&&z(t)&&!M(t)};function B(t,e,i){return k(t[e])?t[e]:i}function $(t){for(var e=S(t),i=arguments.length,a=Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];return e&&t.call.apply(t,a),e}function Y(t){return L(t)?t.replace(/</g,"&lt;").replace(/>/g,"&gt;"):t}function j(t,e,i,a){if(void 0===i&&(i=[-1,1]),void 0===a&&(a=!1),t&&L(e))if(-1===e.indexOf("\n"))t.text(e);else{var n=[t.text(),e].map((function(t){return t.replace(/[\s\n]/g,"")}));if(n[0]!==n[1]){var r=e.split("\n"),s=a?r.length-1:1;t.html(""),r.forEach((function(e,a){t.append("tspan").attr("x",0).attr("dy",(0===a?i[0]*s:i[1])+"em").text(e)}))}}}function N(t){var e=t.getBBox(),i=e.x,a=e.y,n=e.width,r=e.height;return[{x:i,y:a+r},{x:i,y:a},{x:i+n,y:a},{x:i+n,y:a+r}]}function V(t){var e,i=t.$el,a=s.event,n=i.subchart.main||i.main;return a&&"brush"===a.type?e=a.selection:n&&(e=n.select("."+c.brush).node())&&(e=Object(b.brushSelection)(e)),e}var G=function(t){return t.rect||(t.rect=t.getBoundingClientRect())};function H(t){void 0===t&&(t=!0);var e=Math.random();return t?e+"":e}function W(t){var e=V(t);return!e||e[0]===e[1]}function U(t,e){for(var i in void 0===t&&(t={}),M(e)&&e.forEach((function(e){return U(t,e)})),e)/^\d+$/.test(i)||(t[i]=e[i]);return t}var Z=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},q=function(t){return[].slice.call(t)};function K(t){var e=t?t.transform:null,i=e?e.baseVal:[];return i.length?i.getItem(0).matrix:{a:0,b:0,c:0,d:0,e:0,f:0}}function J(t){var e=t[0]instanceof Date,i=(e?t.map(Number):t).filter((function(t,e,i){return i.indexOf(t)===e}));return e?i.map((function(t){return new Date(t)})):i}function Q(t){return t&&t.length?t.reduce((function(t,e){return t.concat(e)})):[]}function tt(t){for(var e=arguments.length,i=Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];if(!i.length||1===i.length&&!i[0])return t;var n=i.shift();return P(t)&&P(n)&&Object.keys(n).forEach((function(e){var i=n[e];P(i)?(!t[e]&&(t[e]={}),t[e]=tt(t[e],i)):t[e]=M(i)?i.concat():i})),tt.apply(void 0,[t].concat(i))}function et(t,e){var i;return void 0===e&&(e=!0),t[0]instanceof Date?i=e?function(t,e){return t-e}:function(t,e){return e-t}:e&&!t.every(isNaN)?i=function(t,e){return t-e}:!e&&(i=function(t,e){return(t>e?-1:t<e&&1)||t===e&&0}),t.concat().sort(i)}function it(t,e){var i=e.filter((function(t){return I(t)}));return i.length?C(i[0])?i=Math[t].apply(Math,i):i[0]instanceof Date&&(i=et(i,"min"===t)[0]):i=void 0,i}function at(t,e){for(var i=[],a=t;a<e;a++)i.push(a);return i}var nt={mouse:function(){try{return new MouseEvent("t"),function(t,e,i){void 0===i&&(i={bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0}),t.dispatchEvent(new MouseEvent(e,i))}}catch(t){return function(t,e,i){void 0===i&&(i={bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0});var a=w.createEvent("MouseEvent");a.initMouseEvent(e,i.bubbles,i.cancelable,T,0,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.dispatchEvent(a)}}}(),touch:function(t,e,i){var a=new Touch(tt({identifier:Date.now(),target:t,radiusX:2.5,radiusY:2.5,rotationAngle:10,force:.5},i));t.dispatchEvent(new TouchEvent(e,{cancelable:!0,bubbles:!0,shiftKey:!0,touches:[a],targetTouches:[],changedTouches:[a]}))}};function rt(t,e){var i=t;for(var a in e)i=i.replace(new RegExp("{="+a+"}","g"),e[a]);return i}function st(t){var e;if(t instanceof Date)e=t;else if(L(t)){var i=this.config;e=this.format.dataTime(i.data_xFormat)(t)}else C(t)&&!isNaN(t)&&(e=new Date(+t));return(!e||isNaN(+e))&&console&&console.error&&console.error("Failed to parse x '"+t+"' to Date object"),e}function ot(){return!w.hidden}var ct=tt({axis_rotated:!1},m,_,y),lt={grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_edge:!1,grid_focus_show:!0,grid_focus_y:!1,grid_front:!1,grid_lines_front:!0},ut={point_show:!0,point_r:2.5,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_pattern:[],point_select_r:void 0,point_type:"circle"},dt={subchart_show:!1,subchart_size_height:60,subchart_axis_x_show:!0,subchart_axis_x_tick_show:!0,subchart_axis_x_tick_text_show:!0,subchart_onbrush:function(){}},ht={zoom_enabled:void 0,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:void 0,zoom_onzoomstart:void 0,zoom_onzoomend:void 0,zoom_resetButton:!0,zoom_x_min:void 0,zoom_x_max:void 0},gt={area_zerobased:!0,area_above:!1,area_linearGradient:!1},ft={bar_padding:0,bar_radius:void 0,bar_radius_ratio:void 0,bar_sensitivity:2,bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0},pt={bubble_maxR:35,bubble_zerobased:!1},xt={line_connectNull:!1,line_step_type:"step",line_zerobased:!1,line_classes:void 0,line_point:!0},vt={spline_interpolation_type:"cardinal"},mt={donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_rate:.98,donut_expand_duration:50,donut_padAngle:0,donut_startingAngle:0},_t={gauge_fullCircle:!1,gauge_label_show:!0,gauge_label_format:void 0,gauge_label_extents:void 0,gauge_min:0,gauge_max:100,gauge_type:"single",gauge_startingAngle:-1*Math.PI/2,gauge_title:"",gauge_units:void 0,gauge_width:void 0,gauge_arcs_minWidth:5,gauge_expand:{},gauge_expand_rate:.98,gauge_expand_duration:50},yt={pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_label_ratio:void 0,pie_expand:{},pie_expand_rate:.98,pie_expand_duration:50,pie_innerRadius:0,pie_padAngle:0,pie_padding:0,pie_startingAngle:0},bt={radar_axis_max:void 0,radar_axis_line_show:!0,radar_axis_text_show:!0,radar_axis_text_position:{},radar_level_depth:3,radar_level_show:!0,radar_level_text_format:function(t){return t%1==0?t:t.toFixed(2)},radar_level_text_show:!0,radar_size_ratio:.87,radar_direction_clockwise:!1},Tt=function(){var t=[u,d,h,g,f,p].concat([mt,_t,yt,bt],[x,v,ct,lt,ut,dt,ht],[gt,ft,pt,xt,vt]);return tt.apply(void 0,[{bindto:"#chart",background:{},clipPath:!0,svg_classname:void 0,size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,onover:void 0,onout:void 0,onresize:void 0,onresized:void 0,onbeforeinit:void 0,oninit:void 0,onafterinit:void 0,onrendered:void 0,transition_duration:350,scatter_zerobased:!1,plugins:[],render:{},regions:[]}].concat(t))},wt=function(){function t(){a(this,"cache",{})}var e=t.prototype;return e.add=function(t,e,i){return void 0===i&&(i=!1),this.cache[t]=i?this.cloneTarget(e):e,this.cache[t]},e.remove=function(t){var e=this;q(t).forEach((function(t){return delete e.cache[t]}))},e.get=function(t,e){if(void 0===e&&(e=!1),e){for(var i,a=[],n=0;i=t[n];n++)i in this.cache&&a.push(this.cloneTarget(this.cache[i]));return a}return this.cache[t]||null},e.reset=function(t){for(var e in this.cache)(t||/^\$/.test(e))&&(this.cache[e]=null)},e.cloneTarget=function(t){return{id:t.id,id_org:t.id_org,values:t.values.map((function(t){return{x:t.x,value:t.value,id:t.id}}))}},t}(),At=i(6),St=i(7),Lt=function(){function t(t){a(this,"owner",void 0),a(this,"config",void 0),a(this,"scale",void 0);var e=Object(St.scaleLinear)(),i=t.config,n=t.params;this.owner=t,this.config=i,this.scale=e,(i.noTransition||!n.config.transition_duration)&&(i.withoutTransition=!0),i.range=this.scaleExtent((n.orgXScale||e).range())}t.getSizeFor1Char=function(t){var e={w:5.5,h:11.5};return t.empty()||t.select("text").text("0").call((function(t){try{var i=t.node().getBBox(),a=i.width,n=i.height;a&&n&&(e.w=a,e.h=n),t.text("")}catch(t){}})),this.getSizeFor1Char=function(){return e},e};var e=t.prototype;return e.axisX=function(t,e){var i=this;t.attr("transform",(function(t){return"translate("+Math.ceil(e(t)+i.config.tickOffset)+",0)"}))},e.axisY=function(t,e){t.attr("transform",(function(t){return"translate(0,"+Math.ceil(e(t))+")"}))},e.scaleExtent=function(t){var e=t[0],i=t[t.length-1];return e<i?[e,i]:[i,e]},e.generateTicks=function(t,e){var i=this.owner.params.tickStepSize,a=[];if(e&&i)for(var n=t.domain(),r=n[0],s=n[1],o=r;o<=s;)a.push(o),o+=i;else if(t.ticks)a=t.ticks.apply(t,this.config.tickArguments||[]).map((function(t){return L(t)&&C(t)&&!isNaN(t)&&Math.round(10*t)/10||t}));else{for(var c=t.domain(),l=Math.ceil(c[0]);l<c[1];l++)a.push(l);a.length>0&&a[0]>0&&a.unshift(a[0]-(a[1]-a[0]))}return a},e.copyScale=function(){var t=this.scale.copy();return t.domain().length||t.domain(this.scale.domain()),t},e.textFormatted=function(t){var e=this.config.tickFormat,i=/\d+\.\d+0{5,}\d$/.test(t)?+(t+"").replace(/0+\d$/,""):t,a=e?e(i):i;return k(a)?a:""},e.transitionise=function(t){var e=this.config;return e.withoutTransition?t.interrupt():t.transition(e.transition)},t}(),Ct=function(){function t(t){void 0===t&&(t={}),a(this,"helper",void 0),a(this,"config",void 0),a(this,"params",void 0),a(this,"g",void 0);var e={innerTickSize:6,outerTickSize:t.outerTick?6:0,orient:"bottom",range:[],tickArguments:null,tickCentered:null,tickCulling:!0,tickFormat:null,tickLength:9,tickOffset:0,tickPadding:3,tickValues:null,transition:null,noTransition:t.noTransition};e.tickLength=Math.max(e.innerTickSize,0)+e.tickPadding,this.config=e,this.params=t,this.helper=new Lt(this)}var e=t.prototype;return e.create=function(t){var e=this,i=this.config,a=this.params,n=this.helper,r=n.scale,o=i.orient,c=this.splitTickText.bind(this),l=/^(left|right)$/.test(o),u=/^(top|bottom)$/.test(o),d=n[u?"axisX":"axisY"],h=d===n.axisX?"y":"x",g=/^(top|left)$/.test(o)?-1:1,f=a.tickTextRotate;this.config.range=r.rangeExtent?r.rangeExtent():n.scaleExtent((a.orgXScale||r).range());var p,x=i,v=x.innerTickSize,m=x.tickLength,_=x.range,y=a.name,b=y&&/^(x|y|y2)$/.test(y)?a.config["axis_"+y+"_tick_text_position"]:{x:0,y:0},T="subX"===y?"subchart_axis_x":"axis_"+y,w=a.config[T+"_show"],A=!!w&&a.config[T+"_tick_show"],S=!!w&&a.config[T+"_tick_text_show"];t.each((function(){var t=Object(s.select)(this),x=this.__chart__||r,y=n.copyScale();p=t,this.__chart__=y,i.tickOffset=a.isCategory?Math.ceil((y(1)-y(0))/2):0;var T=t.selectAll(".domain").data([0]);if(T.enter().append("path").attr("class","domain").merge(n.transitionise(T)).attr("d",(function(){var t=i.outerTickSize*g;return u?"M"+_[0]+","+t+"V0H"+_[1]+"V"+t:"M"+t+","+_[0]+"H0V"+_[1]+"H"+t})),A||S){var w=i.tickValues||n.generateTicks(y,l),L=t.selectAll(".tick").data(w,y),O=L.enter().insert("g",".domain").attr("class","tick").style("opacity","1"),k=L.exit().remove();L=O.merge(L),A&&O.append("line"),S&&O.append("text");var D=Lt.getSizeFor1Char(L),R=[],X=L.select("text").selectAll("tspan").data((function(t,e){var i=a.tickMultiline?c(t,y,w,l,D.w):M(n.textFormatted(t))?n.textFormatted(t).concat():[n.textFormatted(t)];return R[e]=i.length,i.map((function(t){return{index:e,splitted:t}}))}));X.exit().remove(),(X=X.enter().append("tspan").merge(X).text((function(t){return t.splitted}))).attr("x",u?0:m*g).attr("dx",function(){var t=0;return/(top|bottom)/.test(o)&&f&&(t=8*Math.sin(Math.PI*(f/180))*("top"===o?-1:1)),t+(b.x||0)}()).attr("dy",(function(t,e){var i=0;return"top"!==o&&(i=D.h,0===e&&(i=l?-((R[t.index]-1)*(D.h/2)-3):0===b.y?".71em":0)),C(i)&&b.y?i+b.y:i||".71em"}));var E=L.select("line"),z=L.select("text");if(O.select("line").attr(h+"2",v*g),O.select("text").attr(""+h,m*g),e.setTickLineTextPosition(E,z),a.tickTitle&&z.append&&z.append("title").each((function(t){Object(s.select)(this).text(a.tickTitle[t])})),y.bandwidth){var F=y,I=F.bandwidth()/2;y=x=function(t){return F(t)+I}}else x.bandwidth?x=y:d.call(n,k,y);d.call(n,O,x),d.call(n,n.transitionise(L).style("opacity","1"),y)}})),this.g=p},e.getTickXY=function(){var t=this.config,e={x:0,y:0};return this.params.isCategory&&(e.x=t.tickCentered?0:t.tickOffset,e.y=t.tickCentered?t.tickOffset:0),e},e.getTickSize=function(t){var e=this.helper.scale,i=this.config,a=i,n=a.innerTickSize,r=a.range,s=e(t)+(i.tickCentered?0:i.tickOffset);return r[0]<s&&s<r[1]?n:0},e.setTickLineTextPosition=function(t,e){var i=this.getTickXY(),a=this.config,n=a.innerTickSize,r=a.orient,s=a.tickLength,o=a.tickOffset,c=this.params.tickTextRotate,l=function(t){var e=["start","end"];return"top"===r&&e.reverse(),t?t>0?e[0]:e[1]:"middle"},u=function(t){return t?"rotate("+t+")":null},d=function(t){return t?11.5-2.5*(t/("bottom"===r?15:23))*(t>0?1:-1):s};"bottom"===r?(t.attr("x1",i.x).attr("x2",i.x).attr("y2",this.getTickSize.bind(this)),e.attr("x",0).attr("y",d(c)).style("text-anchor",l(c)).attr("transform",u(c))):"top"===r?(t.attr("x2",0).attr("y2",-n),e.attr("x",0).attr("y",2*-d(c)).style("text-anchor",l(c)).attr("transform",u(c))):"left"===r?(t.attr("x2",-n).attr("y1",i.y).attr("y2",i.y),e.attr("x",-s).attr("y",o).style("text-anchor","end")):"right"===r&&(t.attr("x2",n).attr("y2",0),e.attr("x",s).attr("y",0).style("text-anchor","start"))},e.splitTickText=function(t,e,i,a,n){var r=this.params,s=this.helper.textFormatted(t),o=L(s)&&s.indexOf("\n")>-1?s.split("\n"):[];if(o.length)return o;if(M(s))return s;var c=r.tickWidth;return(!c||c<=0)&&(c=a?95:r.isCategory?Math.ceil(e(i[1])-e(i[0]))-12:110),function t(e,i){for(var a,r,s,o=1;o<i.length;o++)if(" "===i.charAt(o)&&(r=o),a=i.substr(0,o+1),s=n*a.length,c<s)return t(e.concat(i.substr(0,r||o)),i.slice(r?r+1:o));return e.concat(i)}(o,s+"")},e.scale=function(t){return arguments.length?(this.helper.scale=t,this):this.helper.scale},e.orient=function(t){return arguments.length?(this.config.orient=t in{top:1,right:1,bottom:1,left:1}?t+"":"bottom",this):this.config.orient},e.tickFormat=function(t){var e=this.config;return arguments.length?(e.tickFormat=t,this):e.tickFormat},e.tickCentered=function(t){var e=this.config;return arguments.length?(e.tickCentered=t,this):e.tickCentered},e.tickOffset=function(){return this.config.tickOffset},e.tickInterval=function(t){var e;this.params.isCategory?e=2*this.config.tickOffset:e=(this.g.select("path.domain").node().getTotalLength()-2*this.config.outerTickSize)/(t||this.g.selectAll("line").size());return e===1/0?0:e},e.ticks=function(){for(var t=this.config,e=arguments.length,i=Array(e),a=0;a<e;a++)i[a]=arguments[a];return i.length?(t.tickArguments=q(i),this):t.tickArguments},e.tickCulling=function(t){var e=this.config;return arguments.length?(e.tickCulling=t,this):e.tickCulling},e.tickValues=function(t){var e=this,i=this.config;if(S(t))i.tickValues=function(){return t(e.helper.scale.domain())};else{if(!arguments.length)return i.tickValues;i.tickValues=t}return this},e.setTransition=function(t){return this.config.transition=t,this},t}(),Ot=function(){function t(t){a(this,"owner",void 0),a(this,"axesList",{}),a(this,"tick",{x:null,y:null,y2:null}),a(this,"xs",[]),a(this,"orient",{x:"bottom",y:"left",y2:"right",subX:"bottom"}),this.owner=t,this.setOrient()}var e=t.prototype;return e.getAxisClassName=function(t){return c.axis+" "+c["axis"+Z(t)]},e.isHorizontal=function(t,e){var i=t.config.axis_rotated;return e?i:!i},e.init=function(){var t=this,e=this.owner,i=e.config,a=e.$el,n=a.main,r=a.axis,s=e.state.clip,o=i.axis_rotated,l=["x","y"];i.axis_y2_show&&l.push("y2"),l.forEach((function(a){var l=t.getAxisClassName(a),u=a.toUpperCase(),d=c["axis"+u+"Label"];r[a]=n.append("g").attr("class",l).attr("clip-path",(function(){var t=null;return"x"===a?t=s.pathXAxis:"y"===a&&i.axis_y_inner&&(t=s.pathYAxis),t})).attr("transform",e.getTranslate(a)).style("visibility",i["axis_"+a+"_show"]?"visible":"hidden"),r[a].append("text").attr("class",d).attr("transform",["rotate(-90)",null]["x"===a?+!o:+o]).style("text-anchor",t["textAnchorFor"+u+"AxisLabel"].bind(t)),t.generateAxes(a)}))},e.setOrient=function(){var t=this.owner.config,e=t.axis_rotated,i=t.axis_y_inner,a=t.axis_y2_inner;this.orient={x:e?"left":"bottom",y:e?i?"top":"bottom":i?"right":"left",y2:e?a?"bottom":"top":a?"left":"right",subX:e?"left":"bottom"}},e.generateAxes=function(t){var e,i=this.owner,a=i.config,n=[],r=a["axis_"+t+"_axes"],s=a.axis_rotated;"x"===t?e=s?At.axisLeft:At.axisBottom:"y"===t?e=s?At.axisBottom:At.axisLeft:"y2"===t&&(e=s?At.axisTop:At.axisRight),r.length&&r.forEach((function(a){var r=a.tick||{},s=i.scale[t].copy();a.domain&&s.domain(a.domain),n.push(e(s).ticks(r.count).tickFormat(S(r.format)?r.format.bind(i.api):function(t){return t}).tickValues(r.values).tickSizeOuter(!1===r.outer?0:6))})),this.axesList[t]=n},e.updateAxes=function(){var t=this,e=this.owner,i=e.config,a=e.$el.main;Object.keys(this.axesList).forEach((function(n){var r=i["axis_"+n+"_axes"],s=e.scale[n].copy(),o=s.range();t.axesList[n].forEach((function(c,l){var u=c.scale().range();o.every((function(t,e){return t===u[e]}))||c.scale().range(o);var d=t.getAxisClassName(n)+"-"+(l+1),h=a.select("."+d.replace(/\s/,"."));h.empty()?h=a.append("g").attr("class",d).style("visibility",i["axis_"+n+"_show"]?"visible":"hidden").call(c):(r[l].domain&&s.domain(r[l].domain),e.axis.x.helper.transitionise(h).call(c.scale(s))),h.attr("transform",e.getTranslate(n,l+1))}))}))},e.getAxis=function(t,e,i,a,n){var r,s=this.owner,o=s.config,c=/^(x|subX)$/.test(t),l=c?"x":t,u=c&&s.isCategorized(),d=this.orient[t];if(c)r=s.format.xAxisTick;else{var h=o["axis_"+t+"_tick_format"];S(h)&&(r=h.bind(s.api))}var g=s.axis.tick[l],f=tt({outerTick:i,noTransition:a,config:o,name:t,tickTextRotate:n?0:o["axis_"+l+"_tick_rotate"]},c&&{isCategory:u,tickMultiline:o.axis_x_tick_multiline,tickWidth:o.axis_x_tick_width,tickTitle:u&&o.axis_x_tick_tooltip&&s.api.categories(),orgXScale:s.scale.x});c||(f.tickStepSize=o["axis_"+l+"_tick_stepSize"]);var p=new Ct(f).scale(c&&s.scale.zoom||e).orient(d);if(c&&s.isTimeSeries()&&g&&!S(g)){var x=st.bind(s);g=g.map((function(t){return x(t)}))}else!c&&s.isTimeSeriesY()&&(p.ticks(o.axis_y_tick_time_value),g=null);return g&&p.tickValues(g),p.tickFormat(r||!c&&s.isStackNormalized()&&function(t){return t+"%"}),u&&(p.tickCentered(o.axis_x_tick_centered),F(o.axis_x_tick_culling)&&(o.axis_x_tick_culling=!1)),o["axis_"+l+"_tick_count"]&&p.ticks(o["axis_"+l+"_tick_count"]),p},e.updateXAxisTickValues=function(t,e){var i,a=this.owner,n=a.config,r=n.axis_x_tick_fit,s=n.axis_x_tick_count;return(r||s&&r)&&(i=this.generateTickValues(a.mapTargetsToUniqueXs(t),s,a.isTimeSeries())),e?e.tickValues(i):a.axis.x&&(a.axis.x.tickValues(i),a.axis.subX&&a.axis.subX.tickValues(i)),i},e.getId=function(t){var e=this.owner,i=e.config,a=e.scale,n=i.data_axes[t];return n&&a[n]||(n="y"),n},e.getXAxisTickFormat=function(){var t,e=this.owner,i=e.config,a=e.format,n=i.axis_x_tick_format,r=e.isTimeSeries(),s=e.isCategorized();return n?S(n)?t=n.bind(e.api):r&&(t=function(t){return t?a.axisTime(n)(t):""}):t=r?a.defaultAxisTime:s?e.categoryName:function(t){return t<0?t.toFixed(0):t},S(t)?function(i){return t.apply(e,s?[i,e.categoryName(i)]:[i])}:t},e.getTickValues=function(t){var e=this.owner,i=e.config["axis_"+t+"_tick_values"],a=e[t+"Axis"];return(S(i)?i.call(e.api):i)||(a?a.tickValues():void 0)},e.getLabelOptionByAxisId=function(t){return this.owner.config["axis_"+t+"_label"]},e.getLabelText=function(t){var e=this.getLabelOptionByAxisId(t);return L(e)?e:e?e.text:null},e.setLabelText=function(t,e){var i=this.owner.config,a=this.getLabelOptionByAxisId(t);L(a)?i["axis_"+t+"_label"]=e:a&&(a.text=e)},e.getLabelPosition=function(t,e){var i=this.owner.config.axis_rotated,a=this.getLabelOptionByAxisId(t),n=z(a)&&a.position?a.position:e[+!i],r=function(t){return!!~n.indexOf(t)};return{isInner:r("inner"),isOuter:r("outer"),isLeft:r("left"),isCenter:r("center"),isRight:r("right"),isTop:r("top"),isMiddle:r("middle"),isBottom:r("bottom")}},e.getXAxisLabelPosition=function(){return this.getLabelPosition("x",["inner-top","inner-right"])},e.getYAxisLabelPosition=function(){return this.getLabelPosition("y",["inner-right","inner-top"])},e.getY2AxisLabelPosition=function(){return this.getLabelPosition("y2",["inner-right","inner-top"])},e.getLabelPositionById=function(t){return this["get"+t.toUpperCase()+"AxisLabelPosition"]()},e.textForXAxisLabel=function(){return this.getLabelText("x")},e.textForYAxisLabel=function(){return this.getLabelText("y")},e.textForY2AxisLabel=function(){return this.getLabelText("y2")},e.xForAxisLabel=function(t,e){void 0===e&&(e=!0);var i=this.owner,a=i.state,n=a.width,r=a.height,s=t.isMiddle?-r/2:0;return this.isHorizontal(i,e)?s=t.isLeft?0:t.isCenter?n/2:n:t.isBottom&&(s=-i.state.height),s},e.dxForAxisLabel=function(t,e){void 0===e&&(e=!0);var i=this.owner,a=t.isBottom?"0.5em":"0";return this.isHorizontal(i,e)?a=t.isLeft?"0.5em":t.isRight?"-0.5em":"0":t.isTop&&(a="-0.5em"),a},e.textAnchorForAxisLabel=function(t,e){void 0===e&&(e=!0);var i=this.owner,a=t.isMiddle?"middle":"end";return this.isHorizontal(i,e)?a=t.isLeft?"start":t.isCenter?"middle":"end":t.isBottom&&(a="start"),a},e.xForXAxisLabel=function(){return this.xForAxisLabel(this.getXAxisLabelPosition(),!1)},e.xForYAxisLabel=function(){return this.xForAxisLabel(this.getYAxisLabelPosition())},e.xForY2AxisLabel=function(){return this.xForAxisLabel(this.getY2AxisLabelPosition())},e.dxForXAxisLabel=function(){return this.dxForAxisLabel(this.getXAxisLabelPosition(),!1)},e.dxForYAxisLabel=function(){return this.dxForAxisLabel(this.getYAxisLabelPosition())},e.dxForY2AxisLabel=function(){return this.dxForAxisLabel(this.getY2AxisLabelPosition())},e.dyForXAxisLabel=function(){var t=this.owner.config,e=this.getXAxisLabelPosition().isInner,i=t.axis_x_height;return t.axis_rotated?e?"1.2em":-25-this.getMaxTickWidth("x"):e?"-0.5em":i?i-10:"3em"},e.dyForYAxisLabel=function(){var t=this.owner,e=this.getYAxisLabelPosition().isInner;return t.config.axis_rotated?e?"-0.5em":"3em":e?"1.2em":-10-(t.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)},e.dyForY2AxisLabel=function(){var t=this.owner,e=this.getY2AxisLabelPosition().isInner;return t.config.axis_rotated?e?"1.2em":"-2.2em":e?"-0.5em":15+(t.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)},e.textAnchorForXAxisLabel=function(){return this.textAnchorForAxisLabel(this.getXAxisLabelPosition(),!1)},e.textAnchorForYAxisLabel=function(){return this.textAnchorForAxisLabel(this.getYAxisLabelPosition())},e.textAnchorForY2AxisLabel=function(){return this.textAnchorForAxisLabel(this.getY2AxisLabelPosition())},e.getMaxTickWidth=function(t,e){var i=this.owner,a=i.config,n=i.$el,r=n.svg,s=n.chart,o=i.state.currentMaxTickWidths[t],c=0;if(e||!a["axis_"+t+"_show"])return o.size;if(r){var l=/^y2?$/.test(t),u=i.filterTargetsToShow(i.data.targets),d=i.scale[t].copy().domain(i["get"+(l?"Y":"X")+"Domain"](u,t)),h=d.domain();if(M(o.domain)&&o.domain.every((function(t,e){return t===h[e]})))return o.size;o.domain=h;var g=this.getAxis(t,d,!1,!1,!0),f=a["axis_"+t+"_tick_count"];f&&g.tickValues(this.generateTickValues(h,f,l?i.isTimeSeriesY():i.isTimeSeries())),l||this.updateXAxisTickValues(u,g);var p=s.append("svg").style("visibility","hidden").style("position","fixed").style("top","0px").style("left","0px");g.create(p),p.selectAll("text").each((function(){c=Math.max(c,this.getBoundingClientRect().width)})),p.remove()}return c>0&&(o.size=c),o.size},e.updateLabels=function(t){var e=this,i=this.owner.$el.main,a={X:i.select("."+c.axisX+" ."+c.axisXLabel),Y:i.select("."+c.axisY+" ."+c.axisYLabel),Y2:i.select("."+c.axisY2+" ."+c.axisY2Label)};Object.keys(a).filter((function(t){return!a[t].empty()})).forEach((function(i){var n=a[i],r=i+"AxisLabel";(t?n.transition():n).attr("x",e["xFor"+r].bind(e)).attr("dx",e["dxFor"+r].bind(e)).attr("dy",e["dyFor"+r].bind(e)).text(e["textFor"+r].bind(e))}))},e.getPadding=function(t,e,i,a){var n=C(t)?t:t[e];return A(n)?this.convertPixelsToAxisPadding(n,a):i},e.convertPixelsToAxisPadding=function(t,e){var i=this.owner,a=i.config,n=i.state,r=n.width,s=n.height;return e*(t/(a.axis_rotated?r:s))},e.generateTickValues=function(t,e,i){var a,n,r,s,o,c,l=t;if(e){var u=S(e)?e():e;if(1===u)l=[t[0]];else if(2===u)l=[t[0],t[t.length-1]];else if(u>2){var d=this.owner.isCategorized();for(r=u-2,a=t[0],s=((n=t[t.length-1])-a)/(r+1),l=[a],o=0;o<r;o++)c=+a+s*(o+1),l.push(i?new Date(c):d?Math.round(c):c);l.push(n)}}return i||(l=l.sort((function(t,e){return t-e}))),l},e.generateTransitions=function(t){var e=this.owner.$el.axis,i=["x","y","y2","subX"].map((function(i){var a=e[i];return a&&t&&(a=a.transition().duration(t)),a}));return{axisX:i[0],axisY:i[1],axisY2:i[2],axisSubX:i[3]}},e.redraw=function(t,e,i){var a=this.owner,n=a.config,r=a.$el,s=e?"0":"1";["x","y","y2","subX"].forEach((function(e){var o=a.axis[e],c=r.axis[e];o&&c&&(!i&&(o.config.withoutTransition=!n.transition_duration),c.style("opacity",s),o.create(t["axis"+Z(e)]))})),this.updateAxes()},e.redrawAxis=function(t,e,i,a,n){var r,s=this,o=this.owner,c=o.config,l=o.scale,u=o.$el,d=!!l.zoom;!d&&o.isCategorized()&&0===t.length&&l.x.domain([0,u.axis.x.selectAll(".tick").size()]),l.x&&t.length?(!d&&o.updateXDomain(t,e.UpdateXDomain,e.UpdateOrgXDomain,e.TrimXDomain),!c.axis_x_tick_values&&this.updateXAxisTickValues(t)):o.axis.x&&(o.axis.x.tickValues([]),o.axis.subX&&o.axis.subX.tickValues([])),c.zoom_rescale&&!a&&(r=l.x.orgDomain()),["y","y2"].forEach((function(e){var i=l[e];if(i){var a=c["axis_"+e+"_tick_values"],n=c["axis_"+e+"_tick_count"];if(i.domain(o.getYDomain(t,e,r)),!a&&n){var u=i.domain();o[e+"Axis"].tickValues(s.generateTickValues(u,u.every((function(t){return 0===t}))?1:n,o.isTimeSeriesY()))}}})),this.redraw(i,o.hasArcType(),n),this.updateLabels(e.Transition),(e.UpdateXDomain||e.UpdateXAxis||e.Y)&&t.length&&this.setCulling(),e.Y&&(l.subY&&l.subY.domain(o.getYDomain(t,"y")),l.subY2&&l.subY2.domain(o.getYDomain(t,"y2")))},e.setCulling=function(){var t=this.owner,e=t.config,i=t.$el;["subX","x","y","y2"].forEach((function(t){var a=i.axis[t],n="subX"===t?"x":t,r=e["axis_"+n+"_tick_culling"];if(a&&r){var s,o=a.selectAll(".tick text"),c=et(o.data()),l=c.length,u=e["axis_"+n+"_tick_culling_max"];if(l){for(var d=1;d<l;d++)if(l/d<u){s=d;break}o.each((function(t){this.style.display=c.indexOf(t)%s?"none":"block"}))}else o.style("display","block")}}))},t}(),kt=i(8),Dt={convertData:function(t,e){var i;if(t.bindto?(i={},["url","mimeType","headers","keys","json","keys","rows","columns"].forEach((function(e){var a="data_"+e;a in t&&(i[e]=t[a])}))):i=t,i.url&&e)this.convertUrlToData(i.url,i.mimeType,i.headers,i.keys,e);else if(i.json)i=this.convertJsonToData(i.json,i.keys);else if(i.rows)i=this.convertRowsToData(i.rows);else if(i.columns)i=this.convertColumnsToData(i.columns);else if(t.bindto)throw Error("url or json or rows or columns is required.");return M(i)&&i},convertUrlToData:function(t,e,i,a,n){var r=this;void 0===e&&(e="csv");var s=new XMLHttpRequest;s.open("GET",t),i&&Object.keys(i).forEach((function(t){s.setRequestHeader(t,i[t])})),s.onreadystatechange=function(){if(4===s.readyState){if(200!==s.status)throw new Error(t+": Something went wrong loading!");var i=s.responseText;i&&n.call(r,r["convert"+Z(e)+"ToData"]("json"===e?JSON.parse(i):i,a))}},s.send()},convertCsvTsvToData:function(t,e){var i,a=t.rows(e);return 1===a.length?(i=[{}],a[0].forEach((function(t){i[0][t]=null}))):i=t.parse(e),i},convertCsvToData:function(t){return this.convertCsvTsvToData({rows:kt.csvParseRows,parse:kt.csvParse},t)},convertTsvToData:function(t){return this.convertCsvTsvToData({rows:kt.tsvParseRows,parse:kt.tsvParse},t)},convertJsonToData:function(t,e){var i,a,n=this,r=this.config,s=[];if(M(t)){var o=e||r.data_keys;o.x?(i=o.value.concat(o.x),r.data_x=o.x):i=o.value,s.push(i),t.forEach((function(t){var e=i.map((function(e){var i=n.findValueInJson(t,e);return O(i)&&(i=null),i}));s.push(e)})),a=this.convertRowsToData(s)}else Object.keys(t).forEach((function(e){var i=t[e].concat();i.unshift(e),s.push(i)})),a=this.convertColumnsToData(s);return a},findValueInJson:function(t,e){if(void 0!==t[e])return t[e];var i=e.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split("."),a=t;return i.some((function(t){return!(a=a&&t in a?a[t]:void 0)})),a},convertRowsToData:function(t){var e=t[0],i=[];return t.forEach((function(t,a){if(a>0){var n={};t.forEach((function(t,i){if(O(t))throw new Error("Source data is missing a component at ("+a+", "+i+")!");n[e[i]]=t})),i.push(n)}})),i},convertColumnsToData:function(t){var e=[];return t.forEach((function(t,i){var a=t[0];t.forEach((function(t,n){if(n>0){if(O(e[n-1])&&(e[n-1]={}),O(t))throw new Error("Source data is missing a component at ("+i+", "+n+")!");e[n-1][a]=t}}))})),e},convertDataToTargets:function(t,e){var i,a=this,n=this,r=n.config,s=n.state,o=n.isTimeSeries(),c=Object.keys(t[0]||{}),l=c.length?c.filter(n.isNotX,n):[],u=c.length?c.filter(n.isX,n):[];l.forEach((function(s){var c=a.getXKey(s);a.isCustomX()||o?u.indexOf(c)>=0?i=(e&&n.data.xs[s]||[]).concat(t.map((function(t){return t[c]})).filter(A).map((function(t,e){return n.generateTargetX(t,s,e)}))):r.data_x?i=a.getOtherTargetXs():I(r.data_xs)&&(i=n.getXValuesOfXKey(c,n.data.targets)):i=t.map((function(t,e){return e})),i&&(a.data.xs[s]=i)})),l.forEach((function(t){if(!a.data.xs[t])throw new Error('x is not defined for id = "'+t+'".')}));var d=l.map((function(e,i){var a=r.data_idConverter.bind(n.api)(e),s=n.getXKey(e),o=n.isCustomX()&&n.isCategorized(),c=o&&t.map((function(t){return t.x})).every((function(t){return r.axis_x_categories.indexOf(t)>-1}));return{id:a,id_org:e,values:t.map((function(t,l){var u,d=t[s],h=t[e];return h=null===h||isNaN(h)||P(h)?M(h)||P(h)?h:null:+h,o&&0===i&&!O(d)?(!c&&0===i&&0===l&&(r.axis_x_categories=[]),-1===(u=r.axis_x_categories.indexOf(d))&&(u=r.axis_x_categories.length,r.axis_x_categories.push(d))):u=n.generateTargetX(d,e,l),(O(h)||n.data.xs[e].length<=l)&&(u=void 0),{x:u,value:h,id:a}})).filter((function(t){return k(t.x)}))}}));return d.forEach((function(t){r.data_xSort&&(t.values=t.values.sort((function(t,e){return(t.x||0===t.x?t.x:1/0)-(e.x||0===e.x?e.x:1/0)}))),t.values.forEach((function(t,e){return t.index=e})),n.data.xs[t.id].sort((function(t,e){return t-e}))})),s.hasNegativeValue=n.hasNegativeValueInTargets(d),s.hasPositiveValue=n.hasPositiveValueInTargets(d),r.data_type&&n.setTargetType(n.mapToIds(d).filter((function(t){return!(t in r.data_types)})),r.data_type),d.forEach((function(t){return n.cache.add(t.id_org,t,!0)})),d}},Rt={isX:function(t){var e,i,a,n=this.config,r=n.data_x&&t===n.data_x,s=I(n.data_xs)&&(e=n.data_xs,i=t,a=!1,Object.keys(e).forEach((function(t){return e[t]===i&&(a=!0)})),a);return r||s},isNotX:function(t){return!this.isX(t)},isStackNormalized:function(){var t=this.config;return!(!t.data_stack_normalize||!t.data_groups.length)},isGrouped:function(t){return this.config.data_groups.map((function(e){return e.indexOf(t)>=0}))[0]},getXKey:function(t){var e=this.config;return e.data_x?e.data_x:I(e.data_xs)?e.data_xs[t]:null},getXValuesOfXKey:function(t,e){var i,a=this;return(e&&I(e)?a.mapToIds(e):[]).forEach((function(e){a.getXKey(e)===t&&(i=a.data.xs[e])})),i},getIndexByX:function(t,e){return e?e.indexOf(L(t)?t:+t):(this.filterByX(this.data.targets,t)[0]||{index:null}).index},getXValue:function(t,e){return t in this.data.xs&&this.data.xs[t]&&A(this.data.xs[t][e])?this.data.xs[t][e]:e},getOtherTargetXs:function(){var t=Object.keys(this.data.xs);return t.length?this.data.xs[t[0]]:null},getOtherTargetX:function(t){var e=this.getOtherTargetXs();return e&&t<e.length?e[t]:null},addXs:function(t){var e=this.config;Object.keys(t).forEach((function(i){e.data_xs[i]=t[i]}))},isMultipleX:function(){return I(this.config.data_xs)||!this.config.data_xSort||this.hasType("bubble")||this.hasType("scatter")},addName:function(t){var e,i=this.config;return t&&(e=i.data_names[t.id],t.name=void 0===e?t.id:e),t},getAllValuesOnIndex:function(t){var e=this;return e.filterTargetsToShow(e.data.targets).map((function(i){return e.addName(e.getValueOnIndex(i.values,t))}))},getValueOnIndex:function(t,e){var i=t.filter((function(t){return t.index===e}));return i.length?i[0]:null},updateTargetX:function(t,e){var i=this;t.forEach((function(t){t.values.forEach((function(a,n){a.x=i.generateTargetX(e[n],t.id,n)})),i.data.xs[t.id]=e}))},updateTargetXs:function(t,e){var i=this;t.forEach((function(t){e[t.id]&&i.updateTargetX([t],e[t.id])}))},generateTargetX:function(t,e,i){var a=this,n=a.isCategorized()?i:t||i;if(a.isTimeSeries()){var r=st.bind(a);n=r(t||a.getXValue(e,i))}else a.isCustomX()&&!a.isCategorized()&&(n=A(t)?+t:a.getXValue(e,i));return n},updateXs:function(t){t.length&&(this.axis.xs=t.map((function(t){return t.x})))},getPrevX:function(t){var e=this.axis.xs[t-1];return k(e)?e:null},getNextX:function(t){var e=this.axis.xs[t+1];return k(e)?e:null},getBaseValue:function(t){var e=this,i=e.state.hasAxis,a=t.value;return a&&i&&(e.isAreaRangeType(t)?a=e.getAreaRangeData(t,"mid"):e.isBubbleZType(t)&&(a=e.getBubbleZData(a,"y"))),a},getMinMaxValue:function(t){var e,i,a=this.getBaseValue.bind(this);return(t||this.data.targets.map((function(t){return t.values}))).forEach((function(t,n){var r=t.map(a).filter(C);e=Math.min.apply(Math,[n?e:1/0].concat(r)),i=Math.max.apply(Math,[n?i:-1/0].concat(r))})),{min:e,max:i}},getMinMaxData:function(){var t=this,e=t.cache.get("$minMaxData");if(!e){var i=t.data.targets.map((function(t){return t.values})),a=t.getMinMaxValue(i),n=[],r=[];i.forEach((function(e){var i=t.getFilteredDataByValue(e,a.min),s=t.getFilteredDataByValue(e,a.max);i.length&&(n=n.concat(i)),s.length&&(r=r.concat(s))})),t.cache.add("$minMaxData",e={min:n,max:r})}return e},getTotalPerIndex:function(){var t=this.cache.get("$totalPerIndex");return this.isStackNormalized()&&!t&&(t=[],this.data.targets.forEach((function(e){e.values.forEach((function(e,i){t[i]||(t[i]=0),t[i]+=C(e.value)?e.value:0}))}))),t},getTotalDataSum:function(){var t=this.cache.get("$totalDataSum");if(!t){var e=Q(this.data.targets.map((function(t){return t.values}))).map((function(t){return t.value})).reduce((function(t,e){return t+e}));this.cache.add("$totalDataSum",t=e)}return t},getFilteredDataByValue:function(t,e){var i=this;return t.filter((function(t){return i.getBaseValue(t)===e}))},getMaxDataCount:function(){return Math.max.apply(Math,this.data.targets.map((function(t){return t.values.length})))},getMaxDataCountTarget:function(){var t=this.filterTargetsToShow()||[],e=t.length;return e>1?t=et(J(t=t.map((function(t){return t.values})).reduce((function(t,e){return t.concat(e)})).map((function(t){return t.x})))).map((function(t,e){return{x:t,index:e}})):e&&(t=t[0].values),t},mapToIds:function(t){return t.map((function(t){return t.id}))},mapToTargetIds:function(t){return t?M(t)?t.concat():[t]:this.mapToIds(this.data.targets)},hasTarget:function(t,e){for(var i,a=this.mapToIds(t),n=0;i=a[n];n++)if(i===e)return!0;return!1},isTargetToShow:function(t){return this.state.hiddenTargetIds.indexOf(t)<0},isLegendToShow:function(t){return this.state.hiddenLegendIds.indexOf(t)<0},filterTargetsToShow:function(t){var e=this;return(t||e.data.targets).filter((function(t){return e.isTargetToShow(t.id)}))},mapTargetsToUniqueXs:function(t){var e=[];return t&&t.length&&(e=J(Q(t.map((function(t){return t.values.map((function(t){return+t.x}))})))),e=this.isTimeSeries()?e.map((function(t){return new Date(+t)})):e.map((function(t){return+t}))),et(e)},addHiddenTargetIds:function(t){this.state.hiddenTargetIds=this.state.hiddenTargetIds.concat(t)},removeHiddenTargetIds:function(t){this.state.hiddenTargetIds=this.state.hiddenTargetIds.filter((function(e){return t.indexOf(e)<0}))},addHiddenLegendIds:function(t){this.state.hiddenLegendIds=this.state.hiddenLegendIds.concat(t)},removeHiddenLegendIds:function(t){this.state.hiddenLegendIds=this.state.hiddenLegendIds.filter((function(e){return t.indexOf(e)<0}))},getValuesAsIdKeyed:function(t){var e=this,i=e.state.hasAxis,a={},n=e.isMultipleX(),r=n?e.mapTargetsToUniqueXs(t).map((function(t){return L(t)?t:+t})):null;return t.forEach((function(t){var s=[];t.values.forEach((function(t){var a=t.value;M(a)?s.push.apply(s,a):P(a)&&"high"in a?s.push.apply(s,Object.values(a)):e.isBubbleZType(t)?s.push(i&&e.getBubbleZData(a,"y")):n?s[e.getIndexByX(t.x,r)]=a:s.push(a)})),a[t.id]=s})),a},checkValueInTargets:function(t,e){for(var i,a=Object.keys(t),n=0;n<a.length;n++){i=t[a[n]].values;for(var r=0;r<i.length;r++)if(e(i[r].value))return!0}return!1},hasMultiTargets:function(){return this.filterTargetsToShow().length>1},hasNegativeValueInTargets:function(t){return this.checkValueInTargets(t,(function(t){return t<0}))},hasPositiveValueInTargets:function(t){return this.checkValueInTargets(t,(function(t){return t>0}))},_checkOrder:function(t){var e=this.config.data_order;return L(e)&&e.toLowerCase()===t},isOrderDesc:function(){return this._checkOrder("desc")},isOrderAsc:function(){return this._checkOrder("asc")},orderTargets:function(t){var e=this.config,i=[].concat(t),a=this.isOrderAsc(),n=this.isOrderDesc();return a||n?i.sort((function(t,e){var i=function(t,e){return t+Math.abs(e.value)},n=t.values.reduce(i,0),r=e.values.reduce(i,0);return a?r-n:n-r})):S(e.data_order)&&i.sort(e.data_order.bind(this.api)),i},filterByX:function(t,e){return Q(t.map((function(t){return t.values}))).filter((function(t){return t.x-e==0}))},filterRemoveNull:function(t){var e=this;return t.filter((function(t){return A(e.getBaseValue(t))}))},filterByXDomain:function(t,e){return t.map((function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter((function(t){return e[0]<=t.x&&t.x<=e[1]}))}}))},hasDataLabel:function(){var t=this.config.data_labels;return D(t)&&t||z(t)&&I(t)},getDataLabelLength:function(t,e,i){var a=this,n=[0,0];return a.$el.chart.select("svg").selectAll(".dummy").data([t,e]).enter().append("text").text((function(t){return a.dataLabelFormat(t.id)(t)})).each((function(t,e){n[e]=1.3*this.getBoundingClientRect()[i]})).remove(),n},isNoneArc:function(t){return this.hasTarget(this.data.targets,t.id)},isArc:function(t){return"data"in t&&this.hasTarget(this.data.targets,t.data.id)},findSameXOfValues:function(t,e){var i,a=t[e].x,n=[];for(i=e-1;i>=0&&a===t[i].x;i--)n.push(t[i]);for(i=e;i<t.length&&a===t[i].x;i++)n.push(t[i]);return n},findClosestFromTargets:function(t,e){var i=this,a=t.map((function(t){return i.findClosest(t.values,e)}));return i.findClosest(a,e)},findClosest:function(t,e){var i,a=this,n=a.config,r=a.$el.main,s=t.filter((function(t){return t&&A(t.value)})),o=n.point_sensitivity;return s.filter((function(t){return a.isBarType(t.id)})).forEach((function(t){var e=r.select("."+c.bars+a.getTargetSelectorSuffix(t.id)+" ."+c.bar+"-"+t.index).node();!i&&a.isWithinBar(e)&&(i=t)})),s.filter((function(t){return!a.isBarType(t.id)})).forEach((function(t){var n=a.dist(t,e);n<o&&(o=n,i=t)})),i},dist:function(t,e){var i=this.config.axis_rotated,a=this.scale,n=i?1:0,r=i?0:1,s=this.circleY(t,t.index),o=(a.zoom||a.x)(t.x);return Math.sqrt(Math.pow(o-e[n],2)+Math.pow(s-e[r],2))},convertValuesToStep:function(t){var e=this.config,i=e.axis_rotated,a=e.line_step_type,n=this.isCategorized(),r=M(t)?t.concat():[t];if(!i&&!n)return t;var s=r[0].id,o=r[0].x-1,c=r[0].value;return n&&r.unshift({x:o,value:c,id:s}),"step-after"===a&&r.unshift({x:o-1,value:c,id:s}),c=r[(o=r.length)-1].value,n&&r.push({x:o,value:c,id:s}),"step-before"===a&&r.push({x:o+1,value:c,id:s}),r},convertValuesToRange:function(t){var e=M(t)?t.concat():[t],i=[];return e.forEach((function(t){var e=t.x,a=t.id;i.push({x:e,id:a,value:t.value[0]}),i.push({x:e,id:a,value:t.value[2]})})),i},updateDataAttributes:function(t,e){var i=this.config["data_"+t];return O(e)?i:(Object.keys(e).forEach((function(t){i[t]=e[t]})),this.redraw({withLegend:!0}),i)},getAreaRangeData:function(t,e){var i=t.value;if(M(i)){var a=["high","mid","low"].indexOf(e);return-1===a?null:i[a]}return i[e]},getRatio:function(t,e,i){var a=this,n=a.config,r=a.state,s=a.api,o=0;if(e&&s.data.shown().length){var c=s.data.values.bind(s);if(o=e.ratio||e.value,"arc"===t)if(a.pie.padAngle()()){var l=a.getTotalDataSum();r.hiddenTargetIds.length&&(l-=c(r.hiddenTargetIds).reduce((function(t,e){return t+e}))),o=e.value/l}else o=(e.endAngle-e.startAngle)/(Math.PI*(a.hasType("gauge")&&!n.gauge_fullCircle?1:2));else if("index"===t){var u=this.getTotalPerIndex();if(r.hiddenTargetIds.length){var d=c(r.hiddenTargetIds,!1);d.length&&(d=d.reduce((function(t,e){return t.map((function(t,i){return(C(t)?t:0)+e[i]}))})),u=u.map((function(t,e){return t-d[e]})))}e.ratio=C(e.value)&&u&&u[e.index]>0?e.value/u[e.index]:0,o=e.ratio}else"radar"===t&&(o=parseFloat(Math.max(e.value,0)+"")/r.currentData.max*n.radar_size_ratio)}return i&&o?100*o:o},updateDataIndexByX:function(t){var e=t.reduce((function(t,e,i){return t[+e.x]=i,t}),{});this.data.targets.forEach((function(t){t.values.forEach((function(t,i){var a=e[+t.x];void 0===a&&(a=i),t.index=a}))}))}},Xt={load:function(t,e){var i=this,a=t;a&&(e.filter&&(a=a.filter(e.filter)),(e.type||e.types)&&a.forEach((function(t){var a=e.types&&e.types[t.id]||e.type;i.setTargetType(t.id,a)})),i.data.targets.forEach((function(t){for(var e=0;e<a.length;e++)if(t.id===a[e].id){t.values=a[e].values,a.splice(e,1);break}})),i.data.targets=i.data.targets.concat(a)),i.updateTargets(i.data.targets),i.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),e.done&&e.done.call(i.api)},loadFromArgs:function(t){var e=this;if(e.config){e.cache.reset();var i=t.data||e.convertData(t,(function(i){return e.load(e.convertDataToTargets(i),t)}));i&&e.load(e.convertDataToTargets(i),t)}},unload:function(t,e){var i=this,a=i.state,n=i.$el,r=e,s=t;return i.cache.reset(),r||(r=function(){}),(s=s.filter((function(t){return i.hasTarget(i.data.targets,t)})))&&0!==s.length?(n.svg.selectAll(s.map((function(t){return i.selectorTarget(t)}))).transition().style("opacity","0").remove().call(i.endall,r),void s.forEach((function(t){a.withoutFadeIn[t]=!1,n.legend&&n.legend.selectAll("."+c.legendItem+i.getTargetSelectorSuffix(t)).remove(),i.data.targets=i.data.targets.filter((function(e){return e.id!==t}))}))):void r()}},Et=i(9),zt={setOverOut:function(t,e){var i=this,a=i.config,n=i.$el.main,r=P(e);if(r||-1!==e){var o=a[t?"data_onover":"data_onout"].bind(i.api);if(a.color_onover&&i.setOverColor(t,e,r),r)o(e,n.select("."+c.arc+i.getTargetSelectorSuffix(e.id)).node());else if(a.tooltip_grouped)t&&i.expandCirclesBars(e,null,!0),i.isMultipleX()||n.selectAll("."+c.shape+"-"+e).each((function(t){o(t,this)}));else{var l=i.setOverOut,u=l.last||[],d=n.selectAll("."+c.shape+"-"+e).filter((function(t){return i.isWithinShape(this,t)}));d.each((function(t){var e=this;(0===u.length||u.every((function(t){return t!==e})))&&(o(t,this),u.push(this))})),u.length>0&&d.empty()&&(o=a.data_onout.bind(i.api),u.forEach((function(t){return o(Object(s.select)(t).datum(),t)})),u=[]),l.last=u}}},callOverOutForTouch:function(t){var e=this.callOverOutForTouch,i=e.last;(P(t)&&i?t.id!==i.id:t!==i)&&((i||C(i))&&this.setOverOut(!1,i),(t||C(t))&&this.setOverOut(!0,t),e.last=t)},getDraggableSelection:function(){var t=this,e=t.config;return e.interaction_enabled&&e.data_selection_draggable&&t.drag?Object(Et.drag)().on("drag",(function(){t.drag(Object(s.mouse)(this))})).on("start",(function(){t.dragstart(Object(s.mouse)(this))})).on("end",(function(){t.dragend()})):function(){}},dispatchEvent:function(t,e,i){var a=this.isMultipleX(),n="."+(a?c.eventRect:c.eventRect+"-"+e),r=this.$el.main.select(n).node(),s=r.getBoundingClientRect(),o=s.width,l=s.left,u=s.top,d=l+(i?i[0]:0)+(a||this.config.axis_rotated?0:o/2),h=u+(i?i[1]:0);nt[/^(mouse|click)/.test(t)?"mouse":"touch"](r,t,{screenX:d,screenY:h,clientX:d,clientY:h})}},Ft={generateClass:function(t,e){return" "+t+" "+(t+this.getTargetSelectorSuffix(e))},classText:function(t){return this.generateClass(c.text,t.index)},classTexts:function(t){return this.generateClass(c.texts,t.id)},classShape:function(t){return this.generateClass(c.shape,t.index)},classShapes:function(t){return this.generateClass(c.shapes,t.id)},generateExtraLineClass:function(){var t=this.config.line_classes||[],e=[];return function(i){var a=i.id||i.data&&i.data.id||i;return e.indexOf(a)<0&&e.push(a),t[e.indexOf(a)%t.length]}},classLine:function(t){return this.classShape(t)+this.generateClass(c.line,t.id)},classLines:function(t){return this.classShapes(t)+this.generateClass(c.lines,t.id)},classCircle:function(t){return this.classShape(t)+this.generateClass(c.circle,t.index)},classCircles:function(t){return this.classShapes(t)+this.generateClass(c.circles,t.id)},classBar:function(t){return this.classShape(t)+this.generateClass(c.bar,t.index)},classBars:function(t){return this.classShapes(t)+this.generateClass(c.bars,t.id)},classArc:function(t){return this.classShape(t.data)+this.generateClass(c.arc,t.data.id)},classArcs:function(t){return this.classShapes(t.data)+this.generateClass(c.arcs,t.data.id)},classArea:function(t){return this.classShape(t)+this.generateClass(c.area,t.id)},classAreas:function(t){return this.classShapes(t)+this.generateClass(c.areas,t.id)},classRegion:function(t,e){return this.generateClass(c.region,e)+" "+("class"in t?t.class:"")},classEvent:function(t){return this.generateClass(c.eventRect,t.index)},classTarget:function(t){var e=this.config.data_classes[t],i="";return e&&(i=" "+c.target+"-"+e),this.generateClass(c.target,t)+i},classFocus:function(t){return this.classFocused(t)+this.classDefocused(t)},classFocused:function(t){return" "+(this.state.focusedTargetIds.indexOf(t.id)>=0?c.focused:"")},classDefocused:function(t){return" "+(this.state.defocusedTargetIds.indexOf(t.id)>=0?c.defocused:"")},classChartText:function(t){return c.chartText+this.classTarget(t.id)},classChartLine:function(t){return c.chartLine+this.classTarget(t.id)},classChartBar:function(t){return c.chartBar+this.classTarget(t.id)},classChartArc:function(t){return c.chartArc+this.classTarget(t.data.id)},classChartRadar:function(t){return c.chartRadar+this.classTarget(t.id)},getTargetSelectorSuffix:function(t){return t||0===t?("-"+t).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},selectorTarget:function(t,e){var i=e||"",a=this.getTargetSelectorSuffix(t);return i+"."+(c.target+a)+", "+i+"."+(c.circles+a)},selectorTargets:function(t,e){var i=this,a=t||[];return a.length?a.map((function(t){return i.selectorTarget(t,e)})):null},selectorLegend:function(t){return"."+(c.legendItem+this.getTargetSelectorSuffix(t))},selectorLegends:function(t){var e=this;return t&&t.length?t.map((function(t){return e.selectorLegend(t)})):null}},It=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Mt={getColorFromCss:function(){var t=w.body,e=t.__colorPattern__;if(!e){var i=w.createElement("span");i.className=c.colorPattern,i.style.display="none",t.appendChild(i);var a=T.getComputedStyle(i).backgroundImage;i.parentNode.removeChild(i),a.indexOf(";")>-1&&(e=a.replace(/url[^#]*|["'()]|(\s|%20)/g,"").split(";").map((function(t){return t.trim().replace(/[\"'\s]/g,"")})).filter(Boolean),t.__colorPattern__=e)}return e},generateColor:function(){var t=this,e=t.config,i=e.data_colors,a=e.data_color,n=[],r=I(e.color_pattern)?e.color_pattern:Object(St.scaleOrdinal)(t.getColorFromCss()||It).range(),o=r;if(S(e.color_tiles)){var c=e.color_tiles.bind(t.api)(),l=r.map((function(e,i){var a=e.replace(/[#\(\)\s,]/g,""),n=t.state.datetimeId+"-pattern-"+a+"-"+i;return function(t,e,i){var a=Object(s.select)(t.cloneNode(!0));return a.attr("id",i).insert("rect",":first-child").attr("width",a.attr("width")).attr("height",a.attr("height")).style("fill",e),{id:i,node:a.node()}}(c[i%c.length],e,n)}));r=l.map((function(t){return"url(#"+t.id+")"})),t.patterns=l}return function(s){var c,l=s.id||s.data&&s.data.id||s,u=t.isTypeOf(l,["line","spline","step"])||!e.data_types[l];return S(i[l])?c=i[l].bind(t.api)(s):i[l]?c=i[l]:(n.indexOf(l)<0&&n.push(l),c=u?o[n.indexOf(l)%o.length]:r[n.indexOf(l)%r.length],i[l]=c),S(a)?a.bind(t.api)(c,s):c}},generateLevelColor:function(){var t=this.config,e=t.color_pattern,i=t.color_threshold,a="value"===i.unit,n=i.max||100,r=i.values&&i.values.length?i.values:[];return I(i)?function(t){for(var i=a?t:100*t/n,s=e[e.length-1],o=0,c=r.length;o<c;o++)if(i<=r[o]){s=e[o];break}return s}:null},setOverColor:function(t,e){var i=this,a=i.config,n=i.$el.main,r=a.color_onover,s=t?r:i.color;P(s)?s=function(t){var e=t.id;return e in r?r[e]:i.color(e)}:L(s)?s=function(){return r}:S(r)&&(s=s.bind(i.api)),P(e)?n.selectAll("."+c.arc+i.getTargetSelectorSuffix(e.id)).style("fill",s(e)):n.selectAll("."+c.shape+"-"+e).style("fill",s)}},Pt={getYDomainMinMax:function(t,e){var i=this,a=i.config,n="min"===e,r=a.data_groups,s=i.mapToIds(t),o=i.getValuesAsIdKeyed(t);return r.length>0&&function(){for(var e,a=i["has"+(n?"Negative":"Positive")+"ValueInTargets"](t),c=function(t,r){if(0===(r=r.filter((function(t){return s.indexOf(t)>=0}))).length)return e=r,"continue";var c=r[0],l=i.axis.getId(c);a&&o[c]&&(o[c]=o[c].map((function(t){return(n?t<0:t>0)?t:0})));for(var u,d=function(t,e){if(!o[e])return"continue";var r=i.axis.getId(e);o[e].forEach((function(t,e){var i=+t;r!==l||a&&(n?i>0:i<0)||(o[c][e]+=i)}))},h=1;u=r[h];h++)d(0,u);e=r},l=0;e=r[l];l++)c(0,e)}(),it(e,Object.keys(o).map((function(t){return it(e,o[t])})))},getYDomainMin:function(t){return this.getYDomainMinMax(t,"min")},getYDomainMax:function(t){return this.getYDomainMinMax(t,"max")},getYDomain:function(t,e,i){var a=this,n=a.config,r=a.scale;if(a.isStackNormalized())return[0,100];var s=t.filter((function(t){return a.axis.getId(t.id)===e})),o=i?a.filterByXDomain(s,i):s;if(0===o.length)return"y2"===e?r.y.domain():a.getYDomain(t,"y2",i);var c=n["axis_"+e+"_min"],l=n["axis_"+e+"_max"],u=a.getYDomainMin(o),d=a.getYDomainMax(o),h=n["axis_"+e+"_center"],g=["area","bar","bubble","line","scatter"].some((function(t){return a.hasType(t,o)&&n[t+"_zerobased"]})),f=n["axis_"+e+"_inverted"],p=a.hasDataLabel()&&n.axis_rotated,x=a.hasDataLabel()&&!n.axis_rotated;u=A(c)?c:A(l)?u<l?u:l-10:u,d=A(l)?l:A(c)?c<d?d:c+10:d,isNaN(u)&&(u=0),isNaN(d)&&(d=u),u===d&&(u<0?d=0:u=0);var v=u>=0&&d>=0,m=u<=0&&d<=0;(A(c)&&v||A(l)&&m)&&(g=!1),g&&(v&&(u=0),m&&(d=0));var _=Math.abs(d-u),y={top:.1*_,bottom:.1*_};if(k(h)){var b=Math.max(Math.abs(u),Math.abs(d));d=h+b,u=h-b}if(p){var T=E(r.y.range()),w=a.getDataLabelLength(u,d,"width").map((function(t){return t/T}));["bottom","top"].forEach((function(t,e){y[t]+=_*(w[e]/(1-w[0]-w[1]))}))}else if(x){var S=a.getDataLabelLength(u,d,"height");["bottom","top"].forEach((function(t,e){y[t]+=a.axis.convertPixelsToAxisPadding(S[e],_)}))}if(/^y2?$/.test(e)){var L=n["axis_"+e+"_padding"];I(L)&&["bottom","top"].forEach((function(t){y[t]=a.axis.getPadding(L,t,y[t],_)}))}g&&(v&&(y.bottom=u),m&&(y.top=-d));var C=[u-y.bottom,d+y.top];return f?C.reverse():C},getXDomainMinMax:function(t,e){var i=this.config["axis_x_"+e];return k(i)?this.isTimeSeries()?st.call(this,i):i:it(e,t.map((function(t){return it(e,t.values.map((function(t){return t.x})))})))},getXDomainMin:function(t){return this.getXDomainMinMax(t,"min")},getXDomainMax:function(t){return this.getXDomainMinMax(t,"max")},getXDomainPadding:function(t){var e,i,a=this.config,n=t[1]-t[0],r=a.axis_x_padding;this.isCategorized()?i=0:this.hasType("bar")?i=(e=this.getMaxDataCount())>1?n/(e-1)/2:.5:i=.01*n;var s=i,o=i;return P(r)&&I(r)?(s=A(r.left)?r.left:i,o=A(r.right)?r.right:i):C(a.axis_x_padding)&&(s=r,o=r),{left:s,right:o}},getXDomain:function(t){var e=this,i=[e.getXDomainMin(t),e.getXDomainMax(t)],a=i[0],n=i[1],r=e.getXDomainPadding(i),s=0,o=0;return a-n!=0||e.isCategorized()||(e.isTimeSeries()?(a=new Date(.5*a.getTime()),n=new Date(1.5*n.getTime())):(a=0===a?1:.5*a,n=0===n?-1:1.5*n)),(a||0===a)&&(s=e.isTimeSeries()?new Date(a.getTime()-r.left):a-r.left),(n||0===n)&&(o=e.isTimeSeries()?new Date(n.getTime()+r.right):n+r.right),[s,o]},updateXDomain:function(t,e,i,a,n){var r=this,s=r.config,o=r.org,c=r.scale,l=c.x,u=c.subX,d=s.zoom_enabled;if(i&&(l.domain(n||et(r.getXDomain(t))),o.xDomain=l.domain(),d&&r.zoom.updateScaleExtent(),u.domain(l.domain()),r.brush&&r.brush.scale(u)),e){var h=n||!r.brush||W(r)?o.xDomain:V(r).map(u.invert);l.domain(h),d&&r.zoom.updateScaleExtent()}return a&&l.domain(r.trimXDomain(l.orgDomain())),l.domain()},trimXDomain:function(t){var e=this.getZoomDomain(),i=e[0],a=e[1];return t[0]<=i&&(t[1]=+t[1]+(i-t[0]),t[0]=i),a<=t[1]&&(t[0]=+t[0]-(t[1]-a),t[1]=a),t}};function Bt(t,e,i){var a=t.config,n="axis_"+e+"_tick_format";return(a[n]?a[n]:t.defaultValueFormat)(i)}var $t={getYFormat:function(t){var e=this,i=e.yFormat,a=e.y2Format;return t&&!e.hasType("gauge")&&(i=e.defaultArcValueFormat,a=e.defaultArcValueFormat),function(t,n,r){return(e.axis&&"y2"===e.axis.getId(r)?a:i).call(e,t,n)}},yFormat:function(t){return Bt(this,"y",t)},y2Format:function(t){return Bt(this,"y2",t)},defaultValueFormat:function(t){return A(t)?+t:""},defaultArcValueFormat:function(t,e){return(100*e).toFixed(1)+"%"},dataLabelFormat:function(t){var e=this.config.data_labels,i=function(t){return A(t)?+t:""},a=i;return S(e.format)?a=e.format:z(e.format)&&(a=e.format[t]?!0===e.format[t]?i:e.format[t]:function(){return""}),a.bind(this.api)}},Yt={initLegend:function(){var t=this,e=t.config,i=t.$el;t.legendItemTextBox={},t.state.legendHasRendered=!1,e.legend_show?(!e.legend_contents_bindto&&(i.legend=t.$el.svg.append("g").attr("transform",t.getTranslate("legend"))),t.updateLegend()):t.state.hiddenLegendIds=t.mapToIds(t.data.targets)},updateLegend:function(t,e,i){var a=this,n=a.config,r=a.state,s=a.scale,o=a.$el,l=e||{withTransform:!1,withTransitionForTransform:!1,withTransition:!1};l.withTransition=B(l,"withTransition",!0),l.withTransitionForTransform=B(l,"withTransitionForTransform",!0),n.legend_contents_bindto&&n.legend_contents_template?a.updateLegendTemplate():a.updateLegendElement(t||a.mapToIds(a.data.targets),l,i),o.legend.selectAll("."+c.legendItem).classed(c.legendItemHidden,(function(t){return!a.isTargetToShow(t)})),a.updateScales(!1,!s.zoom),a.updateSvgSize(),a.transformAll(l.withTransitionForTransform,i),r.legendHasRendered=!0},updateLegendTemplate:function(){var t=this,e=t.config,i=t.$el,a=Object(s.select)(e.legend_contents_bindto),n=e.legend_contents_template;if(!a.empty()){var r=t.mapToIds(t.data.targets),o=[],c="";r.forEach((function(e){var i=S(n)?n.bind(t.api)(e,t.color(e),t.api.data(e)[0].values):rt(n,{COLOR:t.color(e),TITLE:e});i&&(o.push(e),c+=i)}));var l=a.html(c).selectAll((function(){return this.childNodes})).data(o);t.setLegendItem(l),i.legend=a}},updateSizeForLegend:function(t){var e=this,i=e.config,a=e.state,n=a.isLegendTop,r=a.isLegendLeft,s=a.isLegendRight,o=a.isLegendInset,c=a.currentWidth,l=a.currentHeight,u=t.width,d=t.height,h={top:n?e.getCurrentPaddingTop()+i.legend_inset_y+5.5:l-d-e.getCurrentPaddingBottom()-i.legend_inset_y,left:r?e.getCurrentPaddingLeft()+i.legend_inset_x+.5:c-u-e.getCurrentPaddingRight()-i.legend_inset_x+.5};e.state.margin3={top:s?0:o?h.top:l-d,right:NaN,bottom:0,left:s?c-u:o?h.left:0}},transformLegend:function(t){var e=this.$el.legend;(t?e.transition():e).attr("transform",this.getTranslate("legend"))},updateLegendStep:function(t){this.state.legendStep=t},updateLegendItemWidth:function(t){this.state.legendItemWidth=t},updateLegendItemHeight:function(t){this.state.legendItemHeight=t},updateLegendItemColor:function(t,e){this.$el.legend.select("."+c.legendItem+"-"+t+" line").style("stroke",e)},getLegendWidth:function(){var t=this.state,e=t.currentWidth,i=t.isLegendRight,a=t.isLegendInset,n=t.legendItemWidth,r=t.legendStep;return this.config.legend_show?i||a?n*(r+1):e:0},getLegendHeight:function(){var t=this.state,e=t.currentHeight,i=t.isLegendRight,a=t.legendItemHeight,n=t.legendStep;return this.config.legend_show?i?e:Math.max(20,a)*(n+1):0},opacityForLegend:function(t){return t.classed(c.legendItemHidden)?null:"1"},opacityForUnfocusedLegend:function(t){return t.classed(c.legendItemHidden)?null:"0.3"},toggleFocusLegend:function(t,e){var i=this,a=i.$el.legend,n=i.mapToTargetIds(t);a&&a.selectAll("."+c.legendItem).filter((function(t){return n.indexOf(t)>=0})).classed(c.legendItemFocused,e).transition().duration(100).style("opacity",(function(){return(e?i.opacityForLegend:i.opacityForUnfocusedLegend).call(i,Object(s.select)(this))}))},revertLegend:function(){var t=this,e=t.$el.legend;e&&e.selectAll("."+c.legendItem).classed(c.legendItemFocused,!1).transition().duration(100).style("opacity",(function(){return t.opacityForLegend(Object(s.select)(this))}))},showLegend:function(t){var e=this,i=e.config,a=e.$el;i.legend_show||(i.legend_show=!0,a.legend?a.legend.style("visibility","visible"):e.initLegend(),!e.state.legendHasRendered&&e.updateLegend()),e.removeHiddenLegendIds(t),a.legend.selectAll(e.selectorLegends(t)).style("visibility","visible").transition().style("opacity",(function(){return e.opacityForLegend(Object(s.select)(this))}))},hideLegend:function(t){var e=this.config,i=this.$el.legend;e.legend_show&&F(t)&&(e.legend_show=!1,i.style("visibility","hidden")),this.addHiddenLegendIds(t),i.selectAll(this.selectorLegends(t)).style("opacity","0").style("visibility","hidden")},getLegendItemTextBox:function(t,e){var i=this.cache,a="legendItemTextBox";if(t){var n=i.get(a);return n||(n={}),n[t]||(n[t]=this.getTextRect(e,c.legendItem),i.add(a,n)),n[t]}i.remove(a)},setLegendItem:function(t){var e=this,i=e.api,a=e.config,n=e.state,r="touch"===n.inputType,o=e.hasType("gauge");t.attr("class",(function(t){var i=Object(s.select)(this);return(!i.empty()&&i.attr("class")||"")+e.generateClass(c.legendItem,t)})).style("visibility",(function(t){return e.isLegendToShow(t)?"visible":"hidden"})).style("cursor","pointer").on("click",(function(t){$(a.legend_item_onclick,i,t)||(s.event.altKey?(i.hide(),i.show(t)):(i.toggle(t),!r&&e.isTargetToShow(t)?i.focus(t):i.revert())),r&&e.hideTooltip()})),r||t.on("mouseout",(function(t){$(a.legend_item_onout,i,t)||(Object(s.select)(this).classed(c.legendItemFocused,!1),o&&e.undoMarkOverlapped(e,"."+c.gaugeValue),e.api.revert())})).on("mouseover",(function(t){$(a.legend_item_onover,i,t)||(Object(s.select)(this).classed(c.legendItemFocused,!0),o&&e.markOverlapped(t,e,"."+c.gaugeValue),!n.transiting&&e.isTargetToShow(t)&&i.focus(t))}))},updateLegendElement:function(t,e){var i,a,n,r=this,o=r.config,l=r.state,u=r.$el,d=o.legend_item_tile_width+5,h=0,g=0,f=0,p={},x={},v={},m=[0],_={},y=0,b=l.isLegendRight||l.isLegendInset,T=t.filter((function(t){return!k(o.data_names[t])||null!==o.data_names[t]})),A=e.withTransition,S=function(t,e,i){var a,n=i===T.length-1,s=r.getLegendItemTextBox(e,t),c=s.width+d+(n&&!b?0:10)+o.legend_padding,u=s.height+4,w=b?u:c,A=b?r.getLegendHeight():r.getLegendWidth(),S=function(t,e){e||(a=(A-f-w)/2)<10&&(a=(A-w)/2,f=0,y++),_[t]=y,m[y]=l.isLegendInset?10:a,p[t]=f,f+=w};if(0===i&&(f=0,y=0,h=0,g=0),o.legend_show&&!r.isLegendToShow(e))return x[e]=0,v[e]=0,_[e]=0,void(p[e]=0);x[e]=c,v[e]=u,(!h||c>=h)&&(h=c),(!g||u>=g)&&(g=u);var L=b?g:h;o.legend_equally?(Object.keys(x).forEach((function(t){return x[t]=h})),Object.keys(v).forEach((function(t){return v[t]=g})),(a=(A-L*T.length)/2)<10?(f=0,y=0,T.forEach((function(t){return S(t)}))):S(e,!0)):S(e)};l.isLegendInset&&(y=o.legend_inset_step?o.legend_inset_step:T.length,r.updateLegendStep(y)),l.isLegendRight?(i=function(t){return h*_[t]},a=function(t){return m[_[t]]+p[t]}):l.isLegendInset?(i=function(t){return h*_[t]+10},a=function(t){return m[_[t]]+p[t]}):(i=function(t){return m[_[t]]+p[t]},a=function(t){return g*_[t]});var L=function(t,e){return i(t,e)+4+o.legend_item_tile_width},C=function(t,e){return i(t,e)},O=function(t,e){return i(t,e)-2},D=function(t,e){return i(t,e)-2+o.legend_item_tile_width},R=function(t,e){return a(t,e)+9},X=function(t,e){return a(t,e)-5},E=function(t,e){return a(t,e)+4},z=u.legend.selectAll("."+c.legendItem).data(T).enter().append("g");r.setLegendItem(z),z.append("text").text((function(t){return k(o.data_names[t])?o.data_names[t]:t})).each((function(t,e){S(this,t,e)})).style("pointer-events","none").attr("x",b?L:-200).attr("y",b?-200:R),z.append("rect").attr("class",c.legendItemEvent).style("fill-opacity","0").attr("x",b?C:-200).attr("y",b?-200:X);var F=o.legend_usePoint;if(F){var M=[];z.append((function(t){var e=I(o.point_pattern)?o.point_pattern:[o.point_type];-1===M.indexOf(t)&&M.push(t);var i=e[M.indexOf(t)%e.length];return"rectangle"===i&&(i="rect"),w.createElementNS(s.namespaces.svg,r.hasValidPointType(i)?i:"use")})).attr("class",c.legendItemPoint).style("fill",(function(t){return r.color(t)})).style("pointer-events","none").attr("href",(function(t,e,i){return"use"===i[e].nodeName.toLowerCase()?"#"+l.datetimeId+"-point-"+t:void 0}))}else z.append("line").attr("class",c.legendItemTile).style("stroke",r.color).style("pointer-events","none").attr("x1",b?O:-200).attr("y1",b?-200:E).attr("x2",b?D:-200).attr("y2",b?-200:E).attr("stroke-width",o.legend_item_tile_height);n=u.legend.select("."+c.legendBackground+" rect"),l.isLegendInset&&h>0&&0===n.size()&&(n=legend.insert("g","."+c.legendItem).attr("class",c.legendBackground).append("rect"));var P=u.legend.selectAll("text").data(T).text((function(t){return k(o.data_names[t])?o.data_names[t]:t})).each((function(t,e){S(this,t,e)}));(A?P.transition():P).attr("x",L).attr("y",R);var B=u.legend.selectAll("rect."+c.legendItemEvent).data(T);if((A?B.transition():B).attr("width",(function(t){return x[t]})).attr("height",(function(t){return v[t]})).attr("x",C).attr("y",X),F){var $=u.legend.selectAll("."+c.legendItemPoint).data(T);(A?$.transition():$).each((function(){var t,e,i,a=this.nodeName.toLowerCase(),n=o.point_r,r="x",c="y",l=2,u=2.5;if("circle"===a){var d=.2*n;r="cx",c="cy",t=n+d,l=2*n,u=-d}else if("rect"===a){var h=2.5*n;e=h,i=h,u=3}Object(s.select)(this).attr(r,(function(t){return O(t)+l})).attr(c,(function(t){return E(t)-u})).attr("r",t).attr("width",e).attr("height",i)}))}else{var Y=u.legend.selectAll("line."+c.legendItemTile).data(T);(A?Y.transition():Y).style("stroke",r.levelColor?function(t){return r.levelColor(r.cache.get(t).values[0].value)}:r.color).attr("x1",O).attr("y1",E).attr("x2",D).attr("y2",E)}n&&(A?n.transition():n).attr("height",r.getLegendHeight()-12).attr("width",h*(y+1)+10),r.updateLegendItemWidth(h),r.updateLegendItemHeight(g),r.updateLegendStep(y)}},jt={getScale:function(t,e,i){return(i?Object(St.scaleTime)():Object(St.scaleLinear)()).range([t,e])},getX:function(t,e,i,a){var n=this.scale.zoom||this.getScale(t,e,this.isTimeSeries());return this.getCustomizedScale(i?n.domain(i):n,a)},getY:function(t,e,i){var a=this.getScale(t,e,this.isTimeSeriesY());return i&&a.domain(i),a},getCustomizedScale:function(t,e){var i=this,a=e||function(){return i.axis.x.tickOffset()},n=function(e,i){var n=t(e)+a();return i?n:Math.ceil(n)};for(var r in t)n[r]=t[r];return n.orgDomain=function(){return t.domain()},n.orgScale=function(){return t},i.isCategorized()&&(n.domain=function(e){var i=e;return arguments.length?(t.domain(i),n):[(i=this.orgDomain())[0],i[1]+1]}),n},getYScale:function(t){var e=this.scale,i=e.y,a=e.y2;return"y2"===this.axis.getId(t)?a:i},getSubYScale:function(t){var e=this.scale,i=e.subY,a=e.subY2;return"y2"===this.axis.getId(t)?a:i},updateScales:function(t,e){void 0===e&&(e=!0);var i=this,a=i.axis,n=i.config,r=i.format,s=i.org,o=i.scale,c=i.state,l=c.width,u=c.height,d=c.width2,h=c.height2;if(c.hasAxis){var g=n.axis_rotated,f={x:g?1:0,y:g?0:u,subX:g?1:0,subY:g?0:h},p={x:g?u:l,y:g?l:1,subX:g?u:l,subY:g?d:1},x=e&&o.x&&o.x.orgDomain(),v=e&&s.xDomain;o.x=i.getX(f.x,p.x,x,(function(){return a.x.tickOffset()})),o.subX=i.getX(f.x,p.x,v,(function(t){return t%1?0:a.subX.tickOffset()})),r.xAxisTick=a.getXAxisTickFormat(),a.tick.x=a.getTickValues("x"),a.x=a.getAxis("x",o.x,n.axis_x_tick_outer,t),n.subchart_show&&(a.subX=a.getAxis("subX",o.subX,n.axis_x_tick_outer,t)),o.y=i.getY(f.y,p.y,o.y?o.y.domain():n.axis_y_default),o.subY=i.getY(f.subY,p.subY,o.subY?o.subY.domain():n.axis_y_default),a.tick.y=a.getTickValues("y"),a.y=a.getAxis("y",o.y,n.axis_y_tick_outer,t),n.axis_y2_show&&(o.y2=i.getY(f.y,p.y,o.y2?o.y2.domain():n.axis_y2_default),o.subY2=i.getY(f.subY,p.subY,o.subY2?o.subY2.domain():n.axis_y2_default),a.tick.y2=a.getTickValues("y2"),a.y2=a.getAxis("y2",o.y2,n.axis_y2_tick_outer,t))}else i.updateArc&&i.updateArc()}},Nt={setContainerSize:function(){var t=this.state;t.currentWidth=this.getCurrentWidth(),t.currentHeight=this.getCurrentHeight()},getCurrentWidth:function(){return this.config.size_width||this.getParentWidth()},getCurrentHeight:function(){var t=this.config,e=t.size_height||this.getParentHeight();return e>0?e:320/(this.hasType("gauge")&&!t.gauge_fullCircle?2:1)},getAxisSize:function(t){var e=this.config.axis_rotated;return e&&"x"===t||!e&&/y2?/.test(t)?this.getAxisWidthByAxisId(t,!0):this.getHorizontalAxisHeight(t)},getCurrentPaddingTop:function(){var t=this.config,e=this.$el,i=t.axis_y2_axes.length,a=A(t.padding_top)?t.padding_top:0;return e.title&&e.title.node()&&(a+=this.getTitlePadding()),i&&t.axis_rotated&&(a+=this.getHorizontalAxisHeight("y2")*i),a},getCurrentPaddingBottom:function(){var t=this.config,e=t.axis_rotated?"y":"x",i=t["axis_"+e+"_axes"].length;return(A(t.padding_bottom)?t.padding_bottom:0)+(i?this.getHorizontalAxisHeight(e)*i:0)},getCurrentPaddingLeft:function(t){var e=this.config,i=this.state.hasAxis,a=e.axis_rotated,n=a?"x":"y",r=e["axis_"+n+"_axes"].length,s=i?this.getAxisWidthByAxisId(n,t):0;return(A(e.padding_left)?e.padding_left:a?e.axis_x_show?Math.max(R(s),40):1:!e.axis_y_show||e.axis_y_inner?this.axis.getYAxisLabelPosition().isOuter?30:1:R(s))+s*r},getCurrentPaddingRight:function(){var t=this,e=t.config,i=t.state.isLegendRight?t.getLegendWidth()+20:0,a=e.axis_y2_axes.length,n=t.getAxisWidthByAxisId("y2");return(A(e.padding_right)?e.padding_right+1:t.axis&&e.axis_rotated?10+i:!t.axis||e.axis_y2_show&&!e.axis_y2_inner?R(n)+i:2+i+(t.axis.getY2AxisLabelPosition().isOuter?20:0))+n*a},getParentRectValue:function(t){for(var e,i="offset"+Z(t),a=this.$el.chart.node();!e&&a&&"BODY"!==a.tagName;){try{e=a.getBoundingClientRect()[t]}catch(t){i in a&&(e=a[i])}a=a.parentNode}if("width"===t){var n=w.body.offsetWidth;e>n&&(e=n)}return e},getParentWidth:function(){return this.getParentRectValue("width")},getParentHeight:function(){var t=this.$el.chart.style("height");return t.indexOf("px")>0?parseInt(t,10):0},getSvgLeft:function(t){var e=this.config,i=this.$el,a=e.axis_rotated||!e.axis_rotated&&!e.axis_y_inner,n=e.axis_rotated?c.axisX:c.axisY,r=i.main.select("."+n).node(),s=r&&a?r.getBoundingClientRect():{right:0},o=i.chart.node().getBoundingClientRect(),l=this.hasArcType(),u=s.right-o.left-(l?0:this.getCurrentPaddingLeft(t));return u>0?u:0},getAxisWidthByAxisId:function(t,e){if(this.axis){var i=this.axis&&this.axis.getLabelPositionById(t);return this.axis.getMaxTickWidth(t,e)+(i.isInner?20:40)}return 40},getHorizontalAxisHeight:function(t){var e=this.config,i=this.state,a=i.rotatedPadding,n=i.isLegendRight,r=i.isLegendInset,s=e.axis_rotated,o=30;if("x"===t&&!e.axis_x_show)return 8;if("x"===t&&e.axis_x_height)return e.axis_x_height;if("y"===t&&!e.axis_y_show)return!e.legend_show||n||r?1:10;if("y2"===t&&!e.axis_y2_show)return a.top;var c=e["axis_"+t+"_tick_rotate"];return("x"===t&&!s||/y2?/.test(t)&&s)&&c&&(o=30+this.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-c)/180)),o+(this.axis.getLabelPositionById(t).isInner?0:10)+("y2"!==t||s?0:-10)},getEventRectWidth:function(){return Math.max(0,this.axis.x.tickInterval())},updateDimension:function(t){var e=this,i=e.config,a=e.state.hasAxis,n=e.$el.axis;a&&!t&&(e.axis.x&&i.axis_rotated?(e.axis.x.create(n.x),e.axis.subX&&e.axis.subX.create(n.subX)):(e.axis.y&&e.axis.y.create(n.y),e.axis.y2&&e.axis.y2.create(n.y2))),e.updateScales(t),e.updateSvgSize(),e.transformAll(!1)},updateSvgSize:function(){var t=this,e=t.state,i=t.$el.svg;if(i.attr("width",e.currentWidth).attr("height",e.currentHeight),e.hasAxis){var a=i.select("."+c.brush+" .overlay"),n={width:0,height:0};a.size()&&(n.width=+a.attr("width"),n.height=+a.attr("height")),i.selectAll(["#"+e.clip.id,"#"+e.clip.idGrid]).select("rect").attr("width",e.width).attr("height",e.height),i.select("#"+e.clip.idXAxis).select("rect").attr("x",t.getXAxisClipX.bind(t)).attr("y",t.getXAxisClipY.bind(t)).attr("width",t.getXAxisClipWidth.bind(t)).attr("height",t.getXAxisClipHeight.bind(t)),i.select("#"+e.clip.idYAxis).select("rect").attr("x",t.getYAxisClipX.bind(t)).attr("y",t.getYAxisClipY.bind(t)).attr("width",t.getYAxisClipWidth.bind(t)).attr("height",t.getYAxisClipHeight.bind(t)),e.clip.idSubchart&&i.select("#"+e.clip.idSubchart).select("rect").attr("width",e.width).attr("height",n.height),i.select("."+c.zoomRect).attr("width",e.width).attr("height",e.height)}},updateSizes:function(t){var e=this,i=e.config,a=e.state,n=e.$el.legend,r=i.axis_rotated,s=e.hasArcType(),o={width:n?e.getLegendWidth():0,height:n?e.getLegendHeight():0},c=a.isLegendRight||a.isLegendInset?0:o.height,l=r||s?0:e.getHorizontalAxisHeight("x"),u=i.subchart_axis_x_show&&i.subchart_axis_x_tick_text_show?l:30,d=i.subchart_show&&!s?i.subchart_size_height+u:0;t||e.setContainerSize(),a.margin=r?{top:e.getHorizontalAxisHeight("y2")+e.getCurrentPaddingTop(),right:s?0:e.getCurrentPaddingRight(),bottom:e.getHorizontalAxisHeight("y")+c+e.getCurrentPaddingBottom(),left:d+(s?0:e.getCurrentPaddingLeft())}:{top:4+e.getCurrentPaddingTop(),right:s?0:e.getCurrentPaddingRight(),bottom:l+d+c+e.getCurrentPaddingBottom(),left:s?0:e.getCurrentPaddingLeft()},a.margin2=r?{top:a.margin.top,right:NaN,bottom:20+c,left:e.state.rotatedPadding.left}:{top:a.currentHeight-d-c,right:NaN,bottom:u+c,left:a.margin.left},a.margin3={top:0,right:NaN,bottom:0,left:0},e.updateSizeForLegend&&e.updateSizeForLegend(o),a.width=a.currentWidth-a.margin.left-a.margin.right,a.height=a.currentHeight-a.margin.top-a.margin.bottom,a.width<0&&(a.width=0),a.height<0&&(a.height=0),a.width2=r?a.margin.left-a.rotatedPadding.left-a.rotatedPadding.right:a.width,a.height2=r?a.height:a.currentHeight-a.margin2.top-a.margin2.bottom,a.width2<0&&(a.width2=0),a.height2<0&&(a.height2=0),a.arcWidth=a.width-(a.isLegendRight?o.width+10:0),a.arcHeight=a.height-(a.isLegendRight?0:10),e.hasType("gauge")&&!i.gauge_fullCircle&&(a.arcHeight+=a.height-e.getGaugeLabelHeight()),e.updateRadius&&e.updateRadius(),a.isLegendRight&&s&&(a.margin3.left=a.arcWidth/2+1.1*a.radiusExpanded)}},Vt={opacityForText:function(){return this.hasDataLabel()?"1":"0"},initText:function(){this.$el.main.select("."+c.chart).append("g").attr("class",c.chartTexts)},updateTargetsForText:function(t){var e=this,i=e.classChartText.bind(e),a=e.classTexts.bind(e),n=e.classFocus.bind(e);e.$el.main.select("."+c.chartTexts).selectAll("."+c.chartText).data(t).attr("class",(function(t){return i(t)+n(t)})).enter().append("g").style("opacity","0").attr("class",i).style("pointer-events","none").append("g").attr("class",a)},updateText:function(t){var e=this,i=this,a=i.config,n=i.$el,r=i.labelishData.bind(i),s=i.classText.bind(i);n.text=n.main.selectAll("."+c.texts).selectAll("."+c.text).data((function(t){return e.isRadarType(t)?t.values:r(t)})),n.text.exit().transition().duration(t).style("fill-opacity","0").remove(),n.text=n.text.enter().append("text").merge(i.$el.text).attr("class",s).attr("text-anchor",(function(t){return a.axis_rotated?t.value<0?"end":"start":"middle"})).style("fill",i.updateTextColor.bind(i)).style("fill-opacity","0").text((function(t,e,a){var n=i.isBubbleZType(t)?i.getBubbleZData(t.value,"z"):t.value;return i.dataLabelFormat(t.id)(n,t.id,e,a)}))},updateTextColor:function(t){var e,i=this.config.data_labels_colors;return L(i)?e=i:P(i)&&(e=i[t.id]),e||this.color(t)},redrawText:function(t,e,i,a){var n=this,r=H(),o=i?0:n.opacityForText.bind(n);return[n.$el.text.each((function(i,c){var l=Object(s.select)(this);(a&&l.attr("x")?l.transition(r):l).attr("x",t.bind(this)(i,c)).attr("y",e.bind(this)(i,c)).style("fill",n.updateTextColor.bind(n)).style("fill-opacity",o)}))]},getTextRect:function(t,e){var i=t.node?t.node():t;/text/i.test(i.tagName)||(i=i.querySelector("text"));var a=i.textContent,n="textRect-"+a.replace(/\W/g,"_"),r=this.cache.get(n);return r||(this.$el.svg.append("text").style("visibility","hidden").style("font",Object(s.select)(i).style("font")).classed(e,!0).text(a).call((function(t){r=G(t.node())})).remove(),this.cache.add(n,r)),r},generateXYForText:function(t,e){var i=this,a=Object.keys(t),n={},r=e?i.getXForText:i.getYForText;return i.hasType("radar")&&a.push("radar"),a.forEach((function(e){n[e]=i["generateGet"+Z(e)+"Points"](t[e],!1)})),function(t,e){var a=(i.isAreaType(t)?"area":i.isBarType(t)&&"bar")||i.isRadarType(t)&&"radar"||"line";return r.call(i,n[a](t,e),t,this)}},getCenteredTextPos:function(t,e,i){var a=this.config,n=a.axis_rotated;if(a.data_labels.centered&&this.isBarType(t)){var r=G(i),s=t.value>=0;if(n){var o=(s?e[1][1]-e[0][1]:e[0][1]-e[1][1])/2+r.width/2;return s?-o-3:o+2}var c=(s?e[0][1]-e[1][1]:e[1][1]-e[0][1])/2+r.height/2;return s?c:-c-2}return 0},getTextPos:function(t,e){var i=this.config.data_labels_position;return(t in i?i[t]:i)[e]||0},getXForText:function(t,e,i){var a,n,r=this,s=r.config,o=r.state,c=s.axis_rotated;if(c?(n=r.isBarType(e)?4:6,a=t[2][1]+n*(e.value<0?-1:1)):a=r.hasType("bar")?(t[2][0]+t[0][0])/2:t[0][0],null===e.value)if(a>o.width){var l=G(i).width;a=o.width-l}else a<0&&(a=4);return c&&(a+=r.getCenteredTextPos(e,t,i)),a+r.getTextPos(e.id,"x")},getYForText:function(t,e,i){var a,n=this,r=n.config,s=n.state,o=r.axis_rotated,c=r.point_r,l=G(i),u=3;if(o)a=(t[0][0]+t[2][0]+.6*l.height)/2;else if(a=t[2][1],C(c)&&c>5&&(n.isLineType(e)||n.isScatterType(e))&&(u+=r.point_r/2.3),e.value<0||0===e.value&&!s.hasPositiveValue&&s.hasNegativeValue)a+=l.height+(n.isBarType(e)?-u:u);else{var d=2*-u;n.isBarType(e)?d=-u:n.isBubbleType(e)&&(d=u),a+=d}if(null===e.value&&!o){var h=l.height;a<h?a=h:a>this.height&&(a=this.height-4)}return o||(a+=n.getCenteredTextPos(e,t,i)),a+n.getTextPos(e.id,"y")},markOverlapped:function(t,e,i){var a=e.$el.arcs.selectAll(i),n=a.filter((function(e){return e.data.id!==t})),r=a.filter((function(e){return e.data.id===t})),o=K(r.node()),l=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))};r.node()&&n.each((function(){var t=K(this),e=Object(s.select)(this),i=l(o.e,o.f)>l(t.e,t.f)?r:e,a=Math.ceil(Math.abs(o.e-t.e))<Math.ceil(i.node().getComputedTextLength()),n=Math.ceil(Math.abs(o.f-t.f))<parseInt(r.style("font-size"),0);e.classed(c.TextOverlapping,a&&n)}))},undoMarkOverlapped:function(t,e){t.$el.arcs.selectAll(e).each((function(){Object(s.selectAll)([this,this.previousSibling]).classed(c.TextOverlapping,!1)}))}};function Gt(t,e){void 0===t&&(t="left");var i=C(e);return t.indexOf("center")>-1?i?e/2:"middle":t.indexOf("right")>-1?i?e:"end":i?0:"start"}var Ht={initTitle:function(){var t=this.config,e=this.$el;t.title_text&&(e.title=e.svg.append("g"),j(e.title.append("text").style("text-anchor",Gt(t.title_position)).attr("class",c.title),t.title_text,[.3,1.5]))},redrawTitle:function(){var t=this,e=t.config,i=t.state.currentWidth,a=t.$el.title;if(a){var n=t.yForTitle.call(t);/g/i.test(a.node().tagName)?a.attr("transform","translate("+Gt(e.title_position,i)+", "+n+")"):a.attr("x",t.xForTitle.call(t)).attr("y",n)}},xForTitle:function(){var t,e=this.config,i=this.state.currentWidth,a=e.title_position||"left",n=this.getTextRect(this.$el.title,c.title).width;return/(right|center)/.test(a)?(t=i-n,a.indexOf("right")>=0?t=i-n-e.title_padding.right:a.indexOf("center")>=0&&(t=(i-n)/2)):t=e.title_padding.left||0,t},yForTitle:function(){return(this.config.title_padding.top||0)+this.getTextRect(this.$el.title,c.title).height},getTitlePadding:function(){return this.yForTitle()+(this.config.title_padding.bottom||0)}},Wt={initTooltip:function(){var t=this,e=t.config,i=t.$el,a=e.tooltip_contents.bindto;if(i.tooltip=Object(s.select)(a),i.tooltip.empty()&&(i.tooltip=i.chart.style("position","relative").append("div").attr("class",c.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none")),e.tooltip_init_show){if(t.isTimeSeries()&&L(e.tooltip_init_x)){var n,r,o=t.data.targets[0];for(e.tooltip_init_x=st.call(t,e.tooltip_init_x),n=0;(r=o.values[n])&&r.x-e.tooltip_init_x!=0;n++);e.tooltip_init_x=n}i.tooltip.html(t.getTooltipHTML(t.data.targets.map((function(i){return t.addName(i.values[e.tooltip_init_x])})),t.axis.getXAxisTickFormat(),t.getYFormat(t.hasArcType(null,["radar"])),t.color)),a||i.tooltip.style("top",e.tooltip_init_position.top).style("left",e.tooltip_init_position.left).style("display","block")}},getTooltipHTML:function(){var t=this,e=t.config;return S(e.tooltip_contents)?e.tooltip_contents.bind(t.api).apply(void 0,arguments):t.getTooltipContent.apply(t,arguments)},getTooltipContent:function(t,e,i,a){var n=this,r=n.api,s=n.config,o=["title","name","value"].map((function(t){var e=s["tooltip_format_"+t];return S(e)?e.bind(r):e})),l=o[0],u=o[1],d=o[2];l=l||e,u=u||function(t){return t},d=d||(n.isStackNormalized()?function(t,e){return(100*e).toFixed(2)+"%"}:i);var h=s.tooltip_order,g=function(t){return n.axis&&n.isBubbleZType(t)?n.getBubbleZData(t.value,"z"):n.getBaseValue(t)},f=n.levelColor?function(t){return n.levelColor(t.value)}:function(t){return a(t)},p=s.tooltip_contents,x=p.template,v=n.mapToTargetIds();if(null===h&&s.data_groups.length){var m=n.orderTargets(n.data.targets).map((function(t){return t.id})).reverse();t.sort((function(t,e){var i=t?t.value:null,a=e?e.value:null;return i>0&&a>0&&(i=t.id?m.indexOf(t.id):null,a=e.id?m.indexOf(e.id):null),i-a}))}else/^(asc|desc)$/.test(h)?t.sort((function(t,e){var i=t?g(t):null,a=e?g(e):null;return"asc"===h?i-a:a-i})):S(h)&&t.sort(h.bind(r));var _,y,b,T,w,L=n.getTooltipContentTemplate(x),C=t.length;for(w=0;w<C;w++)if((y=t[w])&&(g(y)||0===g(y))){if(O(_)){var k=Y(l?l(y.x):y.x);_=rt(L[0],{CLASS_TOOLTIP:c.tooltip,TITLE:A(k)?x?k:'<tr><th colspan="2">'+k+"</th></tr>":""})}if(b=[y.ratio,y.id,y.index,t],T=Y(d.apply(void 0,[g(y)].concat(b))),n.isAreaRangeType(y)){var D=["high","low"].map((function(t){return Y(d.apply(void 0,[n.getAreaRangeData(y,t)].concat(b)))})),R=D[0],X=D[1];T="<b>Mid:</b> "+T+" <b>High:</b> "+R+" <b>Low:</b> "+X}if(void 0!==T)if("continue"===function(){if(null===y.name)return"continue";var t=Y(u.apply(void 0,[y.name].concat(b))),e=f(y),i={CLASS_TOOLTIP_NAME:c.tooltipName+n.getTargetSelectorSuffix(y.id),COLOR:x||!n.patterns?e:'<svg><rect style="fill:'+e+'" width="10" height="10"></rect></svg>',NAME:t,VALUE:T};if(x&&P(p.text)){var a=v.indexOf(y.id);Object.keys(p.text).forEach((function(t){i[t]=p.text[t][a]}))}_+=rt(L[1],i)}())continue}return _+"</table>"},getTooltipContentTemplate:function(t){return(t||'<table class="{=CLASS_TOOLTIP}"><tbody>\n\t\t\t\t{=TITLE}\n\t\t\t\t{{<tr class="{=CLASS_TOOLTIP_NAME}">\n\t\t\t\t\t<td class="name">'+(this.patterns?"{=COLOR}":'<span style="background-color:{=COLOR}"></span>')+'{=NAME}</td>\n\t\t\t\t\t<td class="value">{=VALUE}</td>\n\t\t\t\t</tr>}}\n\t\t\t</tbody></table>').replace(/(\r?\n|\t)/g,"").split(/{{(.*)}}/)},tooltipPosition:function(t,e,i,a){var n=this,r=n.config,o=n.scale,c=n.state,l=c.width,u=c.height,d=c.currentWidth,h=c.currentHeight,g=c.isLegendRight,f=c.inputType,p=n.hasType("gauge")&&!r.gauge_fullCircle,x=n.getSvgLeft(!0),v=Object(s.mouse)(a),m=v[0],_=v[1],y=x+d-n.getCurrentPaddingRight();if(_+=20,n.hasArcType()){"touch"===f||n.hasType("radar")||(_+=p?u:u/2,m+=(l-(g?n.getLegendWidth():0))/2)}else{var b=o.x(t[0].x);r.axis_rotated?(_=b+20,m+=x+100,y-=x):(_-=5,m=x+n.getCurrentPaddingLeft(!0)+20+(o.zoom?m:b))}var T=m+e;return T>y&&(m-=T-y+20),_+i>h&&(_-=p?3*i:i+30),_<0&&(_=0),{top:_,left:m}},showTooltip:function(t,e){var i=this,a=i.config,n=i.state,r=i.$el.tooltip,s=a.tooltip_contents.bindto,o=i.hasArcType(null,["radar"]),c=t.filter((function(t){return t&&A(i.getBaseValue(t))}));if(0!==c.length&&a.tooltip_show){var l=r.datum(),u=JSON.stringify(t),d=l||{},h=d.width,g=void 0===h?0:h,f=d.height,p=void 0===f?0:f;if(!l||l.current!==u){var x=t.concat().sort()[0].index;$(a.tooltip_onshow,i.api,t),r.html(i.getTooltipHTML(t,i.axis&&i.axis.getXAxisTickFormat(),i.getYFormat(o),i.color)).style("display",null).style("visibility",null).datum({index:x,current:u,width:g=r.property("offsetWidth"),height:p=r.property("offsetHeight")}),$(a.tooltip_onshown,i.api,t),i._handleLinkedCharts(!0,x)}if(!s){var v,m=a.tooltip_position;S(m)?m=m.bind(i.api):(v=m&&m.unit,m=i.tooltipPosition.bind(i));var _=m(c,g,p,e);["top","left"].forEach((function(t){var e=_[t];if(/^\d+(\.\d+)?$/.test(e)){if("%"===v)e=e/n["top"===t?"currentHeight":"currentWidth"]*100;else v="px";e+=v}r.style(t,e)}))}}},hideTooltip:function(t){var e=this.config,i=this.$el.tooltip;if("none"!==i.style("display")&&(!e.tooltip_doNotHide||t)){var a=JSON.parse(i.datum().current);$(e.tooltip_onhide,this.api,a),i.style("display","none").style("visibility","hidden").datum(null),$(e.tooltip_onhidden,this.api,a)}},_handleLinkedCharts:function(t,e){var i=this,a=i.charts,n=i.config;if(n.tooltip_linked&&a.length>1){var r=n.tooltip_linked_name;a.forEach((function(a){if(a!==i.api){var n=a.internal.config,s=n.tooltip_linked,o=n.tooltip_linked_name,c=w.body.contains(a.element);if(s&&r===o&&c){var l=a.internal.$el.tooltip.data()[0],u=e!==(l&&l.index);try{t&&u?a.tooltip.show({index:e}):!t&&a.tooltip.hide()}catch(t){}}}}))}}},Ut={getTranslate:function(t,e){void 0===e&&(e=0);var i,a,n=this,r=n.config,s=n.state,o=r.axis_rotated,c=n.hasType("gauge"),l=0;if(e&&/^(x|y2?)$/.test(t)&&(l=n.getAxisSize(t)*e),"main"===t)i=X(s.margin.left),a=X(s.margin.top);else if("context"===t)i=X(s.margin2.left),a=X(s.margin2.top);else if("legend"===t)i=s.margin3.left,a=s.margin3.top+(c?10:0);else if("x"===t)i=o?-l:0,a=o?0:s.height+l;else if("y"===t)i=o?0:-l,a=o?s.height+l:0;else if("y2"===t)i=o?0:s.width+l,a=o?1-l:0;else if("subX"===t)i=0,a=o?0:s.height2;else if("arc"===t)i=s.arcWidth/2,a=s.arcHeight/2;else if("radar"===t){var u=n.getRadarSize()[0];i=s.width/2-u,a=X(s.margin.top)}return"translate("+i+", "+a+")"},transformMain:function(t,e){var i,a,n,r=this,s=r.$el.main;e&&e.axisX?i=e.axisX:(i=s.select("."+c.axisX),t&&(i=i.transition())),e&&e.axisY?a=e.axisY:(a=s.select("."+c.axisY),t&&(a=a.transition())),e&&e.axisY2?n=e.axisY2:(n=s.select("."+c.axisY2),t&&(n=n.transition())),(t?s.transition():s).attr("transform",r.getTranslate("main")),i.attr("transform",r.getTranslate("x")),a.attr("transform",r.getTranslate("y")),n.attr("transform",r.getTranslate("y2")),s.select("."+c.chartArcs).attr("transform",r.getTranslate("arc"))},transformAll:function(t,e){var i=this,a=i.config,n=i.state.hasAxis,r=i.$el;i.transformMain(t,e),n&&a.subchart_show&&i.transformContext(t,e),r.legend&&i.transformLegend(t)}},Zt={Area:["area","area-spline","area-spline-range","area-line-range","area-step"],AreaRange:["area-spline-range","area-line-range"],Arc:["pie","donut","gauge","radar"],Line:["line","spline","area","area-spline","area-spline-range","area-line-range","step","area-step"],Step:["step","area-step"],Spline:["spline","area-spline","area-spline-range"]},qt={setTargetType:function(t,e){var i=this.config,a=this.state.withoutFadeIn;this.mapToTargetIds(t).forEach((function(t){a[t]=e===i.data_types[t],i.data_types[t]=e})),t||(i.data_type=e)},hasType:function(t,e){var i=this.config,a=i.data_types,n=e||this.data.targets,r=!1;return n&&n.length?n.forEach((function(e){var i=a[e.id];(i&&i.indexOf(t)>=0||!i&&"line"===t)&&(r=!0)})):Object.keys(a).length?Object.keys(a).forEach((function(e){a[e]===t&&(r=!0)})):r=i.data_type===t,r},hasTypeOf:function(t,e,i){var a=this;return void 0===i&&(i=[]),!Zt[t].filter((function(t){return-1===i.indexOf(t)})).every((function(t){return!a.hasType(t,e)}))},isTypeOf:function(t,e){var i=L(t)?t:t.id,a=this.config.data_types[i];return M(e)?e.indexOf(a)>=0:a===e},hasPointType:function(){return this.hasTypeOf("Line")||this.hasType("bubble")||this.hasType("scatter")},hasArcType:function(t,e){return this.hasTypeOf("Arc",t,e)},hasMultiArcGauge:function(){return this.hasType("gauge")&&"multi"===this.config.gauge_type},isLineType:function(t){var e=L(t)?t:t.id;return!this.config.data_types[e]||this.isTypeOf(e,Zt.Line)},isStepType:function(t){return this.isTypeOf(t,Zt.Step)},isSplineType:function(t){return this.isTypeOf(t,Zt.Spline)},isAreaType:function(t){return this.isTypeOf(t,Zt.Area)},isAreaRangeType:function(t){return this.isTypeOf(t,Zt.AreaRange)},isBarType:function(t){return this.isTypeOf(t,"bar")},isBubbleType:function(t){return this.isTypeOf(t,"bubble")},isScatterType:function(t){return this.isTypeOf(t,"scatter")},isPieType:function(t){return this.isTypeOf(t,"pie")},isGaugeType:function(t){return this.isTypeOf(t,"gauge")},isDonutType:function(t){return this.isTypeOf(t,"donut")},isRadarType:function(t){return this.isTypeOf(t,"radar")},isArcType:function(t){return this.isPieType(t)||this.isDonutType(t)||this.isGaugeType(t)||this.isRadarType(t)},isCirclePoint:function(){var t=this.config,e=t.point_pattern;return"circle"===t.point_type&&(!e||M(e)&&0===e.length)},lineData:function(t){return this.isLineType(t)?[t]:[]},arcData:function(t){return this.isArcType(t.data)?[t]:[]},barData:function(t){return this.isBarType(t)?t.values:[]},labelishData:function(t){return this.isBarType(t)||this.isLineType(t)||this.isScatterType(t)||this.isBubbleType(t)||this.isRadarType(t)?t.values:[]},barLineBubbleData:function(t){return this.isBarType(t)||this.isLineType(t)||this.isBubbleType(t)?t.values:[]},isInterpolationType:function(t){return["basis","basis-closed","basis-open","bundle","cardinal","cardinal-closed","cardinal-open","catmull-rom","catmull-rom-closed","catmull-rom-open","linear","linear-closed","monotone-x","monotone-y","natural"].indexOf(t)>=0}};function Kt(t,e,i){var a=t.config,n="axis_y_"+e,r="axis_y2_"+e;k(i)&&(z(i)?(A(i.x)&&(a["axis_x_"+e]=i.x),A(i.y)&&(a[n]=i.y),A(i.y2)&&(a[r]=i.y2)):(a[n]=i,a[r]=i),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))}function Jt(t,e){var i=t.config;return{x:i["axis_x_"+e],y:i["axis_y_"+e],y2:i["axis_y2_"+e]}}var Qt={axis:{labels:function(t){var e=this.internal;arguments.length&&(Object.keys(t).forEach((function(i){e.axis.setLabelText(i,t[i])})),e.axis.updateLabels())},min:function(t){var e=this.internal;return A(t)?Kt(e,"min",t):Jt(e,"min")},max:function(t){var e=this.internal;return arguments.length?Kt(e,"max",t):Jt(e,"max")},range:function(t){var e=this.axis;if(!arguments.length)return{max:e.max(),min:e.min()};k(t.max)&&e.max(t.max),k(t.min)&&e.min(t.min)}}},te={flow:function(t){var e,i,a,n,r=this.internal,s=0,o=0;if((t.json||t.rows||t.columns)&&(e=r.convertData(t)),e&&ot()){var c=[],l=r.getMaxDataCount(),u=r.convertDataToTargets(e,!0);r.data.targets.forEach((function(t){for(var e=!1,i=0;i<u.length;i++)if(t.id===u[i].id){e=!0,t.values[t.values.length-1]&&(o=t.values[t.values.length-1].index+1),s=u[i].values.length;for(var a=0;a<s;a++)u[i].values[a].index=o+a,r.isTimeSeries()||(u[i].values[a].x=o+a);t.values=t.values.concat(u[i].values),u.splice(i,1);break}e||c.push(t.id)})),r.data.targets.forEach((function(t){for(var e=0;e<c.length;e++)if(t.id===c[e]){o=t.values[t.values.length-1].index+1;for(var i=0;i<s;i++)t.values.push({id:t.id,index:o+i,x:r.isTimeSeries()?r.getOtherTargetX(o+i):o+i,value:null})}})),r.data.targets.length&&u.forEach((function(t){for(var e=[],i=r.data.targets[0].values[0].index;i<o;i++)e.push({id:t.id,index:i,x:r.isTimeSeries()?r.getOtherTargetX(i):i,value:null});t.values.forEach((function(t){t.index+=o,r.isTimeSeries()||(t.x+=o)})),t.values=e.concat(t.values)})),r.data.targets=r.data.targets.concat(u);var d=r.data.targets[0],h=d.values[0];k(t.to)?(s=0,n=r.isTimeSeries()?st.call(r,t.to):t.to,d.values.forEach((function(t){t.x<n&&s++}))):k(t.length)&&(s=t.length),l?1===l&&r.isTimeSeries()&&(a=(d.values[d.values.length-1].x-h.x)/2,i=[new Date(+h.x-a),new Date(+h.x+a)]):(a=r.isTimeSeries()?d.values.length>1?d.values[d.values.length-1].x-h.x:h.x-r.getXDomain(r.data.targets)[0]:1,i=[h.x-a,h.x]),i&&r.updateXDomain(null,!0,!0,!1,i),r.updateTargets(r.data.targets),r.redraw({flow:{index:h.index,length:s,duration:A(t.duration)?t.duration:r.config.transition_duration,done:t.done,orgDataCount:l},withLegend:!0,withTransition:l>1,withTrimXDomain:!1,withUpdateXAxis:!0})}}};function ee(t){var e=this.internal,i=e.config;return t?(i.grid_x_lines=t,e.redrawWithoutRescale(),i.grid_x_lines):i.grid_x_lines}U(ee,{add:function(t){return this.xgrids(this.internal.config.grid_x_lines.concat(t||[]))},remove:function(t){this.internal.removeGridLines(t,!0)}});var ie={xgrids:ee};function ae(t){var e=this.internal,i=e.config;return t?(i.grid_y_lines=t,e.redrawWithoutRescale(),i.grid_y_lines):i.grid_y_lines}U(ae,{add:function(t){return this.ygrids(this.internal.config.grid_y_lines.concat(t||[]))},remove:function(t){this.internal.removeGridLines(t,!1)}});var ne={ygrids:ae},re={groups:function(t){var e=this.internal,i=e.config;return O(t)?i.data_groups:(i.data_groups=t,e.redraw(),i.data_groups)}};function se(t){var e=this.internal,i=e.config;return t?(i.regions=t,e.redrawWithoutRescale(),t):i.regions}U(se,{add:function(t){var e=this.internal,i=e.config;return t?(i.regions=i.regions.concat(t),e.redrawWithoutRescale(),i.regions):i.regions},remove:function(t){var e=this.internal,i=e.config,a=t||{},n=B(a,"duration",i.transition_duration),r=B(a,"classes",[c.region]),s=e.$el.main.select("."+c.regions).selectAll(r.map((function(t){return"."+t})));return(n?s.transition().duration(n):s).style("opacity","0").remove(),s=i.regions,Object.keys(a).length?(s=s.filter((function(t){var e=!1;return!t.class||(t.class.split(" ").forEach((function(t){r.indexOf(t)>=0&&(e=!0)})),!e)})),i.regions=s):i.regions=[],s}});var oe={regions:se},ce={selected:function(t){var e=this.internal,i=[];return e.$el.main.selectAll("."+(c.shapes+e.getTargetSelectorSuffix(t))).selectAll("."+c.shape).filter((function(){return Object(s.select)(this).classed(c.SELECTED)})).each((function(t){return i.push(t)})),i},select:function(t,e,i){var a=this.internal,n=a.config,r=a.$el;n.data_selection_enabled&&r.main.selectAll("."+c.shapes).selectAll("."+c.shape).each((function(r,o){var l=Object(s.select)(this),u=r.data?r.data.id:r.id,d=a.getToggle(this,r).bind(a),h=n.data_selection_grouped||!t||t.indexOf(u)>=0,g=!e||e.indexOf(o)>=0,f=l.classed(c.SELECTED);l.classed(c.line)||l.classed(c.area)||(h&&g?n.data_selection_isselectable.bind(a.api)(r)&&!f&&d(!0,l.classed(c.SELECTED,!0),r,o):k(i)&&i&&f&&d(!1,l.classed(c.SELECTED,!1),r,o))}))},unselect:function(t,e){var i=this.internal,a=i.config,n=i.$el;a.data_selection_enabled&&n.main.selectAll("."+c.shapes).selectAll("."+c.shape).each((function(n,r){var o=Object(s.select)(this),l=n.data?n.data.id:n.id,u=i.getToggle(this,n).bind(i),d=a.data_selection_grouped||!t||t.indexOf(l)>=0,h=!e||e.indexOf(r)>=0,g=o.classed(c.SELECTED);o.classed(c.line)||o.classed(c.area)||d&&h&&a.data_selection_isselectable.bind(i.api)(n)&&g&&u(!1,o.classed(c.SELECTED,!1),n,r)}))}},le={x:function(t){var e=this.internal,i=e.isCustomX()&&e.isCategorized();return M(t)&&(i?this.categories(t):(e.updateTargetX(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))),i?this.categories():e.data.xs},xs:function(t){var e=this.internal;return P(t)&&(e.updateTargetXs(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs}},ue=i(10);var de=function(t){var e,i=this.internal,a=i.config,n=i.scale,r=t;if(a.zoom_enabled&&r&&function(t,e){var i=e[0],a=e[1];return t.every((function(t,e){return 0===e?t>=i:t<=a}))}(r,i.getZoomDomain())){if(i.isTimeSeries()){var s=st.bind(i);r=r.map((function(t){return s(t)}))}if(a.subchart_show){var o=n.zoom||n.x;i.brush.getSelection().call(i.brush.move,[o(r[0]),o(r[1])]),e=r}else n.x.domain(r),n.zoom=n.x,i.axis.x.scale(n.zoom),e=n.zoom.orgDomain();i.redraw({withTransition:!0,withY:a.zoom_rescale,withDimension:!1}),i.setZoomResetButton(),$(a.zoom_onzoom,i.api,e)}else e=n.zoom?n.zoom.domain():n.x.orgDomain();return e};U(de,{enable:function(t){var e=this.internal,i=e.config,a=t;t&&(a=L(t)&&/^(drag|wheel)$/.test(t)?{type:t}:t),i.zoom_enabled=a,e.zoom?!1===t&&e.bindZoomEvent(!1):(e.initZoom(),e.bindZoomEvent()),e.updateAndRedraw()},max:function(t){var e=this.internal,i=e.config,a=e.org.xDomain;return(0===t||t)&&(i.zoom_x_max=it("max",[a[1],t])),i.zoom_x_max},min:function(t){var e=this.internal,i=e.config,a=e.org.xDomain;return(0===t||t)&&(i.zoom_x_min=it("min",[a[0],t])),i.zoom_x_min},range:function(t){var e=this.zoom;if(P(t)){var i=t.min,a=t.max;k(i)&&e.min(i),k(a)&&e.max(a)}return{min:e.min(),max:e.max()}}});var he={zoom:de,unzoom:function(){var t=this.internal,e=t.config;if(t.scale.zoom){e.subchart_show?t.brush.getSelection().call(t.brush.move,null):t.zoom.updateTransformScale(ue.zoomIdentity),t.updateZoom(!0),t.zoom.resetBtn&&t.zoom.resetBtn.style("display","none");var i=t.$el.main.select("."+c.eventRects);Object(ue.zoomTransform)(i.node())!==ue.zoomIdentity&&t.zoom.transform(i,ue.zoomIdentity),t.redraw({withTransition:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withY:e.zoom_rescale})}}},ge={drag:function(t){var e=this,i=e.config,a=e.state,n=e.$el.main;if(!e.hasArcType()&&i.data_selection_enabled&&(!i.zoom_enabled||e.zoom.altDomain)&&i.data_selection_multiple){var r=a.dragStart,o=r[0],l=r[1],u=t[0],d=t[1],h=Math.min(o,u),g=Math.max(o,u),f=i.data_selection_grouped?a.margin.top:Math.min(l,d),p=i.data_selection_grouped?a.height:Math.max(l,d);n.select("."+c.dragarea).attr("x",h).attr("y",f).attr("width",g-h).attr("height",p-f),n.selectAll("."+c.shapes).selectAll("."+c.shape).filter((function(t){return i.data_selection_isselectable.bind(e.api)(t)})).each((function(t,i){var a,n=Object(s.select)(this),r=n.classed(c.SELECTED),o=n.classed(c.INCLUDED),l=!1;if(n.classed(c.circle)){var u=1*+n.attr("cx"),d=1*+n.attr("cy");a=e.togglePoint,l=h<u&&u<g&&f<d&&d<p}else{if(!n.classed(c.bar))return;var x=function(t){var e=t.getBoundingClientRect(),i=e.width,a=e.height,n=N(t);return{x:n[0].x,y:Math.min(n[0].y,n[1].y),width:i,height:a}}(this),v=x.x,m=(d=x.y,x.width),_=x.height;a=e.togglePath,l=!(g<v||v+m<h||p<d||d+_<f)}l^o&&(n.classed(c.INCLUDED,!o),n.classed(c.SELECTED,!r),a.call(e,!r,n,t,i))}))}},dragstart:function(t){var e=this,i=e.config,a=e.state,n=e.$el.main;e.hasArcType()||!i.data_selection_enabled||(a.dragStart=t,n.select("."+c.chart).append("rect").attr("class",c.dragarea).style("opacity","0.1"),e.setDragStatus(!0))},dragend:function(){var t=this.config,e=this.$el.main;this.hasArcType()||!t.data_selection_enabled||(e.select("."+c.dragarea).transition().duration(100).style("opacity","0").remove(),e.selectAll("."+c.shape).classed(c.INCLUDED,!1),this.setDragStatus(!1))},setDragStatus:function(t){this.dragging=t}},fe=i(11),pe={generateFlow:function(t){var e=this,i=e.data,a=e.state,n=e.$el;return function(){var r=t.flow.length;a.flowing=!0,i.targets.forEach((function(t){t.values.splice(0,r)})),e.updateXGrid&&e.updateXGrid(!0);var s={};["axis.x","grid.x","gridLines.x","region.list","text","bar","line","area","circle"].forEach((function(t){var e=t.split("."),i=n[e[0]];i&&e.length>1&&(i=i[e[1]]),i&&i.size()&&(s[t]=i)})),e.hideGridFocus(),e.setFlowList(s,t)}},setFlowList:function(t,e){var i=this,a=e.flow,n=e.targets,r=a,s=r.duration,c=void 0===s?e.duration:s,l=r.index,u=r.length,d=r.orgDataCount,h=i.getFlowTransform(n,d,l,u),g=i.generateWait(),f=Object(o.transition)().ease(fe.easeLinear).duration(c);g.add(Object.keys(t).map((function(e){var a=t[e];return a="axis.x"===e?a.transition(f).call((function(t){return i.axis.x.setTransition(f).create(t)})):"region.list"===e?a.filter(i.isRegionOnX).transition(f).attr("transform",h):a.transition(f).attr("transform",h)}))),f.call(g,(function(){i.cleanUpFlow(t,e)}))},cleanUpFlow:function(t,e){var i=this,a=i.config,n=i.state,r=i.$el.svg,s=a.axis_rotated,o=e.flow,l=e.shape,u=e.xv,d=l.pos,h=d.cx,g=d.cy,f=d.xForText,p=d.yForText,x=o,v=x.done,m=void 0===v?function(){}:v,_=x.length;_&&(["circle","text","shape","eventRect"].forEach((function(t){for(var e=[],i=0;i<_;i++)e.push("."+c[t]+"-"+i);r.selectAll("."+c[t+"s"]).selectAll(e).remove()})),r.select("."+c.xgrid).remove()),Object.keys(t).forEach((function(e){var r=t[e];if("axis.x"!==e&&r.attr("transform",null),"grid.x"===e)r.attr(n.xgridAttr);else if("gridLines.x"===e)r.attr("x1",s?0:u).attr("x2",s?n.width:u);else if("gridLines.x"===e)r.select("line").attr("x1",s?0:u).attr("x2",s?n.width:u),r.select("text").attr("x",s?n.width:0).attr("y",u);else if(/^(area|bar|line)$/.test(e))r.attr("d",l.type[e]);else if("text"===e)r.attr("x",f).attr("y",p).style("fill-opacity",i.opacityForText.bind(i));else if("circle"!==e)"region.list"===e&&r.select("rect").filter(i.isRegionOnX).attr("x",i.regionX.bind(i)).attr("width",i.regionWidth.bind(i));else if(i.isCirclePoint())r.attr("cx",h).attr("cy",g);else{r.attr("x",(function(t){return h(t)-a.point_r})).attr("y",(function(t){return g(t)-a.point_r})).attr("cx",h).attr("cy",g)}})),a.interaction_enabled&&i.redrawEventRect(),m.call(i.api),n.flowing=!1},getFlowTransform:function(t,e,i,a){var n,r=this,s=r.data,o=r.scale.x,c=s.targets[0].values,l=r.getValueOnIndex(c,i),u=r.getValueOnIndex(c,i+a),d=o.domain(),h=r.updateXDomain(t,!0,!0);return e?n=1===e||(l&&l.x)===(u&&u.x)?o(d[0])-o(h[0]):r.isTimeSeries()?o(d[0])-o(h[0]):o(l.x)-o(u.x):1===c.length?r.isTimeSeries()?(l=r.getValueOnIndex(c,0),u=r.getValueOnIndex(c,c.length-1),n=o(l.x)-o(u.x)):n=E(h)/2:n=o(d[0])-o(h[0]),"translate("+n+",0) scale("+E(d)/E(h)+",1)"}},xe={initEventRect:function(){this.$el.main.select("."+c.chart).append("g").attr("class",c.eventRects).style("fill-opacity","0")},redrawEventRect:function(){var t,e=this,i=e.config,a=e.$el,n=e.isMultipleX(),r=i.zoom_enabled,s=e.$el.main.select("."+c.eventRects).style("cursor",r&&"drag"!==r.type?i.axis_rotated?"ns-resize":"ew-resize":null).classed(c.eventRectsMultiple,n).classed(c.eventRectsSingle,!n);if(s.selectAll("."+c.eventRect).remove(),a.eventRect=s.selectAll("."+c.eventRect),n)t=a.eventRect.data([0]),t=e.generateEventRectsForMultipleXs(t.enter()).merge(t);else{var o=e.getMaxDataCountTarget();e.updateDataIndexByX(o),e.updateXs(o),e.updatePointClass(!0),s.datum(o),a.eventRect=s.selectAll("."+c.eventRect),(t=a.eventRect.data((function(t){return t}))).exit().remove(),t=e.generateEventRectsForSingleX(t.enter()).merge(t)}a.eventRect=t,e.updateEventRect(t),"touch"!==e.state.inputType||a.svg.on("touchstart.eventRect")||e.hasArcType()||e.bindTouchOnEventRect(n)},bindTouchOnEventRect:function(t){var e,i=this,a=i.config,n=i.state,r=i.$el.svg,o=function(){var t=s.event.changedTouches[0];return Object(s.select)(w.elementFromPoint(t.clientX,t.clientY))},l=function(e){if(t)i.selectRectForMultipleXs(e);else{var a=o(),n=function(t){var e=t&&t.attr("class")&&1*t.attr("class").replace(new RegExp("("+c.eventRect+"-?|s)","g"),"");return(isNaN(e)||null===e)&&(e=-1),e}(a);i.callOverOutForTouch(n),-1===n?i.unselectRect():i.selectRectForSingle(e,a,n)}},u=a.interaction_inputType_touch.preventDefault,d=D(u)&&u||!1,h=!isNaN(u)&&u||null;r.on("touchstart.eventRect touchmove.eventRect",(function(){var t=o(),r=s.event;if(!t.empty()&&t.classed(c.eventRect)){if(n.dragging||n.flowing||i.hasArcType()||r.touches.length>1)return;(function(t){var i=t.type,n=t.changedTouches[0]["client"+(a.axis_rotated?"Y":"X")];"touchstart"===i?d?t.preventDefault():null!==h&&(e=n):"touchmove"===i&&(d||!0===e||null!==h&&Math.abs(e-n)>=h)&&(e=!0,t.preventDefault())})(r),l(this)}else i.unselectRect(),i.callOverOutForTouch()}),!0).on("touchend.eventRect",(function(){var t=o();!t.empty()&&t.classed(c.eventRect)&&(i.hasArcType()||!i.toggleShape||n.cancelClick)&&n.cancelClick&&(n.cancelClick=!1)}),!0)},updateEventRect:function(t){var e,i,a,n,r=this,s=r.config,o=r.scale,c=r.state,l=o.zoom||o.x,u=t||r.$el.eventRect.data(),d=s.axis_rotated;if(r.isMultipleX())e=0,i=0,a=c.width,n=c.height;else{var h,g;if(r.isCategorized())h=r.getEventRectWidth(),g=function(t){return l(t.x)-h/2};else{var f=function(t){var e=t.index;return{prev:r.getPrevX(e),next:r.getNextX(e)}};h=function(t){var e=f(t);return null===e.prev&&null===e.next?d?c.height:c.width:(null===e.prev&&(e.prev=l.domain()[0]),null===e.next&&(e.next=l.domain()[1]),Math.max(0,(l(e.next)-l(e.prev))/2))},g=function(t){var e=f(t),i=t.x;return null===e.prev&&null===e.next?0:(null===e.prev&&(e.prev=l.domain()[0]),(l(i)+l(e.prev))/2)}}e=d?0:g,i=d?g:0,a=d?c.width:h,n=d?h:c.height}u.attr("class",r.classEvent.bind(r)).attr("x",e).attr("y",i).attr("width",a).attr("height",n)},selectRectForSingle:function(t,e,i){var a=this,n=a.config,r=a.$el.main,o=n.data_selection_enabled,l=n.data_selection_grouped,u=n.tooltip_grouped,d=a.getAllValuesOnIndex(i);u&&(a.showTooltip(d,t),a.showGridFocus(d),!o||l)||r.selectAll("."+c.shape+"-"+i).each((function(){Object(s.select)(this).classed(c.EXPANDED,!0),o&&e.style("cursor",l?"pointer":null),u||(a.hideGridFocus(),a.hideTooltip(),!l&&a.expandCirclesBars(i))})).filter((function(t){return a.isWithinShape(this,t)})).call((function(r){var s=r.data();o&&(l||n.data_selection_isselectable.bind(a.api)(s))&&e.style("cursor","pointer"),u||(a.showTooltip(s,t),a.showGridFocus(s),a.unexpandCircles(),r.each((function(t){return a.expandCirclesBars(i,t.id)})))}))},expandCirclesBars:function(t,e,i){var a=this.config,n=this.$el,r=n.bar;n.circle&&a.point_focus_expand_enabled&&this.expandCircles(t,e,i),r&&this.expandBars(t,e,i)},selectRectForMultipleXs:function(t){var e=this,i=e.config,a=e.state,n=e.filterTargetsToShow(e.data.targets);if(!e.dragging&&!e.hasArcType(n)){var r=Object(s.mouse)(t),o=e.findClosestFromTargets(n,r);if(a.mouseover&&(!o||o.id!==a.mouseover.id)&&(i.data_onout.call(e.api,a.mouseover),a.mouseover=void 0),!o)return void e.unselectRect();var l=(e.isBubbleType(o)||e.isScatterType(o)||!i.tooltip_grouped?[o]:e.filterByX(n,o.x)).map((function(t){return e.addName(t)}));e.showTooltip(l,t),e.expandCirclesBars(o.index,o.id,!0),e.showGridFocus(l),(e.isBarType(o.id)||e.dist(o,r)<i.point_sensitivity)&&(e.$el.svg.select("."+c.eventRect).style("cursor","pointer"),!a.mouseover&&(i.data_onover.call(e.api,o),a.mouseover=o))}},unselectRect:function(){var t=this,e=t.$el,i=e.bar,a=e.circle,n=e.tooltip;t.$el.svg.select("."+c.eventRect).style("cursor",null),t.hideGridFocus(),n&&(t.hideTooltip(),t._handleLinkedCharts(!1)),a&&t.unexpandCircles(),i&&t.unexpandBars()},generateEventRectsForSingleX:function(t){var e=this,i=e.config,a=e.state,n=t.append("rect").attr("class",e.classEvent.bind(e)).style("cursor",i.data_selection_enabled&&i.data_selection_grouped?"pointer":null).on("click",(function(t){e.clickHandlerForSingleX.bind(this)(t,e)})).call(e.getDraggableSelection());return"mouse"===a.inputType&&n.on("mouseover",(function(t){a.dragging||a.flowing||e.hasArcType()||i.tooltip_grouped&&e.setOverOut(!0,t.index)})).on("mousemove",(function(t){if(!(a.dragging||a.flowing||e.hasArcType())){var n=t.index,r=e.$el.svg.select("."+c.eventRect+"-"+n);e.isStepType(t)&&"step-after"===i.line_step_type&&Object(s.mouse)(this)[0]<e.scale.x(e.getXValue(t.id,n))&&(n-=1),-1===n?e.unselectRect():e.selectRectForSingle(this,r,n),i.tooltip_grouped||e.setOverOut(-1!==n,t.index)}})).on("mouseout",(function(t){!i||e.hasArcType()||(e.unselectRect(),e.setOverOut(!1,t.index))})),n},clickHandlerForSingleX:function(t,e){var i=e,a=i.config,n=i.state,r=i.$el.main;if(i.hasArcType()||!i.toggleShape||n.cancelClick)n.cancelClick&&(n.cancelClick=!1);else{var s=t.index;r.selectAll("."+c.shape+"-"+s).each((function(t){(a.data_selection_grouped||i.isWithinShape(this,t))&&(i.toggleShape(this,t,s),a.data_onclick.bind(i.api)(t,this))}))}},generateEventRectsForMultipleXs:function(t){var e=this,i=e.state,a=i.width,n=i.height,r=i.inputType,s=t.append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",n).attr("class",c.eventRect).on("click",(function(){e.clickHandlerForMultipleXS.bind(this)(e)})).call(e.getDraggableSelection());return"mouse"===r&&s.on("mouseover mousemove",(function(){e.selectRectForMultipleXs(this)})).on("mouseout",(function(){!e.config||e.hasArcType()||e.unselectRect()})),s},clickHandlerForMultipleXS:function(t){var e=t,i=e.config,a=e.filterTargetsToShow(e.data.targets);if(!e.hasArcType(a)){var n=Object(s.mouse)(this),r=e.findClosestFromTargets(a,n);!r||(e.isBarType(r.id)||e.dist(r,n)<i.point_sensitivity)&&e.$el.main.selectAll("."+c.shapes+e.getTargetSelectorSuffix(r.id)).selectAll("."+c.shape+"-"+r.index).each((function(){(i.data_selection_grouped||e.isWithinShape(this,r))&&(e.toggleShape(this,r,r.index),i.data_onclick.bind(e.api)(r,this))}))}}},ve={initBrush:function(){var t=this,e=t.config,i=t.scale,a=t.$el.subchart,n=e.axis_rotated;t.brush=n?Object(b.brushY)():Object(b.brushX)();var r,o,l=function(){t.redrawForBrush()};t.brush.on("start",(function(){"touch"===t.state.inputType&&t.hideTooltip(),l()})).on("brush",l).on("end",(function(){r=i.x.orgDomain()})),t.brush.updateResize=function(){var t=this;o&&clearTimeout(o),o=setTimeout((function(){var e=t.getSelection();r&&Object(b.brushSelection)(e.node())&&t.move(e,r.map(i.subX.orgScale()))}),0)},t.brush.update=function(){return 0===this.extent()()[1].filter((function(t){return isNaN(t)})).length&&a.main&&a.main.select("."+c.brush).call(this),this},t.brush.scale=function(i){var a,r,s=e.subchart_size_height||(a=t.$el.svg.select("."+c.brush+" .overlay"),r={width:0,height:0},a.size()&&(r.width=+a.attr("width"),r.height=+a.attr("height")),r[n?"width":"height"]),o=t.getExtent();!o&&i.range?o=[[0,0],[i.range()[1],s]]:M(o)&&(o=o.map((function(t,e){return[t,e>0?s:e]}))),n&&o[1].reverse(),this.extent(o),this.update()},t.brush.getSelection=function(){return a.main?a.main.select("."+c.brush):Object(s.select)([])}},initSubchart:function(){var t=this,e=t.config,i=t.state,a=i.clip,n=i.hasAxis,r=t.$el,s=r.defs,o=r.svg,l=r.subchart,u=r.axis;if(n){var d=e.subchart_show?"visible":"hidden",h=a.id+"-subchart",g=t.getClipPath(h);a.idSubchart=h,t.appendClip(s,h),t.initBrush(),l.main=o.append("g").attr("transform",t.getTranslate("context"));var f=l.main;f.style("visibility",d),f.append("g").attr("clip-path",g).attr("class",c.chart),t.hasType("bar")&&f.select("."+c.chart).append("g").attr("class",c.chartBars),f.select("."+c.chart).append("g").attr("class",c.chartLines),f.append("g").attr("clip-path",g).attr("class",c.brush).call(t.brush),u.subX=f.append("g").attr("class",c.axisX).attr("transform",t.getTranslate("subX")).attr("clip-path",e.axis_rotated?"":a.pathXAxis).style("visibility",e.subchart_axis_x_show?d:"hidden")}},updateTargetsForSubchart:function(t){var e=this,i=e.config,a=e.state,n=e.$el.subchart.main,r=e.classChartBar.bind(e),s=e.classBars.bind(e),o=e.classChartLine.bind(e),l=e.classLines.bind(e),u=e.classAreas.bind(e);if(i.subchart_show){var d=n.select("."+c.chartBars).selectAll("."+c.chartBar).data(t).attr("class",r);d.enter().append("g").style("opacity","0").attr("class",r).merge(d).append("g").attr("class",s);var h=n.select("."+c.chartLines).selectAll("."+c.chartLine).data(t).attr("class",o),g=h.enter().append("g").style("opacity","0").attr("class",o).merge(h);g.append("g").attr("class",l),e.hasType("area")&&g.append("g").attr("class",u),n.selectAll("."+c.brush+" rect").attr(i.axis_rotated?"width":"height",i.axis_rotated?a.width2:a.height2)}},updateBarForSubchart:function(t){var e=this,i=e.$el.subchart;i.bar=i.main.selectAll("."+c.bars).selectAll("."+c.bar).data(e.barData.bind(e)),i.bar.exit().transition().duration(t).style("opacity","0").remove(),i.bar=i.bar.enter().append("path").attr("class",e.classBar.bind(e)).style("stroke","none").style("fill",e.color).merge(i.bar).style("opacity",e.initialOpacity.bind(e))},redrawBarForSubchart:function(t,e,i){var a=this.$el.subchart.bar;(e?a.transition(H()).duration(i):a).attr("d",t).style("opacity","1")},updateLineForSubchart:function(t){var e=this,i=e.$el.subchart;i.line=i.main.selectAll("."+c.lines).selectAll("."+c.line).data(e.lineData.bind(e)),i.line.exit().transition().duration(t).style("opacity","0").remove(),i.line=i.line.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color).merge(i.line).style("opacity",e.initialOpacity.bind(e))},redrawLineForSubchart:function(t,e,i){var a=this.$el.subchart.line;(e?a.transition(H()).duration(i):a).attr("d",t).style("opacity","1")},updateAreaForSubchart:function(t){var e=this,i=e.$el.subchart;i.area=i.main.selectAll("."+c.areas).selectAll("."+c.area).data(e.lineData.bind(e)),i.area.exit().transition().duration(t).style("opacity","0").remove(),i.area=i.area.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",(function(){return e.state.orgAreaOpacity=Object(s.select)(this).style("opacity"),"0"})).merge(i.area).style("opacity","0")},redrawAreaForSubchart:function(t,e,i){var a=this.$el.subchart.area;(e?a.transition(H()).duration(i):a).attr("d",t).style("fill",this.color).style("opacity",this.state.orgAreaOpacity)},redrawSubchart:function(t,e,i){var a=this,n=a.config;a.$el.subchart.main.style("visibility",n.subchart_show?"visible":"hidden"),n.subchart_show&&(s.event&&"zoom"===s.event.type&&a.brush.update(),t&&(!W(a)&&a.brush.update(),Object.keys(i.type).forEach((function(t){var n=Z(t),r=a["generateDraw"+n](i.indices[t],!0);a["update"+n+"ForSubchart"](e),a["redraw"+n+"ForSubchart"](r,e,e)}))))},redrawForBrush:function(){var t=this.config,e=t.subchart_onbrush,i=t.zoom_rescale,a=this.scale;this.redraw({withTransition:!1,withY:i,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),e.bind(this.api)(a.x.orgDomain())},transformContext:function(t,e){var i,a=this.$el.subchart.main;e&&e.axisSubX?i=e.axisSubX:(i=a.select("."+c.axisX),t&&(i=i.transition())),a.attr("transform",this.getTranslate("context")),i.attr("transform",this.getTranslate("subX"))},getExtent:function(){var t=this,e=t.config,i=t.scale,a=e.axis_x_extent;if(a)if(S(a))a=a.bind(t.api)(t.getXDomain(t.data.targets),i.subX);else if(t.isTimeSeries()&&a.every(isNaN)){var n=st.bind(t);a=a.map((function(t){return i.subX(n(t))}))}return a}},me={initZoom:function(){this.scale.zoom=null,this.generateZoom(),this.initZoomBehaviour()},bindZoomEvent:function(t){void 0===t&&(t=!0);var e=this,i=e.config,a=e.$el.main,n=i.zoom_enabled;e.redrawEventRect();var r=a.select("."+c.eventRects);n&&t?!i.subchart_show&&e.bindZoomOnEventRect(r,n.type):!1===t&&(e.api.unzoom(),r.on(".zoom",null).on(".drag",null))},generateZoom:function(){var t=this,e=t.config,i=t.org,a=t.scale,n=Object(ue.zoom)().duration(0).on("start",t.onZoomStart.bind(t)).on("zoom",t.onZoom.bind(t)).on("end",t.onZoomEnd.bind(t));n.orgScaleExtent=function(){var i=e.zoom_extent||[1,10];return[i[0],Math.max(t.getMaxDataCount()/i[1],i[1])]},n.updateScaleExtent=function(){var e=E(t.scale.x.orgDomain())/E(t.getZoomDomain()),i=this.orgScaleExtent();return this.scaleExtent([i[0]*e,i[1]*e]),this},n.updateTransformScale=function(n){i.xScale&&i.xScale.range(a.x.range());var r=n[e.axis_rotated?"rescaleY":"rescaleX"](i.xScale||a.x),s=t.trimXDomain(r.domain()),o=e.zoom_rescale;r.domain(s,i.xDomain),a.zoom=t.getCustomizedScale(r),t.axis.x.scale(a.zoom),o&&(!i.xScale&&(i.xScale=a.x.copy()),a.x.domain(s))},t.zoom=n},onZoomStart:function(){var t=s.event.sourceEvent;t&&(this.zoom.startEvent=t,$(this.config.zoom_onzoomstart,this.api,t))},onZoom:function(){var t=this,e=t.config,i=t.scale,a=t.org,n=s.event,r=n.sourceEvent;if(e.zoom_enabled&&n.sourceEvent&&0!==t.filterTargetsToShow(t.data.targets).length&&(i.zoom||!(r.type.indexOf("touch")>-1)||1!==r.touches.length)){var o="mousemove"===r.type,c=r.wheelDelta<0,l=n.transform;!o&&c&&i.x.domain().every((function(t,e){return t!==a.xDomain[e]}))&&i.x.domain(a.xDomain),t.zoom.updateTransformScale(l),t.isCategorized()&&i.x.orgDomain()[0]===a.xDomain[0]&&i.x.domain([a.xDomain[0]-1e-10,i.x.orgDomain()[1]]),t.redraw({withTransition:!1,withY:e.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),t.state.cancelClick=o,$(e.zoom_onzoom,t.api,i.zoom.domain())}},onZoomEnd:function(){var t=this,e=t.config,i=t.scale,a=t.zoom.startEvent,n=s.event&&s.event.sourceEvent;a&&a.type.indexOf("touch")>-1&&(a=a.changedTouches[0],n=n.changedTouches[0]),!a||n&&a.clientX===n.clientX&&a.clientY===n.clientY||(t.redrawEventRect(),t.updateZoom(),$(e.zoom_onzoomend,t.api,i[i.zoom?"zoom":"subX"].domain()))},getZoomDomain:function(){var t=this.config,e=this.org.xDomain,i=e[0],a=e[1];return k(t.zoom_x_min)&&(i=it("min",[i,t.zoom_x_min])),k(t.zoom_x_max)&&(a=it("max",[a,t.zoom_x_max])),[i,a]},updateZoom:function(t){var e=this.scale,i=e.subX,a=e.x,n=e.zoom;if(n){var r=n.domain(),s=i.domain(),o=(r[0]<=s[0]||r[0]-.015<=s[0])&&(s[1]<=r[1]||s[1]<=r[1]-.015);(t||o)&&(this.axis.x.scale(i),a.domain(i.orgDomain()),n=null)}},bindZoomOnEventRect:function(t,e){var i="drag"===e?this.zoomBehaviour:this.zoom;t.call(i).on("dblclick.zoom",null)},initZoomBehaviour:function(){var t,e=this,i=e.config,a=e.state,n=i.axis_rotated,r=0,o=0,l={axis:n?"y":"x",attr:n?"height":"width",index:n?1:0};e.zoomBehaviour=Object(Et.drag)().clickDistance(4).on("start",(function(){e.setDragStatus(!0),t||(t=e.$el.main.append("rect").attr("clip-path",a.clip.path).attr("class",c.zoomBrush).attr("width",n?a.width:0).attr("height",n?0:a.height)),r=Object(s.mouse)(this)[l.index],o=r,t.attr(l.axis,r).attr(l.attr,0),e.onZoomStart()})).on("drag",(function(){o=Object(s.mouse)(this)[l.index],t.attr(l.axis,Math.min(r,o)).attr(l.attr,Math.abs(o-r))})).on("end",(function(){var i,a=e.scale.zoom||e.scale.x;if(e.setDragStatus(!1),t.attr(l.axis,0).attr(l.attr,0),r>o&&(r=(i=[o,r])[0],o=i[1]),r<0&&(o+=Math.abs(r),r=0),r!==o)e.api.zoom([r,o].map((function(t){return a.invert(t)}))),e.onZoomEnd();else if(e.isMultipleX())e.clickHandlerForMultipleXS.bind(this)(e);else{var n=s.event.sourceEvent||s.event,c="clientX"in n?[n.clientX,n.clientY]:[n.x,n.y],u=c[0],d=c[1],h=w.elementFromPoint(u,d);e.clickHandlerForSingleX.bind(h)(Object(s.select)(h).datum(),e)}}))},setZoomResetButton:function(){var t=this,e=t.config,i=e.zoom_resetButton;i&&"drag"===e.zoom_enabled.type&&(t.zoom.resetBtn?t.zoom.resetBtn.style("display",null):t.zoom.resetBtn=t.$el.chart.append("div").classed(c.button,!0).append("span").on("click",(function(){S(i.onclick)&&i.onclick.bind(t.api)(this),t.api.unzoom()})).classed(c.buttonZoomReset,!0).text(i.text||"Reset Zoom"))}},_e={initClip:function(){var t=this,e=t.state.clip;e.id=t.state.datetimeId+"-clip",e.idXAxis=e.id+"-xaxis",e.idYAxis=e.id+"-yaxis",e.idGrid=e.id+"-grid",e.path=t.getClipPath(e.id),e.pathXAxis=t.getClipPath(e.idXAxis),e.pathYAxis=t.getClipPath(e.idYAxis),e.pathGrid=t.getClipPath(e.idGrid)},getClipPath:function(t){var e=this.config;return!e.clipPath&&/-clip$/.test(t)||!e.axis_x_clipPath&&/-clip-xaxis$/.test(t)||!e.axis_y_clipPath&&/-clip-yaxis$/.test(t)?null:"url("+(!!T.navigator&&T.navigator.appVersion.toLowerCase().indexOf("msie 9.")>=0?"":w.URL.split("#")[0])+"#"+t+")"},appendClip:function(t,e){return t.append("clipPath").attr("id",e).append("rect")},getAxisClipX:function(t){var e=this.state.margin,i=Math.max(30,e.left);return t?-(1+i):-(i-1)},getAxisClipY:function(t){var e=this.state.margin;return t?-20:-e.top},getXAxisClipX:function(){return this.getAxisClipX(!this.config.axis_rotated)},getXAxisClipY:function(){return this.getAxisClipY(!this.config.axis_rotated)},getYAxisClipX:function(){return this.config.axis_y_inner?-1:this.getAxisClipX(this.config.axis_rotated)},getYAxisClipY:function(){return this.getAxisClipY(this.config.axis_rotated)},getAxisClipWidth:function(t){var e=this.state,i=e.margin,a=e.width,n=Math.max(30,i.left),r=Math.max(30,i.right);return t?a+2+n+r:i.left+20},getAxisClipHeight:function(t){var e=this.state,i=e.margin,a=e.height;return(t?i.bottom:i.top+a)+20},getXAxisClipWidth:function(){return this.getAxisClipWidth(!this.config.axis_rotated)},getXAxisClipHeight:function(){return this.getAxisClipHeight(!this.config.axis_rotated)},getYAxisClipWidth:function(){return this.getAxisClipWidth(this.config.axis_rotated)+(this.config.axis_y_inner?20:0)},getYAxisClipHeight:function(){return this.getAxisClipHeight(this.config.axis_rotated)}},ye=function(t){return A(t.position)||"end"},be=function(t){return"start"===t.position?4:"middle"===t.position?0:-4};function Te(t,e,i){return function(a){var n=t?0:e;return"start"===a.position?n=t?-i:0:"middle"===a.position&&(n=(t?-i:e)/2),n}}function we(t,e){"grid"===e&&t.each((function(){var t=Object(s.select)(this);["x1","x2","y1","y2"].forEach((function(e){return t.attr(e,Math.ceil(+t.attr(e)))}))}))}var Ae={hasGrid:function(){var t=this.config;return["x","y"].some((function(e){return t["grid_"+e+"_show"]||t["grid_"+e+"_lines"].length}))},initGrid:function(){this.hasGrid()&&this.initGridLines(),this.initFocusGrid()},initGridLines:function(){var t=this.config,e=this.state.clip,i=this.$el,a=i.gridLines,n=i.main;(t.grid_x_lines.length||t.grid_y_lines.length)&&(a.main=n.insert("g","."+c.chart+(t.grid_lines_front?" + *":"")).attr("clip-path",e.pathGrid).attr("class",c.grid+" "+c.gridLines),a.main.append("g").attr("class",c.xgridLines),a.main.append("g").attr("class",c.ygridLines),a.x=Object(s.selectAll)([]))},updateXGrid:function(t){var e=this,i=e.config,a=e.scale,n=e.state,r=e.$el,o=r.main,l=r.grid,u=i.axis_rotated,d=e.generateGridData(i.grid_x_type,a.x),h=e.isCategorized()?e.axis.x.tickOffset():0,g=function(t){return((a.zoom||a.x)(t)+h)*(u?-1:1)};n.xgridAttr=u?{x1:0,x2:n.width,y1:g,y2:g}:{x1:g,x2:g,y1:0,y2:n.height},l.x=o.select("."+c.xgrids).selectAll("."+c.xgrid).data(d),l.x.exit().remove(),l.x=l.x.enter().append("line").attr("class",c.xgrid).merge(l.x),t||l.x.each((function(){var t=Object(s.select)(this);Object.keys(n.xgridAttr).forEach((function(e){t.attr(e,n.xgridAttr[e]).style("opacity",(function(){return t.attr(u?"y1":"x1")===(u?n.height:0)?"0":"1"}))}))}))},updateYGrid:function(){var t=this,e=t.config,i=t.state,a=t.$el,n=a.grid,r=a.main,s=e.axis_rotated,o=t.axis.y.tickValues()||t.scale.y.ticks(e.grid_y_ticks),l=function(e){return Math.ceil(t.scale.y(e))};n.y=r.select("."+c.ygrids).selectAll("."+c.ygrid).data(o),n.y.exit().remove(),n.y=n.y.enter().append("line").attr("class",c.ygrid).merge(n.y),n.y.attr("x1",s?l:0).attr("x2",s?l:i.width).attr("y1",s?0:l).attr("y2",s?i.height:l),we(n.y,"grid")},updateGrid:function(t){var e=this,i=e.$el,a=i.grid;i.gridLines.main||e.initGridLines(),a.main.style("visibility",e.hasArcType()?"hidden":"visible"),e.hideGridFocus(),e.updateXGridLines(t),e.updateYGridLines(t)},updateXGridLines:function(t){var e=this.config,i=this.$el,a=i.gridLines,n=i.main,r=e.axis_rotated;e.grid_x_show&&this.updateXGrid();var s=n.select("."+c.xgridLines).selectAll("."+c.xgridLine).data(e.grid_x_lines);s.exit().transition().duration(t).style("opacity","0").remove();var o=s.enter().append("g");o.append("line").style("opacity","0"),o.append("text").attr("transform",r?"":"rotate(-90)").attr("dy",-5).style("opacity","0"),(s=o.merge(s)).attr("class",(function(t){return(c.xgridLine+" "+(t.class||"")).trim()})).select("text").attr("text-anchor",ye).attr("dx",be).transition().duration(t).text((function(t){return t.text})).transition().style("opacity","1"),a.x=s},updateYGridLines:function(t){var e=this,i=e.config,a=e.state,n=a.width,r=a.height,s=e.$el,o=i.axis_rotated;i.grid_y_show&&e.updateYGrid();var l=s.main.select("."+c.ygridLines).selectAll("."+c.ygridLine).data(i.grid_y_lines);l.exit().transition().duration(t).style("opacity","0").remove();var u=l.enter().append("g");u.append("line").style("opacity","0"),u.append("text").attr("transform",o?"rotate(-90)":"").style("opacity","0"),l=u.merge(l);var d=e.yv.bind(e);l.attr("class",(function(t){return(c.ygridLine+" "+(t.class||"")).trim()})).select("line").transition().duration(t).attr("x1",o?d:0).attr("x2",o?d:n).attr("y1",o?0:d).attr("y2",o?r:d).transition().style("opacity","1"),l.select("text").attr("text-anchor",ye).attr("dx",be).transition().duration(t).attr("dy",-5).attr("x",Te(o,n,r)).attr("y",d).text((function(t){return t.text})).transition().style("opacity","1"),s.gridLines.y=l},redrawGrid:function(t){var e=this,i=e.config.axis_rotated,a=e.state,n=a.width,r=a.height,s=e.$el.gridLines,o=e.xv.bind(e),c=s.x.select("line"),l=s.x.select("text");return c=(t?c.transition():c).attr("x1",i?0:o).attr("x2",i?n:o).attr("y1",i?o:0).attr("y2",i?o:r),l=(t?l.transition():l).attr("x",Te(!i,n,r)).attr("y",o).text((function(t){return t.text})),[(t?c.transition():c).style("opacity","1"),(t?l.transition():l).style("opacity","1")]},initFocusGrid:function(){var t=this.config,e=this.state.clip,i=this.$el,a=t.grid_front,n="."+c[a&&i.grid.main?"gridLines":"chart"]+(a?" + *":""),r=i.grid.main=i.main.insert("g",n).attr("clip-path",e.pathGrid).attr("class",c.grid);t.grid_x_show&&r.append("g").attr("class",c.xgrids),t.grid_y_show&&r.append("g").attr("class",c.ygrids),t.grid_focus_show&&(r.append("g").attr("class",c.xgridFocus).append("line").attr("class",c.xgridFocus),t.grid_focus_y&&!t.tooltip_grouped&&r.append("g").attr("class",c.ygridFocus).append("line").attr("class",c.ygridFocus))},showGridFocus:function(t){var e=this,i=e.config,a=e.state,n=a.width,r=a.height,o=i.axis_rotated,l=t.filter((function(t){return t&&A(e.getBaseValue(t))}));if(i.tooltip_show&&0!==l.length&&!e.hasType("bubble")&&!e.hasArcType()){var u=e.$el.main.selectAll("line."+c.xgridFocus+", line."+c.ygridFocus),d=i.grid_focus_edge&&!i.tooltip_grouped,h=e.xx.bind(e);u.style("visibility","visible").data(l.concat(l)).each((function(t){var i,a=Object(s.select)(this),l={x:h(t),y:e.getYScale(t.id)(t.value)};if(a.classed(c.xgridFocus))i=o?[null,l.x,d?l.y:n,l.x]:[l.x,d?l.y:null,l.x,r];else{var u="y2"===e.axis.getId(t.id);i=o?[l.y,d&&!u?l.x:null,l.y,d&&u?l.x:r]:[d&&u?l.x:null,l.y,d&&!u?l.x:n,l.y]}["x1","y1","x2","y2"].forEach((function(t,e){return a.attr(t,i[e])}))})),we(u,"grid")}},hideGridFocus:function(){this.$el.main.selectAll("line."+c.xgridFocus+", line."+c.ygridFocus).style("visibility","hidden")},updategridFocus:function(){var t=this.state,e=t.width,i=t.height,a=this.config.axis_rotated;this.$el.main.select("line."+c.xgridFocus).attr("x1",a?0:-10).attr("x2",a?e:-10).attr("y1",a?-10:0).attr("y2",a?-10:i)},generateGridData:function(t,e){var i=this.$el.main.select("."+c.axisX).selectAll(".tick").size(),a=[];if("year"===t)for(var n=this.getXDomain(),r=n[0].getFullYear(),s=n[1].getFullYear(),o=r;o<=s;o++)a.push(new Date(o+"-01-01 00:00:00"));else(a=e.ticks(10)).length>i&&(a=a.filter((function(t){return(t+"").indexOf(".")<0})));return a},getGridFilterToRemove:function(t){return t?function(e){var i=!1;return(M(t)?t.concat():[t]).forEach((function(t){("value"in t&&e.value===t.value||"class"in t&&e.class===t.class)&&(i=!0)})),i}:function(){return!0}},removeGridLines:function(t,e){var i=this.config,a=this.getGridFilterToRemove(t),n=e?c.xgridLines:c.ygridLines,r=e?c.xgridLine:c.ygridLine;this.$el.main.select("."+n).selectAll("."+r).filter(a).transition().duration(i.transition_duration).style("opacity","0").remove();var s="grid_"+(e?"x":"y")+"_lines";i[s]=i[s].filter((function(t){return!a(t)}))}},Se={initRegion:function(){var t=this.$el;t.region.main=t.main.append("g").attr("clip-path",this.state.clip.path).attr("class",c.regions)},updateRegion:function(t){var e=this,i=e.config,a=e.$el;a.region.main||e.initRegion(),a.region.main.style("visibility",e.hasArcType()?"hidden":"visible");var n=a.main.select("."+c.regions).selectAll("."+c.region).data(i.regions);n.exit().transition().duration(t).style("opacity","0").remove(),(n=n.enter().append("g").merge(n).attr("class",e.classRegion.bind(e))).append("rect").style("fill-opacity","0"),a.region.list=n},redrawRegion:function(t){var e=this,i=e.$el.region.list.select("rect");return i=(t?i.transition():i).attr("x",e.regionX.bind(e)).attr("y",e.regionY.bind(e)).attr("width",e.regionWidth.bind(e)).attr("height",e.regionHeight.bind(e)),[(t?i.transition():i).style("fill-opacity",(function(t){return A(t.opacity)?t.opacity:"0.1"})).on("end",(function(){Object(s.select)(this.parentNode).selectAll("rect:not([x])").remove()}))]},getRegionXY:function(t,e){var i=this.config,a=this.scale,n=i.axis_rotated,r="x"===t,s="start",o=0;return"y"===e.axis||"y2"===e.axis?(!r&&(s="end"),(r?n:!n)&&s in e&&(o=(0,a[e.axis])(e[s]))):(r?!n:n)&&s in e&&(o=(a.zoom||a.x)(this.isTimeSeries()?st.call(this,e[s]):e[s])),o},regionX:function(t){return this.getRegionXY("x",t)},regionY:function(t){return this.getRegionXY("y",t)},getRegionSize:function(t,e){var i=this,a=i.config,n=i.scale,r=i.state,s=a.axis_rotated,o="width"===t,c=i[o?"regionX":"regionY"](e),l="end",u=r[t];return"y"===e.axis||"y2"===e.axis?(!o&&(l="start"),(o?s:!s)&&l in e&&(u=(0,n[e.axis])(e[l]))):(o?!s:s)&&l in e&&(u=(n.zoom||n.x)(i.isTimeSeries()?st.call(i,e[l]):e[l])),u<c?0:u-c},regionWidth:function(t){return this.getRegionSize("width",t)},regionHeight:function(t){return this.getRegionSize("height",t)},isRegionOnX:function(t){return!t.axis||"x"===t.axis}},Le=i(12),Ce={selectPoint:function(t,e,i){var a=this,n=a.config,r=a.$el.main,s=n.axis_rotated,o=(s?a.circleY:a.circleX).bind(a),l=(s?a.circleX:a.circleY).bind(a),u=a.pointSelectR.bind(a);$(n.data_onselected,a.api,e,t.node()),r.select("."+c.selectedCircles+a.getTargetSelectorSuffix(e.id)).selectAll("."+c.selectedCircle+"-"+i).data([e]).enter().append("circle").attr("class",(function(){return a.generateClass(c.selectedCircle,i)})).attr("cx",o).attr("cy",l).attr("stroke",a.color).attr("r",(function(t){return 1.4*a.pointSelectR(t)})).transition().duration(100).attr("r",u)},unselectPoint:function(t,e,i){var a=this.config,n=this.$el;$(a.data_onunselected,this.api,e,t.node()),n.main.select("."+c.selectedCircles+this.getTargetSelectorSuffix(e.id)).selectAll("."+c.selectedCircle+"-"+i).transition().duration(100).attr("r",0).remove()},togglePoint:function(t,e,i,a){this[(t?"":"un")+"selectPoint"](e,i,a)},selectPath:function(t,e){var i=this,a=i.config;$(a.data_onselected,i.api,e,t.node()),a.interaction_brighten&&t.transition().duration(100).style("fill",(function(){return Object(Le.rgb)(i.color(e)).brighter(.75)}))},unselectPath:function(t,e){var i=this,a=i.config;$(a.data_onunselected,i.api,e,t.node()),a.interaction_brighten&&t.transition().duration(100).style("fill",(function(){return i.color(e)}))},togglePath:function(t,e,i,a){this[(t?"":"un")+"selectPath"](e,i,a)},getToggle:function(t,e){return"path"===t.nodeName?this.togglePath:this.isStepType(e)?function(){}:this.togglePoint},toggleShape:function(t,e,i){var a,n=this,r=n.config,o=n.$el.main,l=Object(s.select)(t),u=l.classed(c.SELECTED),d=n.getToggle(t,e).bind(n);if(r.data_selection_enabled&&r.data_selection_isselectable.bind(n.api)(e)){if(!r.data_selection_multiple){var h="."+c.shapes;r.data_selection_grouped&&(h+=n.getTargetSelectorSuffix(e.id)),o.selectAll(h).selectAll("."+c.shape).each((function(t,e){var i=Object(s.select)(this);i.classed(c.SELECTED)&&(a=i,d(!1,i.classed(c.SELECTED,!1),t,e))}))}a&&a.node()===l.node()||(l.classed(c.SELECTED,!u),d(!u,l,e,i))}}},Oe={initBar:function(){this.$el.main.select("."+c.chart).append("g").attr("class",c.chartBars)},updateTargetsForBar:function(t){var e=this,i=e.config,a=e.$el,n=e.classChartBar.bind(e),r=e.classBars.bind(e),s=e.classFocus.bind(e);a.bar||e.initBar(),e.$el.main.select("."+c.chartBars).selectAll("."+c.chartBar).data(t).attr("class",(function(t){return n(t)+s(t)})).enter().append("g").attr("class",n).style("opacity","0").style("pointer-events","none").append("g").attr("class",r).style("cursor",(function(t){return i.data_selection_isselectable.bind(e.api)(t)?"pointer":null}))},updateBar:function(t){var e=this,i=e.$el,a=e.barData.bind(e),n=e.classBar.bind(e),r=e.initialOpacity.bind(e);i.bar=i.main.selectAll("."+c.bars).selectAll("."+c.bar).data(a),i.bar.exit().transition().duration(t).style("opacity","0").remove(),i.bar=i.bar.enter().append("path").attr("class",n).style("fill",e.color).merge(i.bar).style("opacity",r)},redrawBar:function(t,e){var i=this.$el.bar;return[(e?i.transition(H()):i).attr("d",t).style("fill",this.color).style("opacity","1")]},getBarW:function(t,e){var i,a=this,n=a.config,r=a.scale,s=a.getMaxDataCount(),o=n.data_groups.length,c=!r.zoom&&!a||a.isCategorized()?t.tickInterval(s):a.xx(r.subX.domain()[1])/s,l=function(t){var i=t?n.bar_width[t]:n.bar_width,a=t?i.ratio:n.bar_width_ratio,r=t?i.max:n.bar_width_max,s=C(i)?i:e?c*a/e:0;return r&&s>r?r:s};return i=l(),!o&&z(n.bar_width)&&(i={width:i,total:[]},a.filterTargetsToShow(a.data.targets).forEach((function(t){n.bar_width[t.id]&&(i[t.id]=l(t.id),i.total.push(i[t.id]||i.width))}))),i},getBars:function(t,e){var i=this.$el.main,a=A(t)?"-"+t:"";return(e?i.selectAll("."+c.bars+this.getTargetSelectorSuffix(e)):i).selectAll("."+c.bar+a)},expandBars:function(t,e,i){i&&this.unexpandBars(),this.getBars(t,e).classed(c.EXPANDED,!0)},unexpandBars:function(t){this.getBars(t).classed(c.EXPANDED,!1)},generateDrawBar:function(t,e){var i=this.config,a=this.generateGetBarPoints(t,e),n=i.axis_rotated,r=i.data_groups.length,s=i.bar_radius,o=i.bar_radius_ratio,c=C(s)&&s>0?function(){return s}:C(o)?function(t){return t*o}:null;return function(t,e){var i=a(t,e),s=+n,o=+!s,l=t.value<0,u=["",""],d=0;if(c&&!r){var h=n?o:s,g=i[2][h]-i[0][h],f="a"+(d=c(g))+","+d+" "+(l?"1 0 0":"0 0 1")+" ";u[+!n]=""+f+d+","+d,u[+n]=""+f+[-d,d][n?"sort":"reverse"](),l&&u.reverse()}var p=n?"H"+(i[1][s]-d)+" "+u[0]+"V"+(i[2][o]-d)+" "+u[1]+"H"+i[3][s]:"V"+(i[1][o]+(l?-d:d))+" "+u[0]+"H"+(i[2][s]-d)+" "+u[1]+"V"+i[3][o];return"M"+i[0][s]+","+i[0][o]+p+"z"}},generateGetBarPoints:function(t,e){var i=this,a=i.config,n=e?i.axis.subX:i.axis.x,r=i.getIndicesMax(t)+1,s=i.getBarW(n,r),o=i.getShapeX(s,t,!!e),c=i.getShapeY(!!e),l=i.getShapeOffset(i.isBarType,t,!!e),u=e?i.getSubYScale:i.getYScale;return function(t,e){var n=u.call(i,t.id)(0),r=l(t,e)||n,d=C(s)?s:s[t.id]||s.width,h=o(t),g=c(t);return a.axis_rotated&&(t.value>0&&g<n||t.value<0&&n<g)&&(g=n),[[h,r],[h,g-=n-r],[h+d,g],[h+d,r]]}},isWithinBar:function(t){var e=Object(s.mouse)(t),i=N(t),a=i[0],n=i[1],r=Math.min(a.x,n.x),o=Math.min(a.y,n.y),c=this.config.bar_sensitivity,l=t.getBBox(),u=l.width,d=l.height;return r-c<e[0]&&e[0]<r+u+c&&o-c<e[1]&&e[1]<o+d+c}},ke={initBubble:function(){var t=this.config;this.hasType("bubble")&&(t.point_show=!0,t.point_type="circle",t.point_sensitivity=25)},getBaseLength:function(){var t=this.$el.axis,e=this.cache.get("$baseLength");return e||this.cache.add("$baseLength",e=it("min",[t.x.select("path").node().getTotalLength(),t.y.select("path").node().getTotalLength()])),e},getBubbleR:function(t){var e=this,i=e.config.bubble_maxR;S(i)?i=i.bind(e.api)(t):!C(i)&&(i=e.getBaseLength()/(2*e.getMaxDataCount())+12);var a=it("max",e.getMinMaxData().max.map((function(t){return e.isBubbleZType(t)?e.getBubbleZData(t.value,"y"):P(t.value)?t.value.mid:t.value}))),n=i*i*Math.PI,r=(e.isBubbleZType(t)?e.getBubbleZData(t.value,"z"):t.value)*(n/a);return Math.sqrt(r/Math.PI)},getBubbleZData:function(t,e){return P(t)?t[e]:t["y"===e?0:1]},isBubbleZType:function(t){return this.isBubbleType(t)&&(P(t.value)&&("z"in t.value||"y"in t.value)||M(t.value)&&2===t.value.length)}},De=i(13),Re=function(){return H()},Xe={api:[Qt,{category:function(t,e){var i=this.internal,a=i.config;return arguments.length>1&&(a.axis_x_categories[t]=e,i.redraw()),a.axis_x_categories[t]},categories:function(t){var e=this.internal,i=e.config;return arguments.length?(i.axis_x_categories=t,e.redraw(),i.axis_x_categories):i.axis_x_categories}},te,ie,ne,re,oe,ce,le,he],internal:[{categoryName:function(t){var e=this.config.axis_x_categories;return t<e.length?e[t]:t}},ge,pe,ve,me,_e,Ae,Se,Ce,xe,Oe,ke,{initLine:function(){var t=this.$el;t.line=t.main.select("."+c.chart).append("g").attr("class",c.chartLines)},updateTargetsForLine:function(t){var e=this,i=e.$el,a=e.classChartLine.bind(e),n=e.classLines.bind(e),r=e.classFocus.bind(e);i.line||e.initLine();var s=i.main.select("."+c.chartLines).selectAll("."+c.chartLine).data(t).attr("class",(function(t){return a(t)+r(t)})).enter().append("g").attr("class",a).style("opacity","0").style("pointer-events","none");s.append("g").attr("class",n),e.hasTypeOf("Area")&&s.append("g").attr("class",e.classAreas.bind(e))},updateLine:function(t){var e=this,i=e.format.extraLineClasses,a=e.$el;a.line=a.main.selectAll("."+c.lines).selectAll("."+c.line).data(e.lineData.bind(e)),a.line.exit().transition().duration(t).style("opacity","0").remove(),a.line=a.line.enter().append("path").attr("class",(function(t){return e.classLine.bind(e)(t)+" "+(i(t)||"")})).style("stroke",e.color).merge(a.line).style("opacity",e.initialOpacity.bind(e)).style("shape-rendering",(function(t){return e.isStepType(t)?"crispEdges":""})).attr("transform",null)},redrawLine:function(t,e){var i=this.$el.line;return[(e?i.transition(H()):i).attr("d",t).style("stroke",this.color).style("opacity","1")]},getCurve:function(t){var e=this;return e.config.axis_rotated&&e.isStepType(t)?function(i){var a=e.getInterpolate(t)(i);return a.orgPoint=a.point,a.pointRotated=function(t,e){1===this._point&&(this._point=2);var i=this._y*(1-this._t)+e*this._t;this._context.lineTo(this._x,i),this._context.lineTo(t,i),this._x=t,this._y=e},a.point=function(t,e){0===this._point?this.orgPoint(t,e):this.pointRotated(t,e)},a}:e.getInterpolate(t)},generateDrawLine:function(t,e){var i=this,a=i.config,n=i.scale,r=a.line_connectNull,s=a.axis_rotated,o=i.generateGetLinePoints(t,e),c=e?i.getSubYScale:i.getYScale,l=function(t){return(e?i.subxx:i.xx).call(i,t)},u=function(t,e){return i.isGrouped(t.id)?o(t,e)[0][1]:c.call(i,t.id)(i.getBaseValue(t))},d=Object(De.line)();d=s?d.x(u).y(l):d.x(l).y(u),r||(d=d.defined((function(t){return null!==i.getBaseValue(t)})));var h=e?n.subX:n.x;return function(t){var e,n=c.call(i,t.id),o=r?i.filterRemoveNull(t.values):t.values,l=0,u=0;if(i.isLineType(t)){var g=a.data_regions[t.id];g?e=i.lineWithRegions(o,h,n,g):(i.isStepType(t)&&(o=i.convertValuesToStep(o)),e=d.curve(i.getCurve(t))(o))}else o[0]&&(l=h(o[0].x),u=n(o[0].value)),e=s?"M "+u+" "+l:"M "+l+" "+u;return e||"M 0 0"}},generateGetLinePoints:function(t,e){var i=this,a=i.config,n=!!e,r=i.getShapeX(0,t,n),s=i.getShapeY(n),o=i.getShapeOffset(i.isLineType,t,n),c=n?i.getSubYScale:i.getYScale;return function(t,e){var n=c.call(i,t.id)(0),l=o(t,e)||n,u=r(t),d=s(t);a.axis_rotated&&(t.value>0&&d<n||t.value<0&&n<d)&&(d=n);var h=[u,d-(n-l)];return[h,h,h,h]}},lineWithRegions:function(t,e,i,a){var n,r,s,o,c=this,l=c.config.axis_rotated,u=c.isTimeSeries(),d=c.isCategorized()?.5:0,h=[],g=function(t,e){for(var i,a=0;i=e[a];a++)if(i.start<t&&t<=i.end)return i.style;return!1};if(k(a))for(var f,p=function(t,e){return O(t)?e:u?st.call(c,t):t},x=0;f=a[x];x++){var v=p(f.start,t[0].x),m=p(f.end,t[t.length-1].x),_=f.style||{dasharray:"2 2"};h[x]={start:v,end:m,style:_}}for(var y,b=l?function(t){return i(t.value)}:function(t){return e(t.x)},T=l?function(t){return e(t.x)}:function(t){return i(t.value)},w=function(t){return"M"+t[0][0]+","+t[0][1]+"L"+t[1][0]+","+t[1][1]},S=u?function(t,a,n,o){var c=t.x.getTime(),u=a.x-t.x,d=new Date(c+u*n),h=new Date(c+u*(n+o)),g=l?[[i(r(n)),e(d)],[i(r(n+s)),e(h)]]:[[e(d),i(r(n))],[e(h),i(r(n+s))]];return w(g)}:function(t,a,s,o){var c=l?[[i(r(s),!0),e(n(s))],[i(r(s+o),!0),e(n(s+o))]]:[[e(n(s),!0),i(r(s))],[e(n(s+o),!0),i(r(s+o))]];return w(c)},L="",C=0;y=t[C];C++){var D=t[C-1],R=D&&A(D.value);_=g(y.x,h);if(A(y.value))if(!O(h)&&_&&R){if(R){try{_=_.dasharray.split(" ")}catch(t){_="2 2".split(" ")}n=c.getScale(D.x+d,y.x+d,u),r=c.getScale(D.value,y.value);var X=e(y.x)-e(D.x),E=i(y.value)-i(D.value),z=Math.sqrt(Math.pow(X,2)+Math.pow(E,2));o=(s=_[0]/z)*_[1];for(var F=s;F<=1;F+=o)L+=S(D,y,F,s),F+o>=1&&(L+=S(D,y,1,0))}}else L+=(C&&R?"L":"M")+b(y)+","+T(y)}return L},updateAreaGradient:function(){var t=this,e=t.config,i=t.state.datetimeId,a=t.$el.defs;t.data.targets.forEach((function(n){var r=i+"-areaGradient"+t.getTargetSelectorSuffix(n.id);if(t.isAreaType(n)&&a.select("#"+r).empty()){var s=t.color(n),o=e.area_linearGradient,c=o.x,l=void 0===c?[0,0]:c,u=o.y,d=void 0===u?[0,1]:u,h=o.stops,g=void 0===h?[[0,s,1],[1,s,0]]:h,f=a.append("linearGradient").attr("id",""+r).attr("x1",l[0]).attr("x2",l[1]).attr("y1",d[0]).attr("y2",d[1]);g.forEach((function(e){var i=S(e[1])?e[1].bind(t.api)(n.id):e[1];f.append("stop").attr("offset",e[0]).attr("stop-color",i||s).attr("stop-opacity",e[2])}))}}))},updateAreaColor:function(t){return this.config.area_linearGradient?"url(#"+this.state.datetimeId+"-areaGradient"+this.getTargetSelectorSuffix(t.id)+")":this.color(t)},updateArea:function(t){var e=this,i=e.config,a=e.state,n=e.$el;i.area_linearGradient&&e.updateAreaGradient(),n.area=n.main.selectAll("."+c.areas).selectAll("."+c.area).data(e.lineData.bind(e)),n.area.exit().transition().duration(t).style("opacity","0").remove(),n.area=n.area.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.updateAreaColor.bind(e)).style("opacity",(function(){return a.orgAreaOpacity=Object(s.select)(this).style("opacity"),"0"})).merge(n.area),n.area.style("opacity",a.orgAreaOpacity)},redrawArea:function(t,e){var i=this,a=i.state.orgAreaOpacity;return[(e?i.$el.area.transition(H()):i.$el.area).attr("d",t).style("fill",i.updateAreaColor.bind(i)).style("opacity",(function(t){return(i.isAreaRangeType(t)?a/1.75:a)+""}))]},generateDrawArea:function(t,e){var i=this,a=i.config,n=a.line_connectNull,r=a.axis_rotated,s=i.generateGetAreaPoints(t,e),o=e?i.getSubYScale:i.getYScale,c=function(t){return(e?i.subxx:i.xx).call(i,t)},l=function(t,e){return i.isGrouped(t.id)?s(t,e)[0][1]:o.call(i,t.id)(i.isAreaRangeType(t)?i.getAreaRangeData(t,"high"):0)},u=function(t,e){return i.isGrouped(t.id)?s(t,e)[1][1]:o.call(i,t.id)(i.isAreaRangeType(t)?i.getAreaRangeData(t,"low"):t.value)};return function(t){var e,s=n?i.filterRemoveNull(t.values):t.values,o=0,d=0;if(i.isAreaType(t)){var h=Object(De.area)();h=r?h.y(c).x0(l).x1(u):h.x(c).y0(a.area_above?0:l).y1(u),n||(h=h.defined((function(t){return null!==i.getBaseValue(t)}))),i.isStepType(t)&&(s=i.convertValuesToStep(s)),e=h.curve(i.getCurve(t))(s)}else s[0]&&(o=i.scale.x(s[0].x),d=i.getYScale(t.id)(s[0].value)),e=r?"M "+d+" "+o:"M "+o+" "+d;return e||"M 0 0"}},generateGetAreaPoints:function(t,e){var i=this,a=i.config,n=i.getShapeX(0,t,!!e),r=i.getShapeY(!!e),s=i.getShapeOffset(i.isAreaType,t,!!e),o=e?i.getSubYScale:i.getYScale;return function(t,e){var c=o.call(i,t.id)(0),l=s(t,e)||c,u=n(t),d=r(t);return a.axis_rotated&&(t.value>0&&d<c||t.value<0&&c<d)&&(d=c),[[u,l],[u,d-(c-l)],[u,d-(c-l)],[u,l]]}},isWithinStep:function(t,e){return Math.abs(e-Object(s.mouse)(t)[1])<30},shouldDrawPointsForLine:function(t){var e=this.config.line_point;return!0===e||M(e)&&-1!==e.indexOf(t.id)}},{hasValidPointType:function(t){return/^(circle|rect(angle)?|polygon|ellipse|use)$/i.test(t||this.config.point_type)},hasValidPointDrawMethods:function(t){var e=t||this.config.point_type;return z(e)&&S(e.create)&&S(e.update)},initialOpacityForCircle:function(t){var e=this.state.withoutFadeIn;return null!==this.getBaseValue(t)&&e[t.id]?this.opacityForCircle(t):"0"},opacityForCircle:function(t){var e=this.config.point_show?"1":"0";return A(this.getBaseValue(t))?this.isBubbleType(t)||this.isScatterType(t)?"0.5":e:"0"},initCircle:function(){var t=this.config,e=this.$el.main;this.point=this.generatePoint(),t.point_show&&e.select("."+c.chart).append("g").attr("class",c.chartCircles)},updateTargetForCircle:function(t){var e=this,i=e.config,a=e.data,n=e.$el,r=t||a.targets,s=e.classCircles.bind(e);!n.circle&&i.point_show&&e.initCircle();var o=n.main.select("."+c.chartCircles).style("pointer-events","none").selectAll("."+c.circles).data(r).attr("class",s).enter();i.data_selection_enabled&&o.append("g").attr("class",(function(t){return e.generateClass(c.selectedCircles,t.id)})),o.append("g").attr("class",s).style("cursor",(function(t){return i.data_selection_isselectable.bind(e.api)(t)?"pointer":null})),r.forEach((function(t){n.main.selectAll("."+c.selectedCircles+e.getTargetSelectorSuffix(t.id)).selectAll(""+c.selectedCircle).each((function(e){e.value=t.values[e.index].value}))}))},updateCircle:function(){var t=this,e=t.config,i=t.$el;if(e.point_show){var a=i.main.selectAll("."+c.circles).selectAll("."+c.circle).data((function(e){return!t.isBarType(e)&&(!t.isLineType(e)||t.shouldDrawPointsForLine(e))&&t.labelishData(e)}));a.exit().remove();var n=t.point("create",this,t.pointR.bind(t),t.color);i.circle=a.enter().append(n).merge(a).style("stroke",t.color).style("opacity",t.initialOpacityForCircle.bind(t))}},redrawCircle:function(t,e,i,a){var n=this,r=n.state.rendered,s=n.$el,o=s.circle,l=s.main.selectAll("."+c.selectedCircle);if(!n.config.point_show)return[];var u=n.point("update",n,t,e,n.color,i,a,l),d=n.isCirclePoint()?"c":"",h=H(),g=n.opacityForCircle.bind(n),f=[];return o.each((function(t){var e=u.bind(this)(t);e=(i||!r?e.transition(h):e).style("opacity",g),f.push(e)})),[f,l.attr(d+"x",t).attr(d+"y",e)]},circleX:function(t){var e=this.scale,i=e.x,a=e.zoom,n=A(t.x);return this.config.zoom_enabled&&a?n?a(t.x):null:n?i(t.x):null},updateCircleY:function(){var t=this,e=t.generateGetLinePoints(t.getShapeIndices(t.isLineType),!1);t.circleY=function(i,a){var n=i.id;return t.isGrouped(n)?e(i,a)[0][1]:t.getYScale(n)(t.getBaseValue(i))}},getCircles:function(t,e){var i=A(t)?"-"+t:"";return(e?this.$el.main.selectAll("."+c.circles+this.getTargetSelectorSuffix(e)):this.$el.main).selectAll("."+c.circle+i)},expandCircles:function(t,e,i){var a=this,n=a.pointExpandedR.bind(a);i&&a.unexpandCircles();var r=a.getCircles(t,e).classed(c.EXPANDED,!0),o=n(r)/a.config.point_r,l=1-o;a.isCirclePoint()?r.attr("r",n):r.each((function(){var t=Object(s.select)(this);if("circle"===this.tagName)t.attr("r",n);else{var e=this.getBBox(),i=e.width,a=e.height,r=l*(+t.attr("x")+i/2),c=l*(+t.attr("y")+a/2);t.attr("transform","translate("+r+" "+c+") scale("+o+")")}}))},unexpandCircles:function(t){var e=this,i=e.pointR.bind(e),a=e.getCircles(t).filter((function(){return Object(s.select)(this).classed(c.EXPANDED)})).classed(c.EXPANDED,!1);a.attr("r",i),e.isCirclePoint()||a.attr("transform","scale("+i(a)/e.config.point_r+")")},pointR:function(t){var e=this,i=e.config.point_r,a=i;return e.isStepType(t)?a=0:e.isBubbleType(t)?a=e.getBubbleR(t):S(i)&&(a=i.bind(e.api)(t)),a},pointExpandedR:function(t){var e=this.config,i=this.isBubbleType(t)?1.15:1.75;return e.point_focus_expand_enabled?e.point_focus_expand_r||this.pointR(t)*i:this.pointR(t)},pointSelectR:function(t){var e=this.config.point_select_r;return S(e)?e(t):e||4*this.pointR(t)},isWithinCircle:function(t,e){var i=Object(s.mouse)(t),a=Object(s.select)(t),n=this.isCirclePoint()?"c":"",r=+a.attr(n+"x"),o=+a.attr(n+"y");if(!r&&!o&&1===t.nodeType){var c=G(t);r=c.x,o=c.y}return Math.sqrt(Math.pow(r-i[0],2)+Math.pow(o-i[1],2))<(e||this.config.point_sensitivity)},insertPointInfoDefs:function(t,e){var i=function(t,e){for(var i,a=t.attributes,n=0;i=a[n];n++)i=i.name,e.setAttribute(i,t.getAttribute(i))},a=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement,n=w.createElementNS(s.namespaces.svg,a.nodeName.toLowerCase());if(n.id=e,n.style.fill="inherit",n.style.stroke="inherit",i(a,n),a.childNodes&&a.childNodes.length){var r=Object(s.select)(n);"innerHTML"in n?r.html(a.innerHTML):q(a.childNodes).forEach((function(t){i(t,r.append(t.tagName).node())}))}this.$el.defs.node().appendChild(n)},pointFromDefs:function(t){return this.$el.defs.select("#"+t)},updatePointClass:function(t){var e=this.$el.circle,i=!1;return(P(t)||e)&&(i=!0===t?e.attr("class",this.classCircle.bind(this)):this.classCircle(t)),i},generatePoint:function(){var t=this,e=t.config,i=t.state.datetimeId,a=[],n=I(e.point_pattern)?e.point_pattern:[e.point_type];return function(e,r){for(var o=arguments.length,c=Array(o>2?o-2:0),l=2;l<o;l++)c[l-2]=arguments[l];return function(o){var l=o.id||o.data&&o.data.id||o,u=Object(s.select)(this);a.indexOf(l)<0&&a.push(l);var d=n[a.indexOf(l)%n.length];if(t.hasValidPointType(d))d=t[d];else if(!t.hasValidPointDrawMethods(d)){var h=i+"-point-"+l;if(t.pointFromDefs(h).size()<1&&t.insertPointInfoDefs(d,h),"create"===e)return t.custom.create.bind(r).apply(void 0,[u,h].concat(c));if("update"===e)return t.custom.update.bind(r).apply(void 0,[u].concat(c))}return d[e].bind(r).apply(void 0,[u].concat(c))}}},custom:{create:function(t,e,i,a){return t.append("use").attr("xlink:href","#"+e).attr("class",this.updatePointClass.bind(this)).style("fill",a).node()},update:function(t,e,i,a,n,r,s){var o=t.node().getBBox(),c=o.width,l=o.height,u=function(t){return e(t)-c/2},d=t;if(n){var h=Re();r&&d.attr("x",u),d=d.transition(h),s.transition(Re())}return d.attr("x",u).attr("y",(function(t){return i(t)-l/2})).style("fill",a)}},circle:{create:function(t,e,i){return t.append("circle").attr("class",this.updatePointClass.bind(this)).attr("r",e).style("fill",i).node()},update:function(t,e,i,a,n,r,s){var o=t;if(this.hasType("bubble")&&o.attr("r",this.pointR.bind(this)),n){var c=Re();r&&o.attr("cx",e),o.attr("cx")&&(o=o.transition(c)),s.transition(Re())}return o.attr("cx",e).attr("cy",i).style("fill",a)}},rectangle:{create:function(t,e,i){var a=function(t){return 2*e(t)};return t.append("rect").attr("class",this.updatePointClass.bind(this)).attr("width",a).attr("height",a).style("fill",i).node()},update:function(t,e,i,a,n,r,s){var o=this.config.point_r,c=function(t){return e(t)-o},l=t;if(n){var u=Re();r&&l.attr("x",c),l=l.transition(u),s.transition(Re())}return l.attr("x",c).attr("y",(function(t){return i(t)-o})).style("fill",a)}}},{getDrawShape:function(){var t=this,e=t.config.axis_rotated,i=t.state.hasRadar,a={type:{},indices:{},pos:{}};if(t.hasTypeOf("Line")||t.hasType("bubble")||t.hasType("scatter")){var n=t.getShapeIndices(t.isLineType);if(a.indices.line=n,a.type.line=t.generateDrawLine?t.generateDrawLine(n,!1):void 0,t.hasTypeOf("Area")){var r=t.getShapeIndices(t.isAreaType);a.indices.area=r,a.type.area=t.generateDrawArea?t.generateDrawArea(r,!1):void 0}}if(t.hasType("bar")){var s=t.getShapeIndices(t.isBarType);a.indices.bar=s,a.type.bar=t.generateDrawBar?t.generateDrawBar(s):void 0}return(!t.hasArcType()||i)&&(a.pos={xForText:t.generateXYForText(a.indices,!0),yForText:t.generateXYForText(a.indices,!1),cx:(i?t.radarCircleX:e?t.circleY:t.circleX).bind(t),cy:(i?t.radarCircleY:e?t.circleX:t.circleY).bind(t)}),a},getShapeIndices:function(t){var e=this.config,i=e.data_xs,a=I(i),n={},r=a?{}:0;return a&&J(Object.keys(i).map((function(t){return i[t]}))).forEach((function(t){r[t]=0,n[t]={}})),this.filterTargetsToShow(this.data.targets.filter(t,this)).forEach((function(t){for(var a,s=(t.id in i?i[t.id]:""),o=s?n[s]:n,c=0;a=e.data_groups[c];c++)if(!(a.indexOf(t.id)<0))for(var l,u=0;l=a[u];u++)if(l in o){o[t.id]=o[l];break}O(o[t.id])&&(o[t.id]=s?r[s]++:r++,o.__max__=(s?r[s]:r)-1)})),n},getIndices:function(t,e){var i=this.config.data_xs;return I(i)?t[i[e]]:t},getIndicesMax:function(t){return I(this.config.data_xs)?Object.keys(t).map((function(e){return t[e].__max__||0})).reduce((function(t,e){return t+e})):t.__max__},getShapeX:function(t,e,i){var a=this,n=a.config,r=a.scale,s=i?r.subX:r.zoom||r.x,o=n.bar_padding,c=function(t,e){return t+e},l=z(t)&&t.total.length?t.total.reduce(c)/2:0;return function(i){var n=a.getIndices(e,i.id),r=i.id in n?n[i.id]:0,u=(n.__max__||0)+1,d=0;if(I(i.x)){var h=s(i.x);d=l?h-(t[i.id]||t.width)+t.total.slice(0,r+1).reduce(c)-l:h-(C(t)?t:t.width)*(u/2-r)}return t&&d&&u>1&&o&&(r&&(d+=o*r),u>2?d-=(u-1)*o/2:2===u&&(d-=o/2)),d}},getShapeY:function(t){var e=this,i=e.isStackNormalized();return function(a){var n=i?e.getRatio("index",a,!0):e.isBubbleZType(a)?e.getBubbleZData(a.value,"y"):a.value;return(t?e.getSubYScale(a.id):e.getYScale(a.id))(n)}},getShapeOffsetData:function(t){var e=this,i=e.orderTargets(e.filterTargetsToShow(e.data.targets.filter(t,e))),a=i.map((function(t){var i=t.values;e.isStepType(t)&&(i=e.convertValuesToStep(i));var a=i.reduce((function(t,e){return t[+e.x]=e,t}),{}),n=i.map(e.isStackNormalized()?function(t){return e.getRatio("index",t,!0)}:function(t){return t.value});return{id:t.id,rowValues:i,rowValueMapByXValue:a,values:n}}));return{indexMapByTargetId:i.reduce((function(t,e,i){return t[e.id]=i,t}),{}),shapeOffsetTargets:a}},getShapeOffset:function(t,e,i){var a=this,n=a.getShapeOffsetData(t),r=n.shapeOffsetTargets,s=n.indexMapByTargetId;return function(t,n){var o=a.getIndices(e,t.id),c=i?a.getSubYScale(t.id):a.getYScale(t.id),l=c(0),u=+t.x,d=l;return r.forEach((function(e){var i=e.rowValues,a=e.values;if(e.id!==t.id&&o[e.id]===o[t.id]&&s[e.id]<s[t.id]){var r=i[n];r&&+r.x===u||(r=e.rowValueMapByXValue[u]),r&&r.value*t.value>=0&&(d+=c(a[r.index])-l)}})),d}},isWithinShape:function(t,e){var i,a=this,n=Object(s.select)(t);return a.isTargetToShow(e.id)?a.hasValidPointType(t.nodeName)?i=a.isStepType(e)?a.isWithinStep(t,a.getYScale(e.id)(e.value)):a.isWithinCircle(t,a.isBubbleType(e)?1.5*a.pointSelectR(e):0):"path"===t.nodeName&&(i=!n.classed(c.bar)||a.isWithinBar(t)):i=!1,i},getInterpolate:function(t){var e=this.getInterpolateType(t);return{basis:De.curveBasis,"basis-closed":De.curveBasisClosed,"basis-open":De.curveBasisOpen,bundle:De.curveBundle,cardinal:De.curveCardinal,"cardinal-closed":De.curveCardinalClosed,"cardinal-open":De.curveCardinalOpen,"catmull-rom":De.curveCatmullRom,"catmull-rom-closed":De.curveCatmullRomClosed,"catmull-rom-open":De.curveCatmullRomOpen,"monotone-x":De.curveMonotoneX,"monotone-y":De.curveMonotoneY,natural:De.curveNatural,"linear-closed":De.curveLinearClosed,linear:De.curveLinear,step:De.curveStep,"step-after":De.curveStepAfter,"step-before":De.curveStepBefore}[e]},getInterpolateType:function(t){var e=this.config,i=e.spline_interpolation_type,a=this.isInterpolationType(i)?i:"cardinal";return this.isSplineType(t)?a:this.isStepType(t)?e.line_step_type:"linear"}}]},Ee=i(14);var ze={internal:[{initPie:function(){var t=this,e=t.config,i=e.data_type,a=e.pie_padding,n=e[i+"_startingAngle"]||0,r=(t.hasType("pie")&&a?.01*a:e[i+"_padAngle"])||0,s=t.isOrderAsc()||t.isOrderDesc()?function(e,i){return t.isOrderAsc()?e-i:i-e}:null;t.pie=Object(De.pie)().startAngle(n).endAngle(n+2*Math.PI).padAngle(r).sortValues(s).value((function(t){return t.values.reduce((function(t,e){return t+e.value}),0)}))},updateRadius:function(){var t=this,e=t.config,i=t.state,a=e.pie_innerRadius,n=e.pie_padding,r=e.gauge_width||e.donut_width,s=t.filterTargetsToShow(t.data.targets).length*e.gauge_arcs_minWidth;i.radiusExpanded=Math.min(i.arcWidth,i.arcHeight)/2*(t.hasMultiArcGauge()?.85:1),i.radius=.95*i.radiusExpanded,i.innerRadiusRatio=r?(i.radius-r)/i.radius:.6,i.gaugeArcWidth=r||(s<=i.radius-i.innerRadius?i.radius-i.innerRadius:s<=i.radius?s:i.radius);var o=a||(n?n*(i.innerRadiusRatio+.1):0);i.innerRadius=t.hasType("donut")||t.hasType("gauge")?i.radius*i.innerRadiusRatio:o},getInnerRadius:function(t){var e=this.state.innerRadius;return!C(e)&&t&&(e=e[t.data.id]||0),e},updateArc:function(){this.svgArc=this.getSvgArc(),this.svgArcExpanded=this.getSvgArcExpanded()},updateAngle:function(t){var e=this,i=e.config,a=e.pie,n=t,r=!1;if(!i)return null;var s=Math.PI*(i.gauge_fullCircle?2:1),o=i.gauge_startingAngle;if(n.data&&e.isGaugeType(n.data)){var c=e.getTotalDataSum();c>i.gauge_max&&(i.gauge_max=c);var l=s*(c/(i.gauge_max-i.gauge_min));a=a.startAngle(o).endAngle(l+o)}if(a(e.filterTargetsToShow()).forEach((function(t,e){r||t.data.id!==n.data.id||(r=!0,(n=t).index=e)})),isNaN(n.startAngle)&&(n.startAngle=0),isNaN(n.endAngle)&&(n.endAngle=n.startAngle),n.data&&e.hasMultiArcGauge()){var u=e.getMinMaxData().max[0].value;u>i.gauge_max&&(i.gauge_max=u);var d=i.gauge_min,h=i.gauge_max,g=n.value<d?0:n.value<h?n.value-d:h-d;n.startAngle=o,n.endAngle=o+s/(h-d)*g}return r?n:null},getSvgArc:function(){var t=this,e=t.state,i=t.getInnerRadius(),a=e.gaugeArcWidth/t.filterTargetsToShow(t.data.targets).length,n=t.hasMultiArcGauge(),r=Object(De.arc)().outerRadius((function(t){return n?e.radius-a*t.index:e.radius})).innerRadius((function(t){return n?e.radius-a*(t.index+1):C(i)?i:0})),s=function(e,a){var n="M 0 0";if(e.value||e.data){C(i)||(r=r.innerRadius(t.getInnerRadius(e)));var s=!a&&t.updateAngle(e);a?n=r(e):s&&(n=r(s))}return n};return s.centroid=r.centroid,s},getSvgArcExpanded:function(t){var e=this,i=e.state,a=t||1,n=i.gaugeArcWidth/e.filterTargetsToShow(e.data.targets).length,r=e.hasMultiArcGauge(),s=Math.min(i.radiusExpanded*a-i.radius,.8*n-100*(1-a)),o=Object(De.arc)().outerRadius((function(t){return r?i.radius-n*t.index+s:i.radiusExpanded*a})).innerRadius((function(t){return r?i.radius-n*(t.index+1):i.innerRadius}));return function(t){var i=e.updateAngle(t);return i?(r?o:o.innerRadius(e.getInnerRadius(t)))(i):"M 0 0"}},getArc:function(t,e,i){return i||this.isArcType(t.data)?this.svgArc(t,e):"M 0 0"},transformForArcLabel:function(t){var e=this,i=e.config,a=e.state,n=a.radius,r=a.radiusExpanded,s=e.updateAngle(t),o="";if(s)if(e.hasMultiArcGauge()){var c=Math.sin(s.endAngle-Math.PI/2);o="translate("+(u=Math.cos(s.endAngle-Math.PI/2)*(r+25))+","+(d=c*(r+15-Math.abs(10*c))+3)+")"}else if(!e.hasType("gauge")||e.data.targets.length>1){var l=this.svgArc.centroid(s),u=isNaN(l[0])?0:l[0],d=isNaN(l[1])?0:l[1],h=Math.sqrt(u*u+d*d),g=e.hasType("donut")&&i.donut_label_ratio||e.hasType("pie")&&i.pie_label_ratio;o="translate("+u*(g=g?S(g)?g.bind(e.api)(t,n,h):g:n&&(h?(36/n>.375?1.175-36/n:.8)*n/h:0))+","+d*g+")"}return o},convertToArcData:function(t){return this.addName({id:t.data.id,value:t.value,ratio:this.getRatio("arc",t),index:t.index})},textForArcLabel:function(t){var e=this;e.shouldShowArcLabel()&&t.each((function(t){var i=Object(s.select)(this),a=e.updateAngle(t),n=a?a.value:t.value,r=e.getRatio("arc",a),o=t.data.id,c=e.hasType("gauge");(c||e.meetsArcLabelThreshold(r))&&j(i,(e.getArcLabelFormat()||e.defaultArcValueFormat)(n,r,o).toString(),[-1,1],c)}))},textForGaugeMinMax:function(t,e){var i=this.config.gauge_label_extents;return S(i)?i.bind(this.api)(t,e):t},expandArc:function(t){var e=this,i=e.state.transiting,a=e.$el;if(i)var n=setInterval((function(){i||(clearInterval(n),a.legend.selectAll("."+c.legendItemFocused).size()>0&&e.expandArc(t))}),10);else{var r=e.mapToTargetIds(t);a.svg.selectAll(e.selectorTargets(r,"."+c.chartArc)).each((function(t){if(e.shouldExpand(t.data.id)){var i=e.getExpandConfig(t.data.id,"duration"),a=e.getSvgArcExpanded(e.getExpandConfig(t.data.id,"rate"));Object(s.select)(this).selectAll("path").transition().duration(i).attr("d",e.svgArcExpanded).transition().duration(2*i).attr("d",a)}}))}},unexpandArc:function(t){var e=this,i=e.state.transiting,a=e.$el.svg;if(!i){var n=e.mapToTargetIds(t);a.selectAll(e.selectorTargets(n,"."+c.chartArc)).selectAll("path").transition().duration((function(t){return e.getExpandConfig(t.data.id,"duration")})).attr("d",e.svgArc),a.selectAll(""+c.arc).style("opacity","1")}},getExpandConfig:function(t,e){var i,a=this.config;return this.isDonutType(t)?i="donut":this.isGaugeType(t)?i="gauge":this.isPieType(t)&&(i="pie"),i?a[i+"_expand_"+e]:{duration:50,rate:.98}[e]},shouldExpand:function(t){var e=this.config;return this.isDonutType(t)&&e.donut_expand||this.isGaugeType(t)&&e.gauge_expand||this.isPieType(t)&&e.pie_expand},shouldShowArcLabel:function(){var t=this,e=t.config;return["pie","donut","gauge"].some((function(i){return t.hasType(i)&&e[i+"_label_show"]}))},meetsArcLabelThreshold:function(t){var e=this.config;return t>=(this.hasType("donut")?e.donut_label_threshold:e.pie_label_threshold)},getArcLabelFormat:function(){var t=this.config,e=t.pie_label_format;return this.hasType("gauge")?e=t.gauge_label_format:this.hasType("donut")&&(e=t.donut_label_format),S(e)?e.bind(this.api):e},getArcTitle:function(){var t=this.hasType("donut")?"donut":this.hasType("gauge")&&"gauge";return t?this.config[t+"_title"]:""},updateTargetsForArc:function(t){var e=this,i=e.$el.main,a=e.hasType("gauge"),n=e.classChartArc.bind(e),r=e.classArcs.bind(e),s=e.classFocus.bind(e),o=i.select("."+c.chartArcs).selectAll("."+c.chartArc).data(e.pie(t)).attr("class",(function(t){return n(t)+s(t.data)})),l=o.enter().append("g").attr("class",n);l.append("g").attr("class",r).merge(o),l.append("text").attr("dy",a&&!e.hasMultiTargets()?"-.1em":".35em").style("opacity","0").style("text-anchor","middle").style("pointer-events","none")},initArc:function(){var t=this.$el;t.arcs=t.main.select("."+c.chart).append("g").attr("class",c.chartArcs).attr("transform",this.getTranslate("arc")),this.setArcTitle()},setArcTitle:function(){var t=this.getArcTitle(),e=this.hasType("gauge");if(t){var i=this.$el.arcs.append("text").attr("class",c[e?"chartArcsGaugeTitle":"chartArcsTitle"]).style("text-anchor","middle");e&&i.attr("dy","-0.3em").style("font-size","27px"),j(i,t,e?void 0:[-.6,1.35],!0)}},redrawArc:function(t,e,i){var a=this,n=a.config,r=a.state,o=a.$el.main,l=n.interaction_enabled,u=o.selectAll("."+c.arcs).selectAll("."+c.arc).data(a.arcData.bind(a));u.exit().transition().duration(e).style("opacity","0").remove(),u=u.enter().append("path").attr("class",a.classArc.bind(a)).style("fill",(function(t){return a.color(t.data)})).style("cursor",(function(t){return l&&n.data_selection_isselectable.bind(a.api)(t)?"pointer":null})).style("opacity","0").each((function(t){a.isGaugeType(t.data)&&(t.startAngle=n.gauge_startingAngle,t.endAngle=n.gauge_startingAngle),this._current=t})).merge(u),a.hasMultiArcGauge()&&a.redrawMultiArcGauge(),u.attr("transform",(function(t){return!a.isGaugeType(t.data)&&i?"scale(0)":""})).style("opacity",(function(t){return t===this._current?"0":"1"})).each((function(){r.transiting=!0})).transition().duration(t).attrTween("d",(function(t){var e=a.updateAngle(t);if(!e)return function(){return"M 0 0"};isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle);var i=Object(Ee.interpolate)(this._current,e);return this._current=i(0),function(e){var n=i(e);return n.data=t.data,a.getArc(n,!0)}})).attr("transform",i?"scale(1)":"").style("fill",(function(t){var e;return a.levelColor?(e=a.levelColor(t.data.values[0].value),n.data_colors[t.data.id]=e):e=a.color(t.data.id),e})).style("opacity","1").call(a.endall,(function(){if(a.levelColor){var t=Object(s.select)(this),e=t.datum();a.updateLegendItemColor(e.data.id,t.style("fill"))}r.transiting=!1,$(n.onrendered,a.api)})),l&&a.bindArcEvent(u),a.redrawArcText(t)},redrawMultiArcGauge:function(){var t=this,e=t.config,i=t.state,a=t.$el,n=t.state.hiddenTargetIds,r=a.main.selectAll("."+c.arcs).selectAll("."+c.arcLabelLine).data(t.arcData.bind(t));r.enter().append("rect").attr("class",(function(t){return c.arcLabelLine+" "+c.target+" "+c.target+"-"+t.data.id})).merge(r).style("fill",(function(e){return t.levelColor?t.levelColor(e.data.values[0].value):t.color(e.data)})).style("display",e.gauge_label_show?"":"none").each((function(e){var a=0,r=0,o=0,c="";if(n.indexOf(e.data.id)<0){var l=t.updateAngle(e),u=i.gaugeArcWidth/t.filterTargetsToShow(t.data.targets).length*(l.index+1),d=l.endAngle-Math.PI/2,h=i.radius-u,g=d-(0===h?0:1/h);a=i.radiusExpanded-i.radius+u,r=Math.cos(g)*h,o=Math.sin(g)*h,c="rotate("+180*d/Math.PI+", "+r+", "+o+")"}Object(s.select)(this).attr("x",r).attr("y",o).attr("width",a).attr("height",2).attr("transform",c).style("stroke-dasharray","0, "+(a+2)+", 0")}))},bindArcEvent:function(t){function e(t,e,i){a.expandArc(i),a.api.focus(i),a.toggleFocusLegend(i,!0),a.showTooltip([e],t)}function i(t){var e=t&&t.id||void 0;a.unexpandArc(e),a.api.revert(),a.revertLegend(),a.hideTooltip()}var a=this,n=a.config,r=a.state,o="touch"===r.inputType,c="mouse"===r.inputType;if(t.on("click",(function(t,e){var i,r=a.updateAngle(t);r&&(i=a.convertToArcData(r),a.toggleShape&&a.toggleShape(this,i,e),n.data_onclick.bind(a.api)(i,this))})),c&&t.on("mouseover",(function(t){if(!r.transiting){var i=a.updateAngle(t),n=i?a.convertToArcData(i):null;e(this,n,n&&n.id||void 0),a.setOverOut(!0,n)}})).on("mouseout",(function(t){if(!r.transiting){var e=a.updateAngle(t),n=e?a.convertToArcData(e):null;i(),a.setOverOut(!1,n)}})).on("mousemove",(function(t){var e=a.updateAngle(t),i=e?a.convertToArcData(e):null;a.showTooltip([i],this)})),o&&a.hasArcType()&&!a.radars){var l=function(){if(!r.transiting){var t=(l=s.event.changedTouches[0],Object(s.select)(w.elementFromPoint(l.clientX,l.clientY))).datum(),n=t&&t.data&&t.data.id?a.updateAngle(t):null,o=n?a.convertToArcData(n):null,c=o&&o.id||void 0;a.callOverOutForTouch(o),O(c)?i():e(this,o,c)}var l};a.$el.svg.on("touchstart",l).on("touchmove",l)}},redrawArcText:function(t){var e,i=this,a=i.config,n=i.state,r=i.$el,s=r.main,o=r.arcs,l=i.hasType("gauge"),u=i.hasMultiArcGauge();if(l&&1===i.data.targets.length&&a.gauge_title||(e=s.selectAll("."+c.chartArc).select("text").style("opacity","0").attr("class",(function(t){return i.isGaugeType(t.data)?c.gaugeValue:null})).call(i.textForArcLabel.bind(i)).attr("transform",i.transformForArcLabel.bind(i)).style("font-size",(function(t){return i.isGaugeType(t.data)&&1===i.data.targets.length&&!u?Math.round(n.radius/5)+"px":null})).transition().duration(t).style("opacity",(function(t){return i.isTargetToShow(t.data.id)&&i.isArcType(t.data)?"1":"0"})),u&&e.attr("dy","-.1em")),s.select("."+c.chartArcsTitle).style("opacity",i.hasType("donut")||l?"1":"0"),l){var d=a.gauge_fullCircle,h=-1*Math.PI/2,g=(d?-4:-1)*h;d&&e&&e.attr("dy",""+Math.round(n.radius/14));var f=i.$el.arcs.select((u?"g":"")+"."+c.chartArcsBackground);if(u){var p=0;(f=f.selectAll("path."+c.chartArcsBackground).data(i.data.targets)).enter().append("path").attr("class",(function(t,e){return c.chartArcsBackground+" "+c.chartArcsBackground+"-"+e})).merge(f).attr("d",(function(t){if(n.hiddenTargetIds.indexOf(t.id)>=0)return"M 0 0";var e={data:[{value:a.gauge_max}],startAngle:h,endAngle:g,index:p++};return i.getArc(e,!0,!0)})),f.exit().remove()}else f.attr("d",(function(){var t={data:[{value:a.gauge_max}],startAngle:h,endAngle:g};return i.getArc(t,!0,!0)}));o.select("."+c.chartArcsGaugeUnit).attr("dy",".75em").text(a.gauge_label_show?a.gauge_units:""),a.gauge_label_show&&(o.select("."+c.chartArcsGaugeMin).attr("dx",-1*(n.innerRadius+(n.radius-n.innerRadius)/(d?1:2))+"px").attr("dy","1.2em").text(i.textForGaugeMinMax(a.gauge_min,!1)),!d&&o.select("."+c.chartArcsGaugeMax).attr("dx",n.innerRadius+(n.radius-n.innerRadius)/2+"px").attr("dy","1.2em").text(i.textForGaugeMinMax(a.gauge_max,!0)))}},initGauge:function(){var t=this.config,e=this.$el.arcs,i=function(t){e.append("text").attr("class",t).style("text-anchor","middle").style("pointer-events","none")};this.hasType("gauge")&&(e.append(this.hasMultiArcGauge()?"g":"path").attr("class",c.chartArcsBackground),t.gauge_units&&i(c.chartArcsGaugeUnit),t.gauge_label_show&&(i(c.chartArcsGaugeMin),!t.gauge_fullCircle&&i(c.chartArcsGaugeMax)))},getGaugeLabelHeight:function(){return this.config.gauge_label_show?20:0}},{initRadar:function(){var t=this,e=t.config,i=t.state.currentData;t.hasType("radar")&&(t.radars=t.$el.main.select("."+c.chart).append("g").attr("class",c.chartRadars),t.radars.levels=t.radars.append("g").attr("class",c.levels),t.radars.axes=t.radars.append("g").attr("class",c.axis),t.radars.shapes=t.radars.append("g").attr("class",c.shapes),i.max=e.radar_axis_max||t.getMinMaxData().max[0].value)},getRadarSize:function(){var t=this.config,e=this.state,i=e.arcWidth,a=e.arcHeight,n=t.axis_x_categories.length<4?-20:10,r=(Math.min(i,a)-n)/2;return[r,r]},updateTargetsForRadar:function(t){var e=this.config;F(e.axis_x_categories)&&(e.axis_x_categories=at(0,it("max",t.map((function(t){return t.values.length}))))),this.generateRadarPoints()},getRadarPosition:function(t,e,i,a){var n=this.config,r=this.getRadarSize(),s=r[0],o=r[1],c=n.axis_x_categories.length,l=n.radar_direction_clockwise,u=q(t).map((function(r){return function(t,e,i,a,n,r){var s=t&&a>0?i-a:a,o=2*Math.PI;return n*(1-r*("x"===e?Math.sin:Math.cos)(s*o/i))}(l,r,c,e,k(i)?i:"x"===t?s:o,C(a)?a:n.radar_size_ratio)}));return 1===u.length?u[0]:u},generateRadarPoints:function(){var t=this,e=t.data.targets,i=t.getRadarSize(),a=i[0],n=i[1],r=t.cache.get("$radarPoints")||{},s=r._size;s&&(s.width===a||s.height===n)||(e.forEach((function(e){r[e.id]=e.values.map((function(e,i){return t.getRadarPosition(["x","y"],i,void 0,t.getRatio("radar",e))}))})),r._size={width:a,height:n},t.cache.add("$radarPoints",r))},redrawRadar:function(t){var e=this,i=e.$el.main,a=e.getTranslate("radar");a&&(e.radars.attr("transform",a),i.selectAll("."+c.circles).attr("transform",a),i.select("."+c.chartTexts).attr("transform",a),e.generateRadarPoints(),e.updateRadarLevel(),e.updateRadarAxes(),e.updateRadarShape(t))},generateGetRadarPoints:function(){var t=this.cache.get("$radarPoints");return function(e,i){var a=t[e.id][i];return[a,a,a,a]}},updateRadarLevel:function(){var t=this,e=t.config,i=t.state,a=t.getRadarSize(),n=a[0],r=a[1],s=e.radar_level_depth,o=e.axis_x_categories.length,l=e.radar_level_text_show,u=t.radars.levels,d=at(0,s),h=e.radar_size_ratio*Math.min(n,r),g=d.map((function(t){return h*((t+1)/s)})),f=(e.radar_level_text_format||function(){}).bind(t.api),p=d.map((function(e){var i=g[e];return at(0,o).map((function(e){return t.getRadarPosition(["x","y"],e,i,1).join(",")})).join(" ")})),x=u.selectAll("."+c.level).data(d);x.exit().remove();var v=x.enter().append("g").attr("class",(function(t,e){return c.level+" "+c.level+"-"+e}));v.append("polygon").style("visibility",e.radar_level_show?null:"hidden"),l&&(u.select("text").empty()&&u.append("text").attr("dx","-.5em").attr("dy","-.7em").style("text-anchor","end").text((function(){return f(0)})),v.append("text").attr("dx","-.5em").style("text-anchor","end").text((function(t){return f(i.currentData.max/d.length*(t+1))}))),v.merge(x).attr("transform",(function(t){return"translate("+(n-g[t])+", "+(r-g[t])+")"})).selectAll("polygon").attr("points",(function(t){return p[t]})),l&&u.selectAll("text").attr("x",(function(t){return O(t)?n:p[t].split(",")[0]})).attr("y",(function(t){return O(t)?r:0}))},updateRadarAxes:function(){var t=this,e=t.config,i=t.getRadarSize(),a=i[0],n=i[1],r=e.axis_x_categories,o=t.radars.axes.selectAll("g").data(r);o.exit().remove();var l=o.enter().append("g").attr("class",(function(t,e){return c.axis+"-"+e}));if(e.radar_axis_line_show&&l.append("line"),e.radar_axis_text_show&&l.append("text"),o=l.merge(o),e.radar_axis_line_show&&o.select("line").attr("x1",a).attr("y1",n).attr("x2",(function(e,i){return t.getRadarPosition("x",i)})).attr("y2",(function(e,i){return t.getRadarPosition("y",i)})),e.radar_axis_text_show){var u=e.radar_axis_text_position,d=u.x,h=void 0===d?0:d,g=u.y,f=void 0===g?0:g;o.select("text").style("text-anchor","middle").attr("dy",".5em").call((function(t){t.each((function(t){j(Object(s.select)(this),t+"",[-.6,1.2])}))})).datum((function(t,e){return{index:e}})).attr("transform",(function(e){O(this.width)&&(this.width=this.getBoundingClientRect().width/2);var i=t.getRadarPosition("x",e.index,void 0,1),r=Math.round(t.getRadarPosition("y",e.index,void 0,1));return i>a?i+=this.width+h:Math.round(i)<a&&(i-=this.width+h),r>n?(r/2===n&&"tspan"===this.firstChild.tagName&&this.firstChild.setAttribute("dy","0em"),r+=f):r<n&&(r-=f),"translate("+i+" "+r+")"}))}t.bindEvent()},bindEvent:function(){var t=this,e=this,i=e.config,a=e.state,n=a.inputType,r=a.transiting,o=e.$el.svg;if(i.interaction_enabled){var l="mouse"===n,u=function(){var t=s.event.target;/tspan/i.test(t.tagName)&&(t=t.parentNode);var e=Object(s.select)(t).datum();return e&&1===Object.keys(e).length?e.index:void 0},d=function(){var i=u(),a=O(i);(l||a)&&(t.hideTooltip(),t.unexpandCircles(),l?e.setOverOut(!1,i):a&&e.callOverOutForTouch())};e.radars.select("."+c.axis).on(l?"mouseover ":"touchstart",(function(){if(!r){var t=u();e.selectRectForSingle(o.node(),null,t),l?e.setOverOut(!0,t):e.callOverOutForTouch(t)}})).on("mouseout",l?d:null),l||o.on("touchstart",d)}},updateRadarShape:function(t){var e=this,i=e.data.targets,a=e.cache.get("$radarPoints"),n=e.radars.shapes.selectAll("polygon").data(i),r=n.enter().append("g").attr("class",e.classChartRadar.bind(e));n.exit().transition().duration(t).remove(),r.append("polygon").merge(n).style("fill",e.color).style("stroke",e.color).attr("points",(function(t){return a[t.id].join(" ")}))},radarCircleX:function(t){return this.cache.get("$radarPoints")[t.id][t.index][0]},radarCircleY:function(t){return this.cache.get("$radarPoints")[t.id][t.index][1]}}]},Fe=function(){function t(t){a(this,"api",void 0),a(this,"config",void 0),a(this,"cache",void 0),a(this,"state",void 0),a(this,"charts",void 0),a(this,"isArc",!1),a(this,"data",{xs:{},targets:[]}),a(this,"$el",{chart:null,main:null,svg:null,axis:{x:null,y:null,y2:null,subX:null},defs:null,tooltip:null,legend:null,title:null,subchart:{main:null,bar:null,line:null,area:null},arcs:null,bar:null,line:null,area:null,circle:null,text:null,grid:{main:null,x:null,y:null},gridLines:{main:null,x:null,y:null},region:{main:null,list:null},eventRect:null}),a(this,"axis",void 0),a(this,"scale",{x:null,y:null,y2:null,subX:null,subY:null,subY2:null,zoom:null}),a(this,"org",{xScale:null,xDomain:null}),a(this,"color",void 0),a(this,"patterns",void 0),a(this,"levelColor",void 0),a(this,"point",void 0),a(this,"brush",void 0),a(this,"format",{extraLineClasses:null,xAxisTick:null,dataTime:null,defaultAxisTime:null,axisTime:null});this.api=t,this.config=new Tt,this.cache=new wt,this.state=new l}var e=t.prototype;return e.beforeInit=function(){this.callPluginHook("$beforeInit"),$(this.config.onbeforeinit,this.api)},e.afterInit=function(){this.callPluginHook("$afterInit"),$(this.config.onafterinit,this.api)},e.init=function(){var t=this,e=t.config,i=t.state,a=t.$el;i.hasAxis=!t.hasArcType(),i.hasRadar=!i.hasAxis&&t.hasType("radar"),t.initParams();var n={element:e.bindto,classname:"bb"};P(e.bindto)&&(n.element=e.bindto.element||"#chart",n.classname=e.bindto.classname||n.classname),a.chart=S(n.element.node)?e.bindto.element:Object(s.select)(n.element||[]),a.chart.empty()&&(a.chart=Object(s.select)(w.body.appendChild(w.createElement("div")))),a.chart.html("").classed(n.classname,!0),t.initToRender()},e.initToRender=function(t){var e=this,i=e.config,a=e.state,n=e.$el.chart,r=function(){return"none"===n.style("display")||"hidden"===n.style("visibility")},s=i.render.lazy||r(),o=T.MutationObserver;if(s&&o&&!1!==i.render.observe&&!t&&new o((function(t,i){r()||(i.disconnect(),!a.rendered&&e.initToRender(!0))})).observe(n.node(),{attributes:!0,attributeFilter:["class","style"]}),!s||t){var c=e.convertData(i,e.initWithData);c&&e.initWithData(c)}},e.initParams=function(){var t=this,e=t.config,i=t.format,a=t.state,n=e.axis_rotated;if(a.datetimeId="bb-"+ +new Date,t.color=t.generateColor(),t.levelColor=t.generateLevelColor(),t.hasPointType()&&(t.point=t.generatePoint()),a.hasAxis){t.initClip(),i.extraLineClasses=t.generateExtraLineClass(),i.dataTime=e.data_xLocaltime?r.timeParse:r.utcParse,i.axisTime=e.axis_x_localtime?r.timeFormat:r.utcFormat;var s=t.config.zoom_enabled&&"drag"===t.config.zoom_enabled.type;i.defaultAxisTime=function(e){var a=t.scale,n=a.x,r=a.zoom,o=s?r:r&&n.orgDomain().toString()!==r.domain().toString(),c=(e.getMilliseconds()?".%L":e.getSeconds()&&".:%S")||e.getMinutes()&&"%I:%M"||e.getHours()&&"%I %p"||1!==e.getDate()&&"%b %d"||o&&1===e.getDate()&&"%b'%y"||e.getMonth()&&"%-m/%-d"||"%Y";return i.axisTime(c)(e)}}a.isLegendRight="right"===e.legend_position,a.isLegendInset="inset"===e.legend_position,a.isLegendTop="top-left"===e.legend_inset_anchor||"top-right"===e.legend_inset_anchor,a.isLegendLeft="top-left"===e.legend_inset_anchor||"bottom-left"===e.legend_inset_anchor,a.rotatedPaddingRight=n&&!e.axis_x_show?0:30,a.inputType=function(t,e){var i=!1;if(/Mobi/.test(T.navigator.userAgent)&&e){var a=T.navigator&&"maxTouchPoints"in T.navigator&&T.navigator.maxTouchPoints>0,n="ontouchmove"in T||T.DocumentTouch&&w instanceof T.DocumentTouch;i=a||n}return(!(!t||i)&&"onmouseover"in T?"mouse":i&&"touch")||null}(e.interaction_inputType_mouse,e.interaction_inputType_touch)},e.initWithData=function(t){var e=this,i=e.config,a=e.state,n=e.$el,r=e.scale,s=r.x,o=r.y,l=r.y2,u=r.subX,d=r.subY,h=r.subY2,g=e.org,f=a.hasAxis;if(f&&(e.axis=new Ot(e),i.zoom_enabled&&e.initZoom()),e.data.xs={},e.data.targets=e.convertDataToTargets(t),i.data_filter&&(e.data.targets=e.data.targets.filter(i.data_filter.bind(e.api))),i.data_hide&&e.addHiddenTargetIds(!0===i.data_hide?e.mapToIds(e.data.targets):i.data_hide),i.legend_hide&&e.addHiddenLegendIds(!0===i.legend_hide?e.mapToIds(e.data.targets):i.legend_hide),e.updateSizes(),e.updateScales(!0),s&&(s.domain(et(e.getXDomain(e.data.targets))),u.domain(s.domain()),g.xDomain=s.domain()),o&&(o.domain(e.getYDomain(e.data.targets,"y")),d.domain(o.domain())),l&&(l.domain(e.getYDomain(e.data.targets,"y2")),h&&h.domain(l.domain())),n.svg=n.chart.append("svg").style("overflow","hidden").style("display","block"),i.interaction_enabled&&a.inputType){var p="touch"===a.inputType;n.svg.on(p?"touchstart":"mouseenter",(function(){return $(i.onover,e.api)})).on(p?"touchend":"mouseleave",(function(){return $(i.onout,e.api)}))}i.svg_classname&&n.svg.attr("class",i.svg_classname);var x=S(i.color_tiles)&&e.patterns;(f||x)&&(n.defs=n.svg.append("defs"),f&&["id","idXAxis","idYAxis","idGrid"].forEach((function(t){e.appendClip(n.defs,a.clip[t])})),x&&e.patterns.forEach((function(t){return n.defs.append((function(){return t.node}))}))),e.updateSvgSize();var v=n.svg.append("g").attr("transform",e.getTranslate("main"));if(n.main=v,i.subchart_show&&e.initSubchart(),i.tooltip_show&&e.initTooltip(),i.title_text&&e.initTitle(),i.legend_show&&e.initLegend(),i.data_empty_label_text&&v.append("text").attr("class",c.text+" "+c.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),f&&(i.regions.length&&e.initRegion(),!i.clipPath&&e.axis.init()),v.append("g").attr("class",c.chart).attr("clip-path",a.clip.path),e.callPluginHook("$init"),f&&(e.initEventRect&&e.initEventRect(),e.initGrid(),i.clipPath&&e.axis&&e.axis.init()),e.initChartElements(),e.updateTargets(e.data.targets),e.updateDimension(),$(i.oninit,e.api),e.setBackground(),e.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1,initializing:!0}),i.data_onmin||i.data_onmax){var m=e.getMinMaxData();$(i.data_onmin,e.api,m.min),$(i.data_onmax,e.api,m.max)}e.bindResize(),e.api.element=n.chart.node(),a.rendered=!0},e.initChartElements=function(){var t=this,e=t.state,i=e.hasAxis,a=e.hasRadar,n=[];i?(t.hasType("bar")&&n.push("Bar"),t.hasType("bubble")&&n.push("Bubble"),t.hasTypeOf("Line")&&n.push("Line")):(!a&&n.push("Arc","Pie"),t.hasType("gauge")?n.push("Gauge"):a&&n.push("Radar")),n.forEach((function(e){t["init"+e]()})),I(t.config.data_labels)&&t.initText()},e.setChartElements=function(){var t=this.$el;this.api.$={chart:t.chart,svg:t.svg,defs:t.defs,main:t.main,tooltip:t.tooltip,legend:t.legend,title:t.title,grid:t.grid,arc:t.arcs,circles:t.circle,bar:{bars:t.bar},line:{lines:t.line,areas:t.area},text:{texts:t.text}}},e.setBackground=function(){var t=this.config.background,e=this.$el.svg;if(I(t)){var i=e.select("."+c[this.hasArcType()?"chart":"regions"]).insert(t.imgUrl?"image":"rect",":first-child");t.imgUrl?i.attr("href",t.imgUrl):t.color&&i.style("fill",t.color),i.attr("class",t.class||null).attr("width","100%").attr("height","100%")}},e.updateTargets=function(t){var e=this,i=e.state,a=i.hasAxis,n=i.hasRadar;e.updateTargetsForText(t),(e.hasPointType()||n)&&e.updateTargetForCircle(),a?(e.hasType("bar")&&e.updateTargetsForBar(t),e.hasTypeOf("Line")&&e.updateTargetsForLine(t),e.updateTargetsForSubchart&&e.updateTargetsForSubchart(t)):e.hasArcType(t)&&(n?e.updateTargetsForRadar(t):e.updateTargetsForArc(t)),e.showTargets()},e.showTargets=function(){var t=this,e=t.config;t.$el.svg.selectAll("."+c.target).filter((function(e){return t.isTargetToShow(e.id)})).transition().duration(e.transition_duration).style("opacity","1")},e.getWithOption=function(t){var e={Y:!0,Subchart:!0,Transition:!0,EventRect:!0,Dimension:!0,TrimXDomain:!0,Transform:!1,UpdateXDomain:!1,UpdateOrgXDomain:!1,Legend:!1,UpdateXAxis:"UpdateXDomain",TransitionForExit:"Transition",TransitionForAxis:"Transition"};return Object.keys(e).forEach((function(i){var a=e[i];L(a)&&(a=e[a]),e[i]=B(t,"with"+i,a)})),e},e.redraw=function(t,e){void 0===t&&(t={});var i=this,a=i.config,n=i.state,r=i.$el,s=r.main,o=i.filterTargetsToShow(i.data.targets),l=t.initializing,u=t.flow,d=i.getWithOption(t),h=d.Transition?a.transition_duration:0,g=d.TransitionForExit?h:0,f=d.TransitionForAxis?h:0,p=e||i.axis&&i.axis.generateTransitions(f);l&&a.tooltip_init_show||"touch"!==n.inputType||i.hideTooltip(),i.updateSizes(l),d.Legend&&a.legend_show?i.updateLegend(i.mapToIds(i.data.targets),t,p):d.Dimension&&i.updateDimension(!0),i.hasDataLabel()&&i.updateText(g),(!i.hasArcType()||n.hasRadar)&&i.updateCircleY(),(i.hasPointType()||n.hasRadar)&&i.updateCircle(),n.hasAxis?(i.axis.redrawAxis(o,d,p,u,l),i.updategridFocus(),a.data_empty_label_text&&s.select("text."+c.text+"."+c.empty).attr("x",n.width/2).attr("y",n.height/2).text(a.data_empty_label_text).style("display",o.length?"none":null),i.hasGrid()&&i.updateGrid(h),a.regions.length&&i.updateRegion(h),i.hasType("bar")&&i.updateBar(g),i.hasTypeOf("Line")&&i.updateLine(g),i.hasTypeOf("Area")&&i.updateArea(g),r.text&&s.selectAll("."+c.selectedCircles).filter(i.isBarType.bind(i)).selectAll("circle").remove(),a.interaction_enabled&&!u&&d.EventRect&&i.bindZoomEvent()):(r.arcs&&i.redrawArc(h,g,d.Transform),i.radars&&i.redrawRadar(g)),i.redrawTitle&&i.redrawTitle(),l&&i.setChartElements(),i.generateRedrawList(o,u,h,d.Subchart),i.callPluginHook("$redraw",t,h)},e.generateRedrawList=function(t,e,i,a){var n=this,r=n.config,s=n.state,c=n.getDrawShape();s.hasAxis&&r.subchart_show&&n.redrawSubchart(a,i,c);var l=e&&n.generateFlow({targets:t,flow:e,duration:e.duration,shape:c,xv:n.xv.bind(n)}),u=(i||l)&&ot(),d=n.getRedrawList(c,e,l,u),h=e||r.onrendered?function(){l&&l(),$(r.onrendered,n.api)}:null;if(h)if(u&&d.length){var g=n.generateWait();Object(o.transition)().duration(i).each((function(){d.reduce((function(t,e){return t.concat(e)}),[]).forEach((function(t){return g.add(t)}))})).call(g,h)}else s.transiting||h();n.mapToIds(n.data.targets).forEach((function(t){s.withoutFadeIn[t]=!0}))},e.getRedrawList=function(t,e,i,a){var n=this,r=n.config,s=n.state,o=s.hasAxis,c=s.hasRadar,l=t.pos,u=l.cx,d=l.cy,h=l.xForText,g=l.yForText,f=[];if(o){var p=t.type,x=p.area,v=p.bar,m=p.line;(r.grid_x_lines.length||r.grid_y_lines.length)&&f.push(n.redrawGrid(a)),r.regions.length&&f.push(n.redrawRegion(a)),n.hasTypeOf("Line")&&f.push(n.redrawLine(m,a)),n.hasTypeOf("Area")&&f.push(n.redrawArea(x,a)),n.hasType("bar")&&f.push(n.redrawBar(v,a))}return(!n.hasArcType()||c)&&I(r.data_labels)&&f.push(n.redrawText(h,g,e,a)),(n.hasPointType()||c)&&f.push(n.redrawCircle(u,d,a,i)),f},e.updateAndRedraw=function(t){void 0===t&&(t={});var e,i=this,a=i.config,n=i.state;t.withTransition=B(t,"withTransition",!0),t.withTransform=B(t,"withTransform",!1),t.withLegend=B(t,"withLegend",!1),t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=B(t,"withTransitionForTransform",t.withTransition),t.withLegend&&a.legend_show||(n.hasAxis&&(e=i.axis.generateTransitions(t.withTransitionForAxis?a.transition_duration:0)),i.updateScales(),i.updateSvgSize(),i.transformAll(t.withTransitionForTransform,e)),i.redraw(t,e)},e.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})},e.isCategorized=function(){return this.config.axis_x_type.indexOf("category")>=0||this.state.hasRadar},e.isCustomX=function(){var t=this.config;return!this.isTimeSeries()&&(t.data_x||I(t.data_xs))},e.isTimeSeries=function(t){return void 0===t&&(t="x"),"timeseries"===this.config["axis_"+t+"_type"]},e.isTimeSeriesY=function(){return this.isTimeSeries("y")},e.initialOpacity=function(t){var e=this.state.withoutFadeIn;return null!==this.getBaseValue(t)&&e[t.id]?"1":"0"},e.xx=function(t){var e=this.config,i=this.scale,a=i.x,n=i.zoom,r=e.zoom_enabled&&n?n:a;return t?r(A(t.x)?t.x:t):null},e.xv=function(t){var e=this,i=e.config,a=e.scale.x,n=e.getBaseValue(t);return e.isTimeSeries()?n=st.call(e,n):e.isCategorized()&&L(n)&&(n=i.axis_x_categories.indexOf(n)),Math.ceil(a(n))},e.yv=function(t){var e=this.scale,i=e.y,a=e.y2,n=t.axis&&"y2"===t.axis?a:i;return Math.ceil(n(this.getBaseValue(t)))},e.subxx=function(t){return t?this.scale.subX(t.x):null},e.bindResize=function(){var t=this,e=t.config;t.resizeFunction=t.generateResize(),t.resizeFunction.add((function(){return $(e.onresize,t.api)})),e.resize_auto&&t.resizeFunction.add((function(){t.resizeTimeout&&(T.clearTimeout(t.resizeTimeout),t.resizeTimeout=null),t.resizeTimeout=T.setTimeout((function(){t.api.flush(!1,!0)}),200)})),t.resizeFunction.add((function(){return $(e.onresized,t.api)})),T.addEventListener("resize",t.resizeFunction)},e.generateResize=function(){function t(){e.forEach((function(t){return t()}))}var e=[];return t.add=function(t){return e.push(t)},t.remove=function(t){return e.splice(e.indexOf(t),1)},t},e.endall=function(t,e){var i=0;t.each((function(){return++i})).on("end",(function(){for(var t=arguments.length,a=Array(t),n=0;n<t;n++)a[n]=arguments[n];--i||e.apply.apply(e,[this].concat(a))}))},e.generateWait=function(){var t=[],e=function(e,i){var a;!function e(){for(var n,r=0,s=0;n=t[s];s++)if(n.empty())r++;else try{n.transition()}catch(t){r++}a&&clearTimeout(a),r===t.length?i&&i():a=setTimeout(e,50)}()};return e.add=function(e){M(e)?t=t.concat(e):t.push(e)},e},e.callPluginHook=function(t){for(var e=this,i=arguments.length,a=Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];this.config.plugins.forEach((function(i){"$beforeInit"===t&&(i.$$=e,e.api.plugins.push(i)),i[t].apply(i,a)}))},t}();function Ie(t){var e,i,a,n=this.config,r=function(){var t=i.shift();return t&&e&&z(e)&&t in e?(e=e[t],r()):t?void 0:e};Object.keys(n).forEach((function(s){e=t,i=s.split("_"),a=r(),k(a)&&(n[s]=a)}))}U(Fe.prototype,[Dt,Rt,Xt,Ft,Mt,Pt,zt,$t,Yt,jt,Nt,Vt,Ht,Wt,Ut,qt].concat(ze.internal,Xe.internal));var Me={resize:function(t){var e=this.internal.config;e.size_width=t?t.width:null,e.size_height=t?t.height:null,this.flush(!1,!0)},flush:function(t,e){var i=this.internal;i.state.rendered?(e?i.brush&&i.brush.updateResize():i.axis&&i.axis.setOrient(),i.scale.zoom=null,t?i.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withLegend:!0}):i.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})):i.initToRender(!0)},destroy:function(){var t=this,e=this.internal,i=e.$el,a=i.chart,n=i.svg;return I(e)&&(e.callPluginHook("$willDestroy"),e.charts.splice(e.charts.indexOf(this),1),n.select("*").interrupt(),k(e.resizeTimeout)&&T.clearTimeout(e.resizeTimeout),T.removeEventListener("resize",e.resizeFunction),a.classed("bb",!1).html(""),Object.keys(this).forEach((function(i){"internal"===i&&Object.keys(e).forEach((function(t){e[t]=null})),t[i]=null,delete t[i]}))),null},config:function(t,e,i){var a,n=this.internal.config,r=t&&t.replace(/\./g,"_");return r in n&&(k(e)?(n[r]=e,a=e,i&&this.flush()):a=n[r]),a}};function Pe(t){var e=this.internal.data.targets;if(!O(t)){var i=M(t)?t:[t];return e.filter((function(t){return i.some((function(e){return e===t.id}))}))}return e}U(Pe,{shown:function(t){return this.internal.filterTargetsToShow(this.data(t))},values:function(t,e){var i;if(void 0===e&&(e=!0),t){var a=this.data(t);a&&M(a)&&(i=[],a.forEach((function(t){var a=t.values.map((function(t){return t.value}));e?i=i.concat(a):i.push(a)})))}return i},names:function(t){var e=this.internal;return e.getLegendItemTextBox(),e.updateDataAttributes("names",t)},colors:function(t){return this.internal.updateDataAttributes("colors",t)},axes:function(t){return this.internal.updateDataAttributes("axes",t)},min:function(){return this.internal.getMinMaxData().min},max:function(){return this.internal.getMinMaxData().max}});function Be(t,e){var i,a,n=new XMLSerializer,r=t.cloneNode(!0),o=(i=q(w.styleSheets),a=[],i.forEach((function(t){try{t.cssRules&&t.cssRules.length&&(a=a.concat(q(t.cssRules)))}catch(e){console.error("Error while reading rules from "+t.href+": "+e.toString())}})),a).filter((function(t){return t.cssText})).map((function(t){return t.cssText}));r.setAttribute("xmlns",s.namespaces.xhtml);var c=n.serializeToString(r),l=w.createElement("style");l.appendChild(w.createTextNode(o.join("\n")));var u=n.serializeToString(l),d=('<svg xmlns="'+s.namespaces.svg+'" width="'+e.width+'" height="'+e.height+'">\n\t\t\t<foreignObject width="100%" height="100%">\n\t\t\t\t'+u+"\n\t\t\t\t"+c.replace(/(url\()[^#]+/g,"$1")+"\n\t\t\t</foreignObject></svg>").replace("/\n/g","%0A");return"data:image/svg+xml;base64,"+btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(+("0x"+e))})))}function $e(t,e,i){var a=this.internal,n=a.mapToTargetIds(e);a[(t?"remove":"add")+"HiddenTargetIds"](n);var r=a.$el.svg.selectAll(a.selectorTargets(n)),s=t?"1":"0";r.transition().style("opacity",s,"important").call(a.endall,(function(){r.style("opacity",null).style("opacity",s)})),i.withLegend&&a[(t?"show":"hide")+"Legend"](n),a.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})}var Ye=function t(e){a(this,"plugins",[]),a(this,"internal",void 0);var i=e.data,n=(i.type,i.types,new Fe(this));this.internal=n,function t(e,i,a){Object.keys(e).forEach((function(n){var r=S(e[n]),s=i!==a,o=Object.keys(e[n]).length>0;r&&(!s&&o||s)?i[n]=e[n].bind(a):!r&&(i[n]={}),o&&t(e[n],i[n],a)}))}(t.prototype,this,this),Ie.call(n,e),n.beforeInit(),n.init(),n.afterInit()};U(Ye.prototype,[Me,{color:function(t){return this.internal.color(t)}},{data:Pe},{export:function(t,e){var i=this,a=this.internal.state,n={width:a.currentWidth,height:a.currentHeight},r=Be(this.element,n);if(e&&S(e)){var s=new Image;s.crossOrigin="Anonymous",s.onload=function(){var a=w.createElement("canvas"),r=a.getContext("2d");a.width=n.width,a.height=n.height,r.drawImage(s,0,0),e.bind(i)(a.toDataURL(t))},s.src=r}return r}},{focus:function(t){var e=this.internal,i=e.state,a=e.mapToTargetIds(t),n=e.$el.svg.selectAll(e.selectorTargets(a.filter(e.isTargetToShow,e)));this.revert(),this.defocus(),n.classed(c.focused,!0).classed(c.defocused,!1),e.hasArcType()&&!i.hasRadar&&(e.expandArc(a),e.hasType("gauge")&&e.markOverlapped(t,e,"."+c.gaugeValue)),e.toggleFocusLegend(a,!0),i.focusedTargetIds=a,i.defocusedTargetIds=i.defocusedTargetIds.filter((function(t){return a.indexOf(t)<0}))},defocus:function(t){var e=this.internal,i=e.state,a=e.mapToTargetIds(t);e.$el.svg.selectAll(e.selectorTargets(a.filter(e.isTargetToShow,e))).classed(c.focused,!1).classed(c.defocused,!0),e.hasArcType()&&(e.unexpandArc(a),e.hasType("gauge")&&e.undoMarkOverlapped(e,"."+c.gaugeValue)),e.toggleFocusLegend(a,!1),i.focusedTargetIds=i.focusedTargetIds.filter((function(t){return a.indexOf(t)<0})),i.defocusedTargetIds=a},revert:function(t){var e=this.internal,i=e.config,a=e.state,n=e.$el,r=e.mapToTargetIds(t);n.svg.selectAll(e.selectorTargets(r)).classed(c.focused,!1).classed(c.defocused,!1),e.hasArcType()&&e.unexpandArc(r),i.legend_show&&(e.showLegend(r.filter(e.isLegendToShow.bind(e))),n.legend.selectAll(e.selectorLegends(r)).filter((function(){return Object(s.select)(this).classed(c.legendItemFocused)})).classed(c.legendItemFocused,!1)),a.focusedTargetIds=[],a.defocusedTargetIds=[]}},{legend:{show:function(t){var e=this.internal;e.showLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},hide:function(t){var e=this.internal;e.hideLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})}}},{load:function(t){var e=this.internal,i=e.config;t.xs&&e.addXs(t.xs),"names"in t&&this.data.names(t.names),"classes"in t&&Object.keys(t.classes).forEach((function(e){i.data_classes[e]=t.classes[e]})),"categories"in t&&e.isCategorized()&&(i.axis_x_categories=t.categories),"axes"in t&&Object.keys(t.axes).forEach((function(e){i.data_axes[e]=t.axes[e]})),"colors"in t&&Object.keys(t.colors).forEach((function(e){i.data_colors[e]=t.colors[e]})),"unload"in t&&!1!==t.unload?e.unload(e.mapToTargetIds(!0===t.unload?null:t.unload),(function(){return e.loadFromArgs(t)})):e.loadFromArgs(t)},unload:function(t){var e=this,i=this.internal,a=t||{};M(a)?a={ids:a}:L(a)&&(a={ids:[a]});var n=i.mapToTargetIds(a.ids);i.unload(n,(function(){i.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),i.cache.remove(n),a.done&&a.done.call(e)}))}},{show:function(t,e){void 0===e&&(e={}),$e.call(this,!0,t,e)},hide:function(t,e){void 0===e&&(e={}),$e.call(this,!1,t,e)},toggle:function(t,e){var i=this;void 0===e&&(e={});var a=this.internal,n={show:[],hide:[]};a.mapToTargetIds(t).forEach((function(t){return n[a.isTargetToShow(t)?"hide":"show"].push(t)})),n.show.length&&this.show(n.show,e),n.hide.length&&setTimeout((function(){return i.hide(n.hide,e)}),0)}},{tooltip:{show:function(t){var e,i,a=this.internal,n=a.config,r=a.state.inputType;if(t.mouse&&(i=t.mouse),t.data){var s=a.getYScale(t.data.id)(t.data.value);a.isMultipleX()?i=[a.scale.x(t.data.x),s]:(!n.tooltip_grouped&&(i=[0,s]),e=A(t.data.index)?t.data.index:a.getIndexByX(t.data.x))}else k(t.x)?e=a.getIndexByX(t.x):k(t.index)&&(e=t.index);("mouse"===r?["mouseover","mousemove"]:["touchstart"]).forEach((function(t){a.dispatchEvent(t,e,i)}))},hide:function(){var t=this.internal;t.hideTooltip(!0),t.hideGridFocus(),t.unexpandCircles(),t.unexpandBars()}}}].concat(Xe.api)),i.d(e,"bb",(function(){return Ne})),i.d(e,"default",(function(){return Ne}));var je={},Ne={version:"2.0.0-alpha",generate:function(t){var e=tt({},je,t),i=new Ye(e);return i.internal.charts=this.instance,this.instance.push(i),i},defaults:function(t){return P(t)&&(je=t),je},instance:[],plugin:{}}}])}));
//# sourceMappingURL=billboard.min.js.map